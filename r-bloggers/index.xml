<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Our posts on R-bloggers on inSileco</title>
    <link>https://insileco.github.io/r-bloggers/index.xml</link>
    <description>Recent content in Our posts on R-bloggers on inSileco</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Copyright © 2017-2022 inSileco</copyright>
    <atom:link href="https://insileco.github.io/r-bloggers/index.xml" rel="self" type="application/rss+xml" />
    
		
    
		
    
		
    <item>
      <title>Continuous integration for R projects: from Travis CI to GitHub actions step by step</title>
      <link>https://insileco.github.io/2020/11/24/continuous-integration-for-r-projects-from-travis-ci-to-github-actions-step-by-step/</link>
      <pubDate>Tue, 24 Nov 2020 00:00:00 +0000</pubDate>
      
      <guid>https://insileco.github.io/2020/11/24/continuous-integration-for-r-projects-from-travis-ci-to-github-actions-step-by-step/</guid>
      <description>


<p>I have been using Travis CI (<a href="https://travis-ci.org/" class="uri">https://travis-ci.org/</a>) since 2015 and GitHub
Actions (hereafter GH Actions; <a href="https://github.com/features/actions" class="uri">https://github.com/features/actions</a>) for over a
year now<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. While using these two hosted continuous integration services,
I came to realize that I was spending less time troubleshooting with GH Actions
than I was with Travis. For this reason, I am now setting GH Actions workflows
for my new projects (mainly R and Julia projects) and slowly migrating older
projects from Travis to GH Actions. Turns out that was the right move! Indeed,
as Jeroen Ooms explains in his recent post <a href="https://discuss.ropensci.org/t/ropensci-moving-away-from-travis-ci/2267">“Moving away from Travis
CI”</a>,
by next year, <a href="https://blog.travis-ci.com/2020-11-02-travis-ci-new-billing">Travis will no longer be free for open source
projects</a> (see
<a href="https://www.theregister.com/2020/11/02/travis_ci_pricng/">also</a>), which gives
me a good reason to speed up the migration process! As I was working on such
migration recently, I felt that I should to share some notes about this!</p>
<div id="insilecomisc-as-an-example" class="section level2">
<h2>inSilecoMisc as an example</h2>
<p>The package I worked on was
<a href="https://github.com/inSileco/inSilecoMisc"><code>inSilecoMisc</code></a>. Note that I have
already detailed elsewhere various features including in inSilecoMisc (e.g.
<a href="https://insileco.github.io/2020/04/14/insilecomisc-0.4.0-part-1/2/">here</a> and
<a href="https://insileco.github.io/2020/04/21/insilecomisc-0.4.0-part-2/2/">there</a>).
What matters here, is what was Travis CI doing for me. The screenshot below
shows the different jobs I set (described in
<a href="https://github.com/inSileco/inSilecoMisc/blob/38724e2e9710fb35d87fe1b69aaae8fe4e8cdeff/.travis.yml">.travis.yml</a>).</p>
<div class="figure">
<img src="on_travis.png" alt="&gt;&lt;" style="width:90.0%" />
<p class="caption"><i class="fa fa-info" aria-hidden="true"></i> Screenshot of the inSilecoMisc project page on <a href="https://travis-ci.org/">travis-ci.org</a>.</p>
</div>
<p>Travis was set to check <code>inSilecoMisc</code> on macOS and Linux (Ubuntu Bionic and Focal), for different versions of R (oldrel, rel and devel). The last job, checked the package on Ubuntu Focal, uploaded <a href="https://CRAN.R-project.org/package=covr"><code>covr</code></a> results to
<a href="https://codecov.io">CodeCov</a>, built <code>inSilecoMisc</code>’s website (via <a href="https://CRAN.R-project.org/package=pkgdown"><code>pkgdown</code></a>) and deploy to a <a href="https://pages.github.com/">GitHub Pages</a>. So my goal was to set up a workflow with GitHub Actions that would do the same jobs.</p>
</div>
<div id="ciao-travis" class="section level2">
<h2>Ciao Travis!</h2>
<p>The first step was to stop using Travis CI. To do so, I first needed to go on
<a href="https://travis-ci.org" class="uri">https://travis-ci.org</a> and turn off the jobs described above, so I looked for <code>inSilecoMisc</code> in my list of projects and switched it off (see screenshot below).</p>
<div class="figure">
<img src="switch_off.png" alt="&gt;&lt;" style="width:90.0%" />
<p class="caption"><i class="fa fa-info" aria-hidden="true"></i> Screenshots of <code>inSilecoMisc</code>’s status on <a href="https://travis-ci.org" class="uri">https://travis-ci.org</a> (left: on/before, right: off/after).</p>
</div>
<p>Then, as I was using a <a href="https://developer.github.com/v3/guides/managing-deploy-keys/">deploy
key</a> for the
website, I deleted it in the settings on GitHub repository (<i class="fa
fa-arrow-circle-down" aria-hidden="true"></i>). Last, on my local <i class="fa
fa-git" aria-hidden="true"></i> repository I removed <code>.travis.yaml</code> (e.g. <code>git rm .travis.yaml</code>). Note that I still have a version of this file as a
<a href="https://gist.github.com/KevCaz/622c92cc1f7b00e66f078418882ad407">gist</a>. Once
this was done, I committed my changes and pushed!</p>
<div class="figure">
<img src="ciao.png" alt="&gt;&lt;" style="width:90.0%" />
<p class="caption"><i class="fa fa-info" aria-hidden="true"></i> Screenshot of <code>inSileco</code>’s home page (commit <a href="https://github.com/inSileco/inSilecoMisc/commit/500d5ef332a407e48037ce422a9a14e7c4634fe7"><code>500d5ef</code></a>).</p>
</div>
</div>
<div id="add-a-workflow" class="section level2">
<h2>Add a workflow</h2>
<p><a href="https://github.com/features/actions">GH Actions</a> are well-documented and my
goal here is not to explain how to set an entire workflow. Rather I would like
to focus on certain part of the workflow. That said, one should keep in mind
that thanks to <a href="https://www.docker.com/">Docker</a> images and the large diversity
of Actions available, GH Actions are powerful and extremely flexible. For R
users interested in using GH Actions to check their package, it is worth noting
that <a href="https://CRAN.R-project.org/package=usethis"><code>usethis</code></a> has several
functions to add such workflows:</p>
<pre class="r"><code>library(usethis)
use_github_action() 
# there are different level of completeness, see the documentation 
# and select the one you need! 
use_github_action_check_release()
use_github_action_check_standard()
use_github_action_check_full()</code></pre>
<p>The workflow I ended up using, <a href="https://github.com/inSileco/inSilecoMisc/blob/master/.github/workflows/R-CMD-check.yaml">R-CMD-check.yaml</a> (appended at the end of the post) is based on one of the template file available in <a href="https://CRAN.R-project.org/package=usethis"><code>usethis</code></a>
that I’ve simplified a bit (I use only 4 combinations OS / R versions) and extended to use the <a href="chttps://codecov.io/">CodeCov</a> and deploy the website.</p>
</div>
<div id="code-coverage" class="section level2">
<h2>Code coverage</h2>
<p>To use <a href="chttps://codecov.io/">CodeCov</a> with Actions, a token is required. So, I clicked on the <code>Settings</code> tab of the <code>inSilecoMisc</code> page and copied the upload token:</p>
<div class="figure">
<img src="codecov.png" alt="&gt;&lt;" style="width:90.0%" />
<p class="caption"><i class="fa fa-info" aria-hidden="true"></i> Screenshot of the CodeCov settings page of <code>inSilecoMisc</code>.</p>
</div>
<p>Then I created a new secret <code>CODECOV_TOKEN</code> on <code>inSileco</code>’s GitHub repository and I pasted the token.</p>
<div class="figure">
<img src="token_codecov.png" alt="&gt;&lt;" style="width:90.0%" />
<p class="caption"><i class="fa fa-info" aria-hidden="true"></i> Screenshot of the Secret tab of the setting of the GitHub <code>inSilecoMisc</code> repository.</p>
</div>
<p>I chose <code>CODECOV_TOKEN</code> because it’s pretty clear, but the name does not matter as long as the same variable name is used in <a href="https://github.com/inSileco/inSilecoMisc/blob/master/.github/workflows/R-CMD-check.yaml">R-CMD-check.yaml</a>. Below is the code bloc in the workflow that handles code coverage:</p>
<pre class="yaml"><code>- name: Test coverage
  if: matrix.config.os == &#39;macOS-latest&#39; &amp;&amp; matrix.config.r == &#39;release&#39;
  run: |
    remotes::install_cran(&quot;covr&quot;)
    covr::codecov(token = &quot;${{secrets.CODECOV_TOKEN}}&quot;)
  shell: Rscript {0}</code></pre>
<p>Note that <code>${{secrets.CODECOV_TOKEN}}</code> returns the token value I set as a secret
above. Also, I used an <code>if:</code> filed to upload the results of the code coverage
only once. I chose to do it on MacOS (for no specific reason) and I kept the
part <code>matrix.config.r == 'release'</code> in case I would add another configuration
(currently, this is useless).</p>
</div>
<div id="website" class="section level2">
<h2>Website</h2>
<div id="build" class="section level3">
<h3>Build</h3>
<p>In order to build the package I simply install <a href="https://CRAN.R-project.org/package=pkdown"><code>pkgdown</code></a> and use it to generates the HTML pages. Below is the code bloc I wrote for this:</p>
<pre class="yaml"><code>- name: Build website 
  if: matrix.config.os == &#39;ubuntu-20.04&#39; &amp;&amp; matrix.config.r == &#39;release&#39;
  run: |
    mkdir docs
    sudo apt-get install libcurl4-openssl-dev libharfbuzz-dev libfribidi-dev
    git fetch origin gh-pages:gh-pages
    git --work-tree=docs checkout gh-pages -- .
    Rscript -e &#39;remotes::install_cran(c(&quot;pkgdown&quot;)); pkgdown::build_site()&#39;</code></pre>
<p>There are a few lines that require some explanations. First, I decided to build this on Ubuntu (again, this is arbitrary). Second, the following line:</p>
<pre class="sh"><code>sudo apt-get install libcurl4-openssl-dev libharfbuzz-dev libfribidi-dev</code></pre>
<p>was required as dependencies were missing for
<a href="https://CRAN.R-project.org/package=curl"><code>curl</code></a> and
<a href="https://CRAN.R-project.org/package=textshaping"><code>textshaping</code></a>. Third, the two
last lines are two git operations that I used to retrieve te content of the
previous commit. I did so to be able to have both the “main” website at
<a href="https://insileco.github.io/inSilecoMisc/" class="uri">https://insileco.github.io/inSilecoMisc/</a> and “dev” version at
<a href="https://insileco.github.io/inSilecoMisc/dev" class="uri">https://insileco.github.io/inSilecoMisc/dev</a> (this is detailed in another post
<a href="https://kevcaz.github.io/notes/ci/deploypkgdown2/">“Deploy a pkgdown website on gh-pages
manually”</a>).</p>
</div>
<div id="deploy" class="section level3">
<h3>Deploy</h3>
<p>To deploy the website to <a href="https://pages.github.com/">GitHub Pages</a>, I used
<a href="https://github.com/peaceiris/actions-gh-pages"><code>peaceiris/actions-gh-pages</code></a>
(version 3). There are two
ways to deploy the website that are well explained in the README of
<a href="https://github.com/peaceiris/actions-gh-pages"><code>peaceiris/actions-gh-pages</code></a>.</p>
</div>
<div id="via-a-deploy-key" class="section level3">
<h3>via a deploy key</h3>
<p>For this, one needs to generate a <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent#generating-a-new-ssh-key">pair of ssh
keys</a>.
On my Debian machine, I used the following command line in my terminal:</p>
<pre class="sh"><code>$ ssh-keygen -t rsa -b 4096 -C &quot;$(git config user.email)&quot; -f gh-pages</code></pre>
<p>Then I set the public key as a deploy key</p>
<div class="figure">
<img src="deploy_key.png" alt="&gt;&lt;" style="width:80.0%" />
<p class="caption"><i class="fa fa-info" aria-hidden="true"></i> Screenshot of the deploy key setting.</p>
</div>
<p>and the private one as a secret.</p>
<div class="figure">
<img src="private.png" alt="&gt;&lt;" style="width:80.0%" />
<p class="caption"><i class="fa fa-info" aria-hidden="true"></i> Screenshot of the secret <code>ACTIONS_DEPLOY_KEY</code>.</p>
</div>
<p>Again, I chose <code>ACTIONS_DEPLOY_KEY</code> for its clarity, but the name does not
matter as long as the correct variable name is used in
<a href="https://github.com/inSileco/inSilecoMisc/blob/master/.github/workflows/R-CMD-check.yaml">R-CMD-check.yaml</a>.</p>
<pre class="yaml"><code>- name: Deploy website 
  if: matrix.config.os == &#39;ubuntu-20.04&#39; &amp;&amp; matrix.config.r == &#39;release&#39;
  uses: peaceiris/actions-gh-pages@v3
  with:
    deploy_key: ${{ secrets.ACTIONS_DEPLOY_KEY }}
    publish_dir: ./docs</code></pre>
<p>I used <code>publish_dir: ./docs</code> as this is where <a href="https://CRAN.R-project.org/package=pkgdown"><code>pkgdown</code> stores</a> stored the web pages in my case
(see the file
<a href="https://github.com/inSileco/inSilecoMisc/blob/master/_pkgdown.yml">_pkgdown.yml</a>).
Note that I didn’t need to specify the branch to be used for the website as
the default is <code>gh-pages</code> and I already had a branch <code>gh-pages</code> set up<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
</div>
<div id="via-a-personal-access-token" class="section level3">
<h3>via a personal access token</h3>
<p>The second option is to <a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token">create and use a personal access token</a> (this is the solution I opted for in the end).</p>
<div class="figure">
<img src="perso_token.png" alt="&gt;&lt;" style="width:90.0%" />
<p class="caption"><i class="fa fa-info" aria-hidden="true"></i> Screenshot of the page to generate the personal token.</p>
</div>
<p>And then set this token as a secret for the repository.</p>
<div class="figure">
<img src="pat_secret.png" alt="&gt;&lt;" style="width:90.0%" />
<p class="caption"><i class="fa fa-info" aria-hidden="true"></i> Screenshot of the secret <code>PERSO_TOKEN</code>.</p>
</div>
<p>Once the secret is set, the variable name should be passed as <code>github_token</code> (instead of <code>deploy_key</code>), like so:</p>
<pre class="yaml"><code>- name: Deploy website 
  if: matrix.config.os == &#39;ubuntu-20.04&#39; &amp;&amp; matrix.config.r == &#39;release&#39;
  uses: peaceiris/actions-gh-pages@v3
  with:
    github_token: ${{ secrets.PERSO_TOKEN }}
    publish_dir: ./docs</code></pre>
<p>Incidentally, <a href="https://github.blog/changelog/2020-05-14-organization-secrets/">organization secrets</a> allow user to have secrets at the organisation level, so that the same token can be used for several repositories!</p>
<p><br/></p>
<p>Everything is working fine now 🎆, check out <a href="https://github.com/inSileco/inSilecoMisc"><code>inSilecoMisc</code></a>! Below is the entire workflow</p>
</div>
</div>
<div id="entire-workflow" class="section level2">
<h2>Entire workflow</h2>
<p>Below is the whole <a href="https://github.com/inSileco/inSilecoMisc/blob/master/.github/workflows/R-CMD-check.yaml">R-CMD-check.yaml</a> file I ended using (note that for recent projects <a href="https://github.blog/changelog/2020-08-26-set-the-default-branch-for-newly-created-repositories/">the default branch name is <code>main</code> instead of <code>master</code></a>).</p>
<pre class="yaml"><code>on:
  push:
    branches:
      - master
  pull_request:
    branches:
      - master

name: R-CMD-check

jobs:
  R-CMD-check:
    runs-on: ${{ matrix.config.os }}

    name: ${{ matrix.config.os }} (${{ matrix.config.r }})

    strategy:
      fail-fast: false
      matrix:
        config:
          - {os: windows-latest, r: &#39;release&#39;}
          - {os: macOS-latest, r: &#39;release&#39;}
          - {os: ubuntu-20.04, r: &#39;release&#39;, rspm: &quot;https://packagemanager.rstudio.com/cran/__linux__/focal/latest&quot;}
          - {os: ubuntu-20.04, r: &#39;devel&#39;, rspm: &quot;https://packagemanager.rstudio.com/cran/__linux__/focal/latest&quot;}

    env:
      R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
      CRAN: ${{ matrix.config.cran }}

    steps:
      - uses: actions/checkout@v1

      - uses: r-lib/actions/setup-r@master
        with:
          r-version: ${{ matrix.config.r }}

      - uses: r-lib/actions/setup-pandoc@master

      - name: Query dependencies
        run: |
          install.packages(&#39;remotes&#39;)
          saveRDS(remotes::dev_package_deps(dependencies = TRUE), &quot;depends.Rds&quot;, version = 2)
        shell: Rscript {0}

      - name: Cache R packages
        if: runner.os != &#39;Windows&#39;
        uses: actions/cache@v1
        with:
          path: ${{ env.R_LIBS_USER }}
          key: ${{ runner.os }}-r-${{ matrix.config.r }}-${{ hashFiles(&#39;depends.Rds&#39;) }}
          restore-keys: ${{ runner.os }}-r-${{ matrix.config.r }}-

      - name: Install system dependencies
        if: runner.os == &#39;Linux&#39;
        env:
          RHUB_PLATFORM: linux-x86_64-ubuntu-gcc
        run: |
          Rscript -e &quot;remotes::install_github(&#39;r-hub/sysreqs&#39;)&quot;
          sysreqs=$(Rscript -e &quot;cat(sysreqs::sysreq_commands(&#39;DESCRIPTION&#39;))&quot;)
          sudo -s eval &quot;$sysreqs&quot;
      - name: Install dependencies
        run: |
          library(remotes)
          deps &lt;- readRDS(&quot;depends.Rds&quot;)
          deps[[&quot;installed&quot;]] &lt;- vapply(deps[[&quot;package&quot;]], remotes:::local_sha, character(1))
          update(deps)
          remotes::install_cran(&quot;rcmdcheck&quot;)
        shell: Rscript {0}

      - name: Check
        run: rcmdcheck::rcmdcheck(args = &quot;--no-manual&quot;, error_on = &quot;warning&quot;, check_dir = &quot;check&quot;)
        shell: Rscript {0}

      - name: Upload check results
        if: failure()
        uses: actions/upload-artifact@master
        with:
          name: ${{ runner.os }}-r${{ matrix.config.r }}-results
          path: check

      - name: Test coverage
        if: matrix.config.os == &#39;macOS-latest&#39; &amp;&amp; matrix.config.r == &#39;release&#39;
        run: |
          remotes::install_cran(&quot;covr&quot;)
          covr::codecov(token = &quot;${{secrets.CODECOV_TOKEN}}&quot;)
        shell: Rscript {0}
    
      - name: Build website 
        if: matrix.config.os == &#39;ubuntu-20.04&#39; &amp;&amp; matrix.config.r == &#39;release&#39;
        run: |
          sudo apt-get install libcurl4-openssl-dev libharfbuzz-dev libfribidi-dev
          mkdir docs
          git fetch origin gh-pages:gh-pages
          git --work-tree=docs checkout gh-pages -- .
          Rscript -e &#39;remotes::install_cran(c(&quot;pkgdown&quot;)); pkgdown::build_site()&#39;
            
      - name: Deploy website 
        if: matrix.config.os == &#39;ubuntu-20.04&#39; &amp;&amp; matrix.config.r == &#39;release&#39;
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.PERSO_TOKEN }}
          publish_dir: ./docs</code></pre>
<p>Hope this could be of help 😄!</p>
<p><br/></p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>see <a href="https://kevcaz.github.io/notes/ci/githubactions/">my first post about GitHub Actions</a> on my personal blog.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Use <code>publish_branch: your-branch</code> to set <code>your-branch</code> as the branch were files will be published.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
</description>
    </item>
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    <item>
      <title>Custom tick marks with R&#39;s base graphics system</title>
      <link>https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/</link>
      <pubDate>Sat, 29 Aug 2020 00:00:00 +0000</pubDate>
      
      <guid>https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/</guid>
      <description>


<div id="context" class="section level2">
<h2>Context</h2>
<p>If you are using R’s base graphics system for your plots and if you like
customizing your plots, you may have already wondered how to custom the tick
marks of your plots! I do that quite a lot and I thought it would be worth
explaining how I do so. Let’s consider the following plot,</p>
<pre class="r"><code>cx &lt;- seq(0, 2, 0.1)
cy &lt;- cx + .5*rnorm(length(cx))
plot(cx, cy)</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/prob-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>By default, <code>plot.default</code> internally has its way to decide where tick marks
should be added. It is always a good default choice, but sometimes not the one
you’re looking for. Fortunately, the core package <code>graphics</code> includes all what
you need to custom the tick marks and so, without further ado, let’s custom our
ticks!</p>
</div>
<div id="remove-axes-and-add-them-back" class="section level2">
<h2>Remove axes and add them back</h2>
<p>The first step is to remove all axes. There are basically two ways. One option
is to use <code>xaxt = "n"</code> and <code>yaxt = "n"</code> to selectively remove the x-axis and
the y-axis, respectively.</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The second option is to set <code>axes</code> to <code>FALSE</code> in <code>plot()</code>:</p>
<pre class="r"><code>plot(cx, cy, axes = FALSE)</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>As you can see, when <code>axes = FALSE</code> the box is also removed and you can actually add it back with <code>box()</code>:</p>
<pre class="r"><code>plot(cx, cy, axes = FALSE)
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>and change its style, if desired:</p>
<pre class="r"><code>plot(cx, cy, axes = FALSE)
box(bty = &quot;l&quot;)</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>That being said, let’s only remove the x-axis for the moment and add ticks at 0,
0.5, 1, 1.5 and 2 to the x-axis using <code>axis()</code>:</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5))</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>I can easily change the labels if values on the axis are not the ones that
should be displayed, e.g.</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = letters[1:5])</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="second-set-of-tick-marks" class="section level2">
<h2>Second set of tick marks</h2>
<p>Now, let’s add a second set tick marks! This can be done by calling <code>axis()</code> one
more time.</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5))
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA)</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>As you may have noticed, I use <code>setdiff()</code> to select the complementary set of
ticks. I think it is an efficient of proceeding: I first select the finest gap
between two ticks (here 0.1) and create the sequence with <code>seq()</code>, then create
the main set of tick marks and finally use <code>setdiff()</code> will to add the
remaining tick marks. Also here, as I don’t want to add extra labels, I just set
the labels to <code>NA</code>.</p>
</div>
<div id="remove-the-extra-line" class="section level2">
<h2>Remove the extra line</h2>
<p>The main reason why I adjust the tick marks on my plots is because <code>axis()</code> and
<code>box()</code> add lines that partially overlap (this is also true when you use the
default behavior of <code>plot()</code>): the lines that comes along with the ticks</p>
<pre class="r"><code>plot(cx, cy, axes = FALSE)
axis(2)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5))
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA)</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>overlap with the box</p>
<pre class="r"><code>plot(cx, cy, axes = FALSE)
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This may frequently goes unnoticed, but I personally tend to notice such overlap
this and it annoys me… Anyway, one way to handle this is to set the line width
to 0 in <code>axis()</code>.</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5), lwd = 0)
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA, lwd = 0)</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>and then to set the line with of the ticks, controlled by <code>lwd.ticks</code>, to
something greater than 0</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5), lwd = 0, lwd.ticks = 1)
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA, lwd = NA, lwd.ticks = 1)
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note that if you only wish to remove the marks you can use <code>tick = FALSE</code>.</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5), tick = FALSE)
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA, tick = FALSE)
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>But if you just want to get rid of the extra line, but not the ticks, then you
need set <code>lwd</code> to 0 and <code>lwd.ticks</code> to a positive values.</p>
</div>
<div id="custom-the-ticks" class="section level2">
<h2>Custom the ticks</h2>
<p>Having done the steps above, you may have realized that fine-tuning <code>lwd.ticks</code>
is a good way to custom your tick marks!</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5), lwd = 0, lwd.ticks = 1.5)
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA, lwd = 0, lwd.ticks = .5)
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>A second parameter to further customize the tick marks is <code>tck</code> that actually
belongs to <code>par()</code></p>
<pre class="r"><code>par(tck = -0.07)
plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5), lwd = 0,
  lwd.ticks = 1)
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA, lwd.ticks = 1)
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/tckinpar-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>but can also be used with <code>axis()</code> thanks to the ellipsis (<code>...</code>) which allow me
to change it only for one set of ticks</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5), lwd = 0, tck = -0.07,
  lwd.ticks = 1)
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA, lwd.ticks = 1)
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/tckinaxis-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Moreover, using positive value you can make the tick go up!</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5), lwd = 0, tck = 0.07,
  lwd.ticks = 1)
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA, lwd.ticks = 1)
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>And finally you change many aspect of them, including color then and line type:</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5), lwd = 0, lwd.ticks = 1.5, tck = -.07, col = 2, lty = 2)
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA, lwd.ticks = .5, tck = -.03, col = 3)
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>One more tip, if you need to adjust the position of the tick you would have to
use <code>mgp</code> (also documented in <code>par</code>) which is a vector of three elements
controlling the following features:</p>
<ol style="list-style-type: decimal">
<li>the position of the axis labels,</li>
<li>the position of the tick labels,</li>
<li>the positon on the tick marks.</li>
</ol>
<pre class="r"><code>par(mgp = c(2.5, 1.6, 0))
plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5), lwd = 0, lwd.ticks = 1.5,
  tck = -.1, col = 2, lty = 2)
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA, lwd.ticks = .5, tck = -.03, col = 3)
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/mgp-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note that, just as for <code>tck</code>, I can use <code>mgp</code> in <code>axis()</code>. In this example, it
won’t affected the axis labels because they were added by <code>plot()</code>.</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;)
axis(1, at = seq(0, 2, .5), labels = seq(0, 2, .5), lwd = 0, lwd.ticks = 1.5,
  tck = -.1, col = 2, lty = 2)
axis(1, at = setdiff(cx, seq(0, 2, .5)), labels = NA, lwd.ticks = .5, tck = -.03, col = 3, mgp = c(2.5, 1.6, 0))
box()</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/mgpinaxis-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="wrap-all-that-up-in-a-function" class="section level2">
<h2>Wrap all that up in a function</h2>
<p>All the steps above may appear overwhelming at first because you need to
memorize where is what… But once everything gets clear, you would realize that
for most of your plots you need to tweak the same parameters and so that you can
create your own function that would cover your needs. For instance, I often use
a function similar to the one below:</p>
<pre class="r"><code>myaxis &lt;- function(side, all, main, lab = main, col1 = 1, col2 = 1, ...) {
  axis(side, at = main, labels = lab, lwd = 0, lwd.ticks = 1, col = col1, ...)
  axis(side, at = setdiff(all, main), labels = NA, lwd.ticks = .75, tck = -.025,
    col = col2, ...)
}</code></pre>
<p>which basically makes the customization of tick marks very easy!</p>
<pre class="r"><code>plot(cx, cy, xaxt = &quot;n&quot;, yaxt = &quot;n&quot;)
myaxis(1, cx, seq(0, 2, .5))
myaxis(2, seq(-0.5, 2.8, .1), seq(-0.5, 2.5, .5), las = 1)</code></pre>
<p><img src="https://insileco.github.io/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/index_files/figure-html/final-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><br></p>
<div id="thats-all-folks-smile" class="section level4">
<h4>That’s all folks 😄!</h4>
<div style="padding: 2rem 0rem 2rem 0rem;">
<details>
<summary>
Session info <i class="fa fa-cogs" aria-hidden="true"></i>
</summary>
<pre class="r"><code>sessionInfo()
#R&gt;  R version 4.2.0 (2022-04-22)
#R&gt;  Platform: x86_64-pc-linux-gnu (64-bit)
#R&gt;  Running under: Ubuntu 20.04.4 LTS
#R&gt;  
#R&gt;  Matrix products: default
#R&gt;  BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
#R&gt;  LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
#R&gt;  
#R&gt;  locale:
#R&gt;   [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
#R&gt;   [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
#R&gt;   [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
#R&gt;  [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   
#R&gt;  
#R&gt;  attached base packages:
#R&gt;  [1] stats     graphics  grDevices utils     datasets  methods   base     
#R&gt;  
#R&gt;  other attached packages:
#R&gt;  [1] inSilecoRef_0.0.1.9000
#R&gt;  
#R&gt;  loaded via a namespace (and not attached):
#R&gt;   [1] tidyselect_1.1.2  xfun_0.31         bslib_0.3.1       purrr_0.3.4      
#R&gt;   [5] vctrs_0.4.1       generics_0.1.2    miniUI_0.1.1.1    htmltools_0.5.2  
#R&gt;   [9] yaml_2.3.5        utf8_1.2.2        rlang_1.0.2       later_1.3.0      
#R&gt;  [13] pillar_1.7.0      jquerylib_0.1.4   httpcode_0.3.0    glue_1.6.2       
#R&gt;  [17] DBI_1.1.2         lifecycle_1.0.1   plyr_1.8.7        stringr_1.4.0    
#R&gt;  [21] blogdown_1.10     htmlwidgets_1.5.4 evaluate_0.15     knitr_1.39       
#R&gt;  [25] fastmap_1.1.0     httpuv_1.6.5      curl_4.3.2        fansi_1.0.3      
#R&gt;  [29] highr_0.9         Rcpp_1.0.8.3      xtable_1.8-4      promises_1.2.0.1 
#R&gt;  [33] DT_0.23           jsonlite_1.8.0    rcrossref_1.1.0   mime_0.12        
#R&gt;  [37] digest_0.6.29     stringi_1.7.6     bookdown_0.27     dplyr_1.0.9      
#R&gt;  [41] shiny_1.7.1       cli_3.3.0         tools_4.2.0       magrittr_2.0.3   
#R&gt;  [45] sass_0.4.1        tibble_3.1.7      RefManageR_1.3.0  crul_1.2.0       
#R&gt;  [49] crayon_1.5.1      pkgconfig_2.0.3   ellipsis_0.3.2    xml2_1.3.3       
#R&gt;  [53] lubridate_1.8.0   assertthat_0.2.1  rmarkdown_2.14    httr_1.4.3       
#R&gt;  [57] R6_2.5.1          compiler_4.2.0</code></pre>
</details>
</div>
</div>
</div>
</description>
    </item>
		
    
		
    
		
    
		
    
		
    
		
    
		
    <item>
      <title>inSilecoMisc 0.4.0 (part 2/2)</title>
      <link>https://insileco.github.io/2020/04/21/insilecomisc-0.4.0-part-2/2/</link>
      <pubDate>Tue, 21 Apr 2020 00:00:00 +0000</pubDate>
      
      <guid>https://insileco.github.io/2020/04/21/insilecomisc-0.4.0-part-2/2/</guid>
      <description>


<p>In the <a href="/2020/04/05/insilecomisc-0.4.0-part-1/2/">first part of this post</a> I
introduced several functions available in the package <a href="https://github.com/inSileco/inSilecoMisc"><code>inSilecoMisc</code></a>. In this post, I keep on introducing features of the package you
might find useful! If you did not read the first part of this post and are
interested in reproducing the examples below, simply install <code>inSilecoMisc</code>:</p>
<pre class="r"><code># Run if package is not already installed
install.packages(&quot;remotes&quot;)
remotes::install_github(&quot;inSileco/inSilecoMisc&quot;)</code></pre>
<p>Load it:</p>
<pre class="r"><code>library(&quot;inSilecoMisc&quot;)
packageVersion(&quot;inSilecoMisc&quot;)
#R&gt;  [1] &#39;0.7.0&#39;</code></pre>
<p>and you’re good to go!</p>
<div id="scalewithin" class="section level2">
<h2>scaleWithin()</h2>
<p>I wrote <a href="https://insileco.github.io/inSilecoMisc/reference/scaleWithin.html"><code>scaleWithin()</code></a> to handle color scales for a specific yet frequent situation. Let us say that I have 40 percentage values – meaning 0 to 100 – in a vector <code>val</code>…</p>
<pre class="r"><code>val &lt;- runif(40, 0, 100)
val
#R&gt;   [1] 34.875652 38.511515 30.560805 92.392834 24.097075 18.938671  5.781485
#R&gt;   [8] 96.170072 81.873451 71.751930 52.112273 34.205876  2.448017 75.996988
#R&gt;  [15] 17.523078 65.951112 20.218500 93.358882 39.845142  8.569140 90.848570
#R&gt;  [22] 53.808177 57.875599 53.889801  5.928599 41.439002 59.079702 91.928032
#R&gt;  [29] 59.775643 46.296324 79.180360 27.768791 59.981328 79.607312 43.844089
#R&gt;  [36] 72.347002 15.266700 88.011357  1.205310 95.099086</code></pre>
<p>… <strong>and</strong> that I wish to create a color scale with 25 tones. I use <a href="http://insileco.github.io/graphicsutils/reference/showPalette.html"><code>showPalette()</code></a> to show the color palette:</p>
<pre class="r"><code>pal &lt;- colorRampPalette(c(&quot;#f9fa98&quot;, &quot;#500127&quot;))(25)
graphicsutils::showPalette(pal)</code></pre>
<p><img src="https://insileco.github.io/2020/04/21/insilecomisc-0.4.0-part-2/2/index_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>But</strong> the color scale should be used for the range [30%-70%], meaning that values below 30% should have the lowest values and values above 70%, the highest one. The caption should thus indicate <span class="math inline">\(\geqslant\)</span> 30% and <span class="math inline">\(\leqslant\)</span> 70%. Then the function <code>scaleWithin()</code> is very handy!</p>
<pre class="r"><code>scaleWithin(val, n = 25, mn = 30, mx = 70)
#R&gt;   [1]  4  6  1 25  1  1  1 25 25 25 14  3  1 25  1 23  1 25  7  1 25 15 18 15  1
#R&gt;  [26]  8 19 25 19 11 25  1 19 25  9 25  1 25  1 25
graphicsutils::showPalette(pal[scaleWithin(val, n = 25, mn = 30, mx = 70)], add_codecolor = FALSE)</code></pre>
<p><img src="https://insileco.github.io/2020/04/21/insilecomisc-0.4.0-part-2/2/index_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Even though this function is pretty useful – at least I think it is! – I had a
lot of trouble conveying why! So, in the last version of <code>inSilecoMisc</code>, I
re-wrote the entire documentation and I hope that, together with this example,
others will, as I so, find it useful.</p>
</div>
<div id="messages" class="section level2">
<h2>Messages</h2>
<p>Daily, I <strong>use</strong> R packages and R functions to analyze data, create
model, run simulations, and a number of other things! So I write scripts that combine functions from
various packages to create pipelines that do the analyses I need. When running
such scripts, I like having information reported on a clear and visual way, that is why I value packages such as
<a href="https://CRAN.R-project.org/package=progress"><code>progress</code></a>, <a href="https://CRAN.R-project.org/package=crayon"><code>crayon</code></a> and <a href="https://CRAN.R-project.org/package=cli"><code>cli</code></a>. In
<code>inSilecoMisc</code>, inspired by messages reported by <a href="https://CRAN.R-project.org/package=devtools"><code>devtools</code></a> when
building a package, I created four simple message functions using <a href="https://CRAN.R-project.org/package=crayon"><code>crayon</code></a> and <a href="https://CRAN.R-project.org/package=cli"><code>cli</code></a> packages to standardize messages in my scripts.</p>
<pre class="r"><code># 1. msgInfo() indicates what the upcoming computation
msgInfo(&quot;this is what&#39;s gonna happen next&quot;)
#R&gt;  ℹ this is what&#39;s gonna happen next</code></pre>
<pre class="r"><code># 2. msgWarning() reminds me something important that should not affect the run
msgWarning(&quot;Got to be careful&quot;)
#R&gt;  ⚠ Got to be careful</code></pre>
<pre class="r"><code># 3. msgError() when something went wrong (and I anticipated that it could happen)
msgError(&quot;Something wrong&quot;)
#R&gt;  ✖ Something wrong</code></pre>
<pre class="r"><code># 4. msgSuccess() when a step/ a computation has been successfully completed
msgSuccess(&quot;All good&quot;)
#R&gt;  ✔ All good</code></pre>
<p>These functions help me structure my scripts. Here is a contrived example:</p>
<pre class="r"><code>scr_min &lt;- function() {
  # msgInfo() lets me know where I am in the script
  msgInfo(&quot;Average random values&quot;)
  set.seed(111)
  out &lt;- mean(runif(100))
  msgSuccess(&quot;Done!&quot;)
  # msgSuccess() indicates the successful completion of this part
  out
}
scr_min()
#R&gt;  ℹ Average random values
#R&gt;  ✔ Done!
#R&gt;  [1] 0.4895239</code></pre>
<p>Another helpful aspect of these functions is that they all are based on <code>message()</code>. As such, if I want to execute a script quietly, all I need to do is to call <code>suppressMessages()</code> beforehand</p>
<pre class="r"><code># quiet run
suppressMessages(scr_min())
#R&gt;  [1] 0.4895239</code></pre>
<p>If you want to see an example of how I use these functions in a script for a scientific manuscript,
check out the research compendium
<a href="https://github.com/TheoreticalEcosystemEcology/coocNotInteract">coocNotInteract</a>.</p>
</div>
<div id="tbldown" class="section level2">
<h2>tblDown()</h2>
<p>Last but not least, I’d like to introduce a function to quickly write table data
frame (or a list of data frames) in documents of various formats. I created
<a href="https://insileco.github.io/inSilecoMisc/reference/tblDownn.html"><code>tblDown()</code></a>
for a colleague of mine that was looking for a quick way to export a table. In
the package <a href="https://CRAN.R-project.org/package=knitr"><code>knitr</code></a>, there is the very handy function <code>kable()</code>
that quickly writes a data frame in various formats.</p>
<pre class="r"><code>knitr::kable(head(CO2))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Plant</th>
<th align="left">Type</th>
<th align="left">Treatment</th>
<th align="right">conc</th>
<th align="right">uptake</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">95</td>
<td align="right">16.0</td>
</tr>
<tr class="even">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">175</td>
<td align="right">30.4</td>
</tr>
<tr class="odd">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">250</td>
<td align="right">34.8</td>
</tr>
<tr class="even">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">350</td>
<td align="right">37.2</td>
</tr>
<tr class="odd">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">500</td>
<td align="right">35.3</td>
</tr>
<tr class="even">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">675</td>
<td align="right">39.2</td>
</tr>
</tbody>
</table>
<p>I wrote a function that calls <code>kable()</code> to write the data frame
and then renders the table(s) in the
desired format indicated by the extension of the output file (<code>docx</code> by
default) using <a href="https://pandoc.org/">pandoc</a>.</p>
<pre class="r"><code># NB tblDown(head(CO2)) returns table.docx by default
tblDown(head(CO2), output_file = &quot;table.odt&quot;)</code></pre>
<p>
<center>
  <figure>
    <img class="mg-bot" src="/2020/04/21/insilecomisc-0.4.0-part-2/2/table_odt.png" alt="table_odt.png (screenshot)" width="90%%" >
    <figcaption><span class="highlight">table_odt.png (screenshot)</span></figcaption>
  </figure>
</center>


</p>
<p>As I mentioned above <code>tblDown()</code> handles lists of data frames and the user can also provide a set of captions for every table and even separate them with section headers (of level 1).</p>
<pre class="r"><code>tblDown(list(head(CO2), tail(CO2)), output_file = &quot;tables.pdf&quot;,
  caption = c(&quot;This is the head of CO2&quot;, &quot;This is the tail of CO2&quot;),
  section = &quot;Table&quot;)</code></pre>
<p>Check out the output file ➡️ <a href="tables.pdf"><i class="fa
fa-file-pdf-o"></i></a>! Note that in the example above I only use one
character string for <code>section</code> and <code>tblDown()</code> has appended an index; this is
also the default behavior for <code>caption</code>: if there are less captions
or sections titles than data frames, vectors of captions (and/or sections) are repeated and an index is appended.</p>
<p>If you are already writing your documents with <a href="https://rmarkdown.rstudio.com/">R
Markdown</a>, you may not need this. Yet keep in mind that
<code>tblDown()</code> quickly exports tables in various formats with only one line of
command!</p>
<div id="thats-all-folks-tada" class="section level4">
<h4>That’s all folks 🎉!</h4>
<div style="padding: 2rem 0rem 2rem 0rem;">
<details>
<summary>
Session info <i class="fa fa-cogs" aria-hidden="true"></i>
</summary>
<pre class="r"><code>sessionInfo()
#R&gt;  R version 4.2.0 (2022-04-22)
#R&gt;  Platform: x86_64-pc-linux-gnu (64-bit)
#R&gt;  Running under: Ubuntu 20.04.4 LTS
#R&gt;  
#R&gt;  Matrix products: default
#R&gt;  BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
#R&gt;  LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
#R&gt;  
#R&gt;  locale:
#R&gt;   [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
#R&gt;   [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
#R&gt;   [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
#R&gt;  [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   
#R&gt;  
#R&gt;  attached base packages:
#R&gt;  [1] stats     graphics  grDevices utils     datasets  methods   base     
#R&gt;  
#R&gt;  other attached packages:
#R&gt;  [1] inSilecoMisc_0.7.0     inSilecoRef_0.0.1.9000
#R&gt;  
#R&gt;  loaded via a namespace (and not attached):
#R&gt;   [1] tidyselect_1.1.2         xfun_0.31                bslib_0.3.1             
#R&gt;   [4] purrr_0.3.4              vctrs_0.4.1              generics_0.1.2          
#R&gt;   [7] miniUI_0.1.1.1           htmltools_0.5.2          yaml_2.3.5              
#R&gt;  [10] utf8_1.2.2               rlang_1.0.2              later_1.3.0             
#R&gt;  [13] pillar_1.7.0             jquerylib_0.1.4          httpcode_0.3.0          
#R&gt;  [16] glue_1.6.2               DBI_1.1.2                lifecycle_1.0.1         
#R&gt;  [19] plyr_1.8.7               stringr_1.4.0            blogdown_1.10           
#R&gt;  [22] htmlwidgets_1.5.4        evaluate_0.15            knitr_1.39              
#R&gt;  [25] fastmap_1.1.0            httpuv_1.6.5             curl_4.3.2              
#R&gt;  [28] fansi_1.0.3              highr_0.9                Rcpp_1.0.8.3            
#R&gt;  [31] xtable_1.8-4             promises_1.2.0.1         DT_0.23                 
#R&gt;  [34] jsonlite_1.8.0           rcrossref_1.1.0          mime_0.12               
#R&gt;  [37] digest_0.6.29            stringi_1.7.6            bookdown_0.27           
#R&gt;  [40] dplyr_1.0.9              shiny_1.7.1              cli_3.3.0               
#R&gt;  [43] tools_4.2.0              graphicsutils_1.6.0.9000 magrittr_2.0.3          
#R&gt;  [46] sass_0.4.1               tibble_3.1.7             RefManageR_1.3.0        
#R&gt;  [49] crul_1.2.0               crayon_1.5.1             pkgconfig_2.0.3         
#R&gt;  [52] ellipsis_0.3.2           xml2_1.3.3               lubridate_1.8.0         
#R&gt;  [55] assertthat_0.2.1         rmarkdown_2.14           httr_1.4.3              
#R&gt;  [58] R6_2.5.1                 compiler_4.2.0</code></pre>
</details>
</div>
</div>
</div>
</description>
    </item>
		
    
		
    
		
    
		
    <item>
      <title>inSilecoMisc 0.4.0 (part 1/2)</title>
      <link>https://insileco.github.io/2020/04/14/insilecomisc-0.4.0-part-1/2/</link>
      <pubDate>Tue, 14 Apr 2020 00:00:00 +0000</pubDate>
      
      <guid>https://insileco.github.io/2020/04/14/insilecomisc-0.4.0-part-1/2/</guid>
      <description>


<div id="insilecomisc" class="section level2">
<h2>inSilecoMisc</h2>
<p><a href="https://github.com/inSileco/inSilecoMisc"><code>inSilecoMisc</code></a> is an R 📦 I
have been maintaining for four years now. It was originally designed as a
convenient way to share handy functions. Instead of stacking them in my
<code>.Rprofile</code>, I created a package and made it available on GitHub. <code>inSilecoMisc</code>
is therefore a set of miscellaneous functions, just as other R packages (e.g.
<a href="https://CRAN.R-project.org/package=Hmisc"><code>Hmisc</code></a>) but as I frequently change its API,
it is meant to stay in the experimental stage! I like having <code>inSilecoMisc</code> on
GitHub because it gives a large degree of freedom to experiment new ideas, new
functions and the code remains available and easy to install! Despite the “API
instability”, the overall quality of the package is constantly improving (at
least, I hope so 😄). I have even included some of the somewhat more
matured functions in the research compendium of recent manuscripts<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>Over the last month, I made substantial changes throughout the package. I
re-wrote some functions, improved the documentation of others and added new
features. I also changed the way the <a href="https://kevcaz.github.io/notes/ci/deploypkgdown2/">pkgdown
website is deployed</a> by
<a href="https://travis-ci.org/github/inSileco/inSilecoMisc">Travis</a>. In what follows, I introduced several functions included in
versions 0.4.0. Note that as <code>inSilecoMisc</code> is on GitHub, an easy way
to install <code>inSilecoMisc</code> is provided by the package
<a href="https://cran.r-project.org/web/packages/remotes/index.html"><code>remotes</code></a></p>
<pre class="r"><code>install.packages(&quot;remotes&quot;) # if not already installed
remotes::install_github(&quot;inSileco/inSilecoMisc&quot;)</code></pre>
<p>Once installed, let’s load it!</p>
<pre class="r"><code>library(&quot;inSilecoMisc&quot;)
packageVersion(&quot;inSilecoMisc&quot;)
#R&gt;  [1] &#39;0.7.0&#39;</code></pre>
</div>
<div id="adjuststrings" class="section level2">
<h2>adjustStrings</h2>
<p>As an ecologist, I frequently work with multiple datasets, and I often need to
name/rename a bunch of files. One function I often use to do so is <code>sprintf()</code>:</p>
<pre class="r"><code>sprintf(&quot;file_%02d&quot;, 1:10)
#R&gt;   [1] &quot;file_01&quot; &quot;file_02&quot; &quot;file_03&quot; &quot;file_04&quot; &quot;file_05&quot; &quot;file_06&quot; &quot;file_07&quot;
#R&gt;   [8] &quot;file_08&quot; &quot;file_09&quot; &quot;file_10&quot;</code></pre>
<p>I originally designed
<a href="https://insileco.github.io/inSilecoMisc/reference/adjustStrings.html"><code>adjustStrings()</code></a>
to adjust the number of 0 to a string in a similar fashion:</p>
<pre class="r"><code>adjustStrings(1:10, n = 2)
#R&gt;   [1] &quot;01&quot; &quot;02&quot; &quot;03&quot; &quot;04&quot; &quot;05&quot; &quot;06&quot; &quot;07&quot; &quot;08&quot; &quot;09&quot; &quot;10&quot;</code></pre>
<p>But I was rapidly interested in having a more flexible function. So, I added several parameters to do that!
In the last version of <code>inSilecoMisc</code>, <code>adjustStrings()</code> have 5 arguments:</p>
<ol style="list-style-type: decimal">
<li><code>x</code>: the input character vector to be adjusted;</li>
<li><code>n</code>: the number of characters to be added or used to determine the length of output strings;</li>
<li><code>extra</code>: the character(s) to be added (<code>0</code> is the default value);</li>
<li><code>align</code>: the string alignment (“right”, “left” or “center”);</li>
<li><code>add</code>: whether <code>n</code> should be the constraint or a number of characters to be added (a constraint by default).</li>
</ol>
<p>By default, <code>adjustStrings()</code> uses <code>n</code> as a constrain for the length of the output strings. so if use <code>n = 4</code> instead of <code>n = 2</code> in the first example, all
elements of the output vector will have 4 characters:</p>
<pre class="r"><code>adjustStrings(1:10, n = 4)
#R&gt;   [1] &quot;0001&quot; &quot;0002&quot; &quot;0003&quot; &quot;0004&quot; &quot;0005&quot; &quot;0006&quot; &quot;0007&quot; &quot;0008&quot; &quot;0009&quot; &quot;0010&quot;</code></pre>
<p>Add I change the value of <code>extra</code> to specify the replacement character(s) to be used :</p>
<pre class="r"><code>adjustStrings(1:10, n = 4, extra = 1)
#R&gt;   [1] &quot;1111&quot; &quot;1112&quot; &quot;1113&quot; &quot;1114&quot; &quot;1115&quot; &quot;1116&quot; &quot;1117&quot; &quot;1118&quot; &quot;1119&quot; &quot;1110&quot;
adjustStrings(1:10, n = 4, extra = &quot;a&quot;)
#R&gt;   [1] &quot;aaa1&quot; &quot;aaa2&quot; &quot;aaa3&quot; &quot;aaa4&quot; &quot;aaa5&quot; &quot;aaa6&quot; &quot;aaa7&quot; &quot;aaa8&quot; &quot;aaa9&quot; &quot;aa10&quot;
adjustStrings(1:10, n = 4, extra = &quot;-&quot;)
#R&gt;   [1] &quot;---1&quot; &quot;---2&quot; &quot;---3&quot; &quot;---4&quot; &quot;---5&quot; &quot;---6&quot; &quot;---7&quot; &quot;---8&quot; &quot;---9&quot; &quot;--10&quot;
adjustStrings(1:10, n = 4, extra = &quot;ab&quot;)
#R&gt;   [1] &quot;aba1&quot; &quot;aba2&quot; &quot;aba3&quot; &quot;aba4&quot; &quot;aba5&quot; &quot;aba6&quot; &quot;aba7&quot; &quot;aba8&quot; &quot;aba9&quot; &quot;ab10&quot;</code></pre>
<p>With <code>align</code>, I can choose where extra characters are added:</p>
<pre class="r"><code>adjustStrings(1:10, n = 4, extra = &quot;-&quot;, align = &quot;right&quot;) # default
#R&gt;   [1] &quot;---1&quot; &quot;---2&quot; &quot;---3&quot; &quot;---4&quot; &quot;---5&quot; &quot;---6&quot; &quot;---7&quot; &quot;---8&quot; &quot;---9&quot; &quot;--10&quot;
adjustStrings(1:10, n = 4, extra = &quot;-&quot;, align = &quot;left&quot;)
#R&gt;   [1] &quot;1---&quot; &quot;2---&quot; &quot;3---&quot; &quot;4---&quot; &quot;5---&quot; &quot;6---&quot; &quot;7---&quot; &quot;8---&quot; &quot;9---&quot; &quot;10--&quot;
adjustStrings(1:10, n = 4, extra = &quot;-&quot;, align = &quot;center&quot;)
#R&gt;   [1] &quot;--1-&quot; &quot;--2-&quot; &quot;--3-&quot; &quot;--4-&quot; &quot;--5-&quot; &quot;--6-&quot; &quot;--7-&quot; &quot;--8-&quot; &quot;--9-&quot; &quot;-10-&quot;</code></pre>
<p>Also, if <code>add = TRUE</code>, then exactly <code>n</code> extra characters are added:</p>
<pre class="r"><code>adjustStrings(1:10, n = 4, extra = &quot;-&quot;, align = &quot;right&quot;, add = TRUE)
#R&gt;   [1] &quot;----1&quot;  &quot;----2&quot;  &quot;----3&quot;  &quot;----4&quot;  &quot;----5&quot;  &quot;----6&quot;  &quot;----7&quot;  &quot;----8&quot; 
#R&gt;   [9] &quot;----9&quot;  &quot;----10&quot;
adjustStrings(1:10, n = 4, extra = &quot;-&quot;, align = &quot;left&quot;, add = TRUE)
#R&gt;   [1] &quot;1----&quot;  &quot;2----&quot;  &quot;3----&quot;  &quot;4----&quot;  &quot;5----&quot;  &quot;6----&quot;  &quot;7----&quot;  &quot;8----&quot; 
#R&gt;   [9] &quot;9----&quot;  &quot;10----&quot;
adjustStrings(1:10, n = 4, extra = &quot;-&quot;, align = &quot;center&quot;, add = TRUE)
#R&gt;   [1] &quot;--1--&quot;  &quot;--2--&quot;  &quot;--3--&quot;  &quot;--4--&quot;  &quot;--5--&quot;  &quot;--6--&quot;  &quot;--7--&quot;  &quot;--8--&quot; 
#R&gt;   [9] &quot;--9--&quot;  &quot;--10--&quot;</code></pre>
<p>Note that in this last case, lengths of output character strings may differ!
One last remark about how <code>adjustStrings()</code> works when <code>add = FALSE</code>: for a given string, there are 3 scenarios :</p>
<ol style="list-style-type: decimal">
<li>the string to be adjusted has more characters than <code>n</code>; in this case, the string is simply cut off:</li>
</ol>
<pre class="r"><code>adjustStrings(&quot;ABCD&quot;, n = 2, extra = &quot;efgh&quot;)
#R&gt;  [1] &quot;AB&quot;</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>the string has more characters but the number of character for the adjustment is smaller than the number of <code>extra</code>’s character; in this case, <code>extra</code> is cut off:</li>
</ol>
<pre class="r"><code>adjustStrings(&quot;ABCD&quot;, n = 6, extra = &quot;efgh&quot;)
#R&gt;  [1] &quot;efABCD&quot;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>finally, when <code>extra</code> is too short to adjust the string according to <code>n</code>, <code>extra</code> is repeated:</li>
</ol>
<pre class="r"><code>adjustStrings(&quot;ABCD&quot;, n = 14, extra = &quot;efgh&quot;)
#R&gt;  [1] &quot;efghefghefABCD&quot;</code></pre>
<p>These combinations give flexibility to the user. One application of the
<code>adjustStrings()</code> function comes when running a long script. In such situation,
it is convenient to create recognizable code section to ease the navigation
across long output!</p>
<pre class="r"><code>report &lt;- function(title, symbol = &quot;#&quot;) {
  cat(adjustStrings(title, 70, symbol, align = &quot;center&quot;), &quot;\n&quot;)
}
report(&quot; part 1 &quot;)
report(&quot; Solving ODE &quot;, &quot;~&quot;)
report(&quot; Last but not least! &quot;, &quot;=&quot;)
#R&gt;  ############################### part 1 ############################### 
#R&gt;  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Solving ODE ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
#R&gt;  ========================= Last but not least! ========================</code></pre>
</div>
<div id="keepwords" class="section level2">
<h2>keepWords</h2>
<p><a href="https://insileco.github.io/inSilecoMisc/reference/keepWords.html"><code>keepWords()</code></a> allows the user to select words based on their position in
character strings. Before using it, I would like to introduce <code>loremIpsum()</code>
that generates <a href="https://en.wikipedia.org/wiki/Lorem_ipsum">placeholder texts</a>.
Note that there are several functions to generate placeholder texts available
elsewhere. For instance, <code>stringi</code> has
<a href="https://jangorecki.gitlab.io/data.cube/library/stringi/html/stri_rand_lipsum.html"><code>stri_rand_lipsum()</code></a>
and <a href="https://www.rdocumentation.org/packages/UsingR/versions/2.0-6/topics/lorem"><code>UsingR</code> includes
<code>lorem()</code></a>.
By default, this <code>loremIpsum()</code> function returns two paragraphs of text:</p>
<pre class="r"><code>cat(loremIpsum())
#R&gt;  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
#R&gt;    tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
#R&gt;    quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
#R&gt;    consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
#R&gt;    cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
#R&gt;    proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
#R&gt;  
#R&gt;    Curabitur pretium tincidunt lacus. Nulla gravida orci a odio. Nullam varius,
#R&gt;    turpis et commodo pharetra, est eros bibendum elit, nec luctus magna felis
#R&gt;    sollicitudin mauris. Integer in mauris eu nibh euismod gravida. Duis ac tellus
#R&gt;    et risus vulputate vehicula. Donec lobortis risus a elit. Etiam tempor. Ut
#R&gt;    ullamcorper, ligula eu tempor congue, eros est euismod turpis, id tincidunt
#R&gt;    sapien risus a quam. Maecenas fermentum consequat mi. Donec fermentum.
#R&gt;    Pellentesque malesuada nulla a mi. Duis sapien sem, aliquet nec, commodo eget,
#R&gt;    consequat quis, neque. Aliquam faucibus, elit ut dictum aliquet, felis nisl
#R&gt;    adipiscing sapien, sed malesuada diam lacus eget erat. Cras mollis scelerisque
#R&gt;    nunc. Nullam arcu. Aliquam consequat. Curabitur augue lorem, dapibus quis,
#R&gt;    laoreet et, pretium ac, nisi. Aenean magna nisl, mollis quis, molestie eu,
#R&gt;    feugiat in, orci. In hac habitasse platea dictumst.
#R&gt;  </code></pre>
<p>but it also allows the user to set the number of words of the character string returned:</p>
<pre class="r"><code>loremIpsum(18)
#R&gt;  [1] &quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod\n tempor incididunt ut labore et dolore magna&quot;</code></pre>
<p>Note the escape characters (<code>\n</code>)! Now let’s focus on <code>keepWords()</code>. Assuming I
want to extract the second word in both sentences <code>loremIpsum(18)</code> and <code>be or not to be</code>, all I have to do is:</p>
<pre class="r"><code>keepWords(c(loremIpsum(18), &quot;be or not to be&quot;), 2)
#R&gt;  [1] &quot;ipsum&quot; &quot;or&quot;</code></pre>
<p>and if I am interested in extracting specific word positions, I can pass a numerical vector:</p>
<pre class="r"><code>keepWords(c(loremIpsum(18), &quot;be or not to be&quot;), c(1:4, 12:16))
#R&gt;  [1] &quot;Lorem ipsum dolor sit tempor incididunt ut labore et&quot;
#R&gt;  [2] &quot;be or not to NA NA NA NA NA&quot;</code></pre>
<p>As you may have noted, <code>NA</code>s are added when the position selected does not
exist. This behavior could be useful but also annoying! Fortunately, an
argument allows to remove <code>NA</code>s.</p>
<pre class="r"><code>keepWords(c(loremIpsum(18), &quot;be or not to be&quot;), c(1:4, 12:16), na.rm = TRUE)
#R&gt;  [1] &quot;Lorem ipsum dolor sit tempor incididunt ut labore et&quot;
#R&gt;  [2] &quot;be or not to&quot;</code></pre>
<p>Also, <code>collapse</code> allows the user to change the character used to separate words:</p>
<pre class="r"><code>keepWords(loremIpsum(18), c(1:6, 14:18), collapse = &quot;-&quot;)
#R&gt;  [1] &quot;Lorem-ipsum-dolor-sit-amet-consectetur-ut-labore-et-dolore-magna&quot;</code></pre>
<p>and if <code>collapse = NULL</code> then list will be returned including a vector of the selected words per input string:</p>
<pre class="r"><code>keepWords(c(loremIpsum(18), &quot;be or not to be&quot;), c(2:3), collapse = NULL)
#R&gt;  [[1]]
#R&gt;  [1] &quot;ipsum&quot; &quot;dolor&quot;
#R&gt;  
#R&gt;  [[2]]
#R&gt;  [1] &quot;or&quot;  &quot;not&quot;</code></pre>
<p>Note that all punctuation characters will be removed. This can be changed by tweaking argument <code>split_words</code>!</p>
<p>There are two other functions that work similarly: <code>keepLetters()</code> and <code>keepInitials()</code>. The former selects letters instead of words.</p>
<pre class="r"><code>keepLetters(loremIpsum(18), c(1:6, 14:18))
#R&gt;  [1] &quot;Loremiorsit&quot;
keepLetters(loremIpsum(18), c(1:6, 14:18), collapse = &quot;-&quot;)
#R&gt;  [1] &quot;L-o-r-e-m-i-o-r-s-i-t&quot;
keepLetters(loremIpsum(18), c(1:6, 14:18), collapse = NULL)
#R&gt;  [[1]]
#R&gt;   [1] &quot;L&quot; &quot;o&quot; &quot;r&quot; &quot;e&quot; &quot;m&quot; &quot;i&quot; &quot;o&quot; &quot;r&quot; &quot;s&quot; &quot;i&quot; &quot;t&quot;</code></pre>
<p>while the latter extracts initials</p>
<pre class="r"><code>keepInitials(&quot;National Basketball Association&quot;)
#R&gt;  [1] &quot;NBA&quot;
keepInitials(&quot;National Basketball Association&quot;, &quot;-&quot;)
#R&gt;  [1] &quot;N&quot;</code></pre>
<p>Note that if the input character vector has a mixture of lower and upper case, so will the output</p>
<pre class="r"><code>keepInitials(&quot;National basketball association&quot;)
#R&gt;  [1] &quot;Nba&quot;</code></pre>
<p>if this annoys you, base functions <code>upper()</code> and <code>lower()</code> come in handy!</p>
<pre class="r"><code>keepInitials(tolower(&quot;National basketball association&quot;))
#R&gt;  [1] &quot;nba&quot;
keepInitials(toupper(&quot;National basketball association&quot;))
#R&gt;  [1] &quot;NBA&quot;</code></pre>
<p><br></p>
</div>
<div id="concluding-remarks" class="section level2">
<h2>Concluding remarks</h2>
<p>In this post, I focused on <code>inSileco</code>’s functions that manipulate character
strings (all of them call
<a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/strsplit.html"><code>str_split()</code></a>
at some point). If you are interested in learning more about strings
manipulations, you should checkout the ebook <a href="https://www.gastonsanchez.com/r4strings/">“Handling Strings with
R”</a> by <a href="https://www.gastonsanchez.com/">Gaston
Sanchez</a>. There are also various blog posts on
this topic (for instance
<a href="http://uc-r.github.io/string_manipulation_baseR/">http://uc-r.github.io</a> or on
<a href="https://data-flair.training/blogs/r-string-manipulation/">data-flair</a>) and, obviously, the documentation of packages that do such manipulations (e.g. <a href="https://CRAN.R-project.org/package=stringi"><code>stringi</code></a>).</p>
<p>This concludes the first part of this post, additional features of the
<code>inSilecoMisc</code> package will be introduced the second part of this post 🎉!</p>
<div style="padding: 2rem 0rem 2rem 0rem;">
<details>
<summary>
Session info <i class="fa fa-cogs" aria-hidden="true"></i>
</summary>
<pre class="r"><code>sessionInfo()
#R&gt;  R version 4.2.0 (2022-04-22)
#R&gt;  Platform: x86_64-pc-linux-gnu (64-bit)
#R&gt;  Running under: Ubuntu 20.04.4 LTS
#R&gt;  
#R&gt;  Matrix products: default
#R&gt;  BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
#R&gt;  LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
#R&gt;  
#R&gt;  locale:
#R&gt;   [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
#R&gt;   [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
#R&gt;   [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
#R&gt;  [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   
#R&gt;  
#R&gt;  attached base packages:
#R&gt;  [1] stats     graphics  grDevices utils     datasets  methods   base     
#R&gt;  
#R&gt;  other attached packages:
#R&gt;  [1] inSilecoMisc_0.7.0     inSilecoRef_0.0.1.9000
#R&gt;  
#R&gt;  loaded via a namespace (and not attached):
#R&gt;   [1] tidyselect_1.1.2  xfun_0.31         bslib_0.3.1       purrr_0.3.4      
#R&gt;   [5] vctrs_0.4.1       generics_0.1.2    miniUI_0.1.1.1    htmltools_0.5.2  
#R&gt;   [9] yaml_2.3.5        utf8_1.2.2        rlang_1.0.2       later_1.3.0      
#R&gt;  [13] pillar_1.7.0      jquerylib_0.1.4   httpcode_0.3.0    glue_1.6.2       
#R&gt;  [17] DBI_1.1.2         lifecycle_1.0.1   plyr_1.8.7        stringr_1.4.0    
#R&gt;  [21] blogdown_1.10     htmlwidgets_1.5.4 evaluate_0.15     knitr_1.39       
#R&gt;  [25] fastmap_1.1.0     httpuv_1.6.5      curl_4.3.2        fansi_1.0.3      
#R&gt;  [29] Rcpp_1.0.8.3      xtable_1.8-4      promises_1.2.0.1  DT_0.23          
#R&gt;  [33] jsonlite_1.8.0    rcrossref_1.1.0   mime_0.12         digest_0.6.29    
#R&gt;  [37] stringi_1.7.6     bookdown_0.27     dplyr_1.0.9       shiny_1.7.1      
#R&gt;  [41] cli_3.3.0         tools_4.2.0       magrittr_2.0.3    sass_0.4.1       
#R&gt;  [45] tibble_3.1.7      RefManageR_1.3.0  crul_1.2.0        crayon_1.5.1     
#R&gt;  [49] pkgconfig_2.0.3   ellipsis_0.3.2    xml2_1.3.3        lubridate_1.8.0  
#R&gt;  [53] assertthat_0.2.1  rmarkdown_2.14    httr_1.4.3        R6_2.5.1         
#R&gt;  [57] compiler_4.2.0</code></pre>
</details>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>see the following <i class="fa fa-github" aria-hidden="true"></i>
repositories:
<a href="https://github.com/McCannLab/HomogenFishOntario">HomogenFishOntario</a> and
<a href="https://github.com/TheoreticalEcosystemEcology/coocc_not_inter">coocc_not_inter</a>.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
</description>
    </item>
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    <item>
      <title>Creating empty data frames with dfTemplate() and dfTemplateMatch()</title>
      <link>https://insileco.github.io/2019/02/03/creating-empty-data-frames-with-dftemplate-and-dftemplatematch/</link>
      <pubDate>Sun, 03 Feb 2019 00:00:00 +0000</pubDate>
      
      <guid>https://insileco.github.io/2019/02/03/creating-empty-data-frames-with-dftemplate-and-dftemplatematch/</guid>
      <description>


<p>Creating a data frame is fairly simple but when you need to <a href="https://stackoverflow.com/questions/10689055/create-an-empty-data-frame">create a large empty data frame with columns that have different classes</a> it takes several command lines. A few days ago, I decided to write a function to simplify this operation and I came to realize that such a function would actually be very useful to ease the row binding of data frames whose column names partially match. How so? This post is meant to answer this question!</p>
<div id="insilecomisc" class="section level2">
<h2>inSilecoMisc</h2>
<p>First of all, the functions I am using in this post are available in <a href="http://insileco.github.io/inSilecoMisc/">inSilecoMisc</a> which is an R package where we gathered the miscellaneous functions we wrote and deem worth sharing on GitHub. So the first step to reproduce the examples below is to install <code>inSilecoMisc</code> which is straightforward with the <a href="https://cran.r-project.org/web/packages/devtools/index.html%20package">devtools</a> :</p>
<pre class="r"><code>library(devtools)
install_github(&quot;inSileco/inSilecoMisc&quot;)</code></pre>
<p>Then, load it:</p>
<pre class="r"><code>library(inSilecoMisc)</code></pre>
<p>In this post, I’ll exemplify how to use <code>dfTemplate()</code> and <code>dfTemplateMatch()</code> but if you are interested in other functions in the packages, <a href="http://insileco.github.io/inSilecoMisc/articles/overview.html">check out the tour vignette</a>.</p>
</div>
<div id="generating-empty-data-frames-efficiently" class="section level2">
<h2>Generating empty data frames efficiently</h2>
<p>Let’s start with <code>dfTemplate()</code> that creates a data frame with a specific number of columns.</p>
<pre class="r"><code>df1 &lt;- dfTemplate(cols = 2)
df1
#R&gt;    Var1 Var2
#R&gt;  1   NA   NA
class(df1)
#R&gt;  [1] &quot;data.frame&quot;</code></pre>
<p>By default, the data frame created has only 1 row and the columns are filled out with <code>NA</code>. This can readily be changed using arguments <code>nrows</code> and <code>fill</code>.</p>
<pre class="r"><code>df2 &lt;- dfTemplate(2, nrows = 4, fill = 0)
df2
#R&gt;    Var1 Var2
#R&gt;  1    0    0
#R&gt;  2    0    0
#R&gt;  3    0    0
#R&gt;  4    0    0
df3 &lt;- dfTemplate(cols = 2, nrows = 3, fill = &quot;&quot;)
df3
#R&gt;    Var1 Var2
#R&gt;  1          
#R&gt;  2          
#R&gt;  3</code></pre>
<p>Columns classes are determined by <code>fill</code>:</p>
<pre class="r"><code>class(df1[, 1])
class(df2[, 1])
class(df3[, 1])
#R&gt;  [1] &quot;logical&quot;
#R&gt;  [1] &quot;numeric&quot;
#R&gt;  [1] &quot;character&quot;</code></pre>
<p>And <code>col_classes</code> is used to changed these classes:</p>
<pre class="r"><code>df4 &lt;- dfTemplate(cols = 2, col_classes = &quot;character&quot;)
class(df4[, 1])
class(df4[, 2])
#R&gt;  [1] &quot;character&quot;
#R&gt;  [1] &quot;character&quot;</code></pre>
<p>Arguments <code>fill</code> and <code>col_classes</code> can be vectors that specify content and class
for every columns:</p>
<pre class="r"><code>df5 &lt;- dfTemplate(2, 5, col_classes = c(&quot;character&quot;, &quot;numeric&quot;), fill = c(&quot;&quot;, 5))
df5
class(df5[, 1])
class(df5[, 2])
#R&gt;    Var1 Var2
#R&gt;  1         5
#R&gt;  2         5
#R&gt;  3         5
#R&gt;  4         5
#R&gt;  5         5
#R&gt;  [1] &quot;character&quot;
#R&gt;  [1] &quot;numeric&quot;</code></pre>
<p>Another useful feature of <code>dfTemplate()</code> is that column names of the data frame to be created can be passed as first argument (<code>cols</code>) :</p>
<pre class="r"><code>df5 &lt;- dfTemplate(c(&quot;category&quot;, &quot;value&quot;))</code></pre>
<p>So, now you are able to create custom data frames with a set of column names!</p>
<pre class="r"><code>nms &lt;- LETTERS[1:10]
df6 &lt;- dfTemplate(nms, 10, fill = tolower(nms))
df6
#R&gt;     A B C D E F G H I J
#R&gt;  1  a b c d e f g h i j
#R&gt;  2  a b c d e f g h i j
#R&gt;  3  a b c d e f g h i j
#R&gt;  4  a b c d e f g h i j
#R&gt;  5  a b c d e f g h i j
#R&gt;  6  a b c d e f g h i j
#R&gt;  7  a b c d e f g h i j
#R&gt;  8  a b c d e f g h i j
#R&gt;  9  a b c d e f g h i j
#R&gt;  10 a b c d e f g h i j</code></pre>
</div>
<div id="how-to-flexibly-rbind-a-list-of-data-frames" class="section level2">
<h2>How to <em>flexibly</em> <code>rbind</code> a list of data frames</h2>
<p>Sometimes we need to <code>rbind</code> data frames that do not have all the columns the final data frame must contain. In such case, we first need to append the missing columns because otherwise the default <code>rbind</code> function won’t work. Another solution is to use a package that has a function that do so. For instance, <a href="https://www.rdocumentation.org/packages/plyr/versions/1.8.4/topics/rbind.fill"><code>rbind.fill()</code> from the <code>plyr</code> package</a> allows to perform such <em>flexible</em> <code>rbind</code>. Also, the package <a href="https://cran.r-project.org/web/packages/data.table/index.html">data.table</a> includes a <code>rbind()</code> method for <code>data.table</code> objects that handles such situation (see <a href="https://stackoverflow.com/questions/18003717/efficient-way-to-rbind-data-frames-with-different-columns">this answer on <i class="fa fa-stack-overflow" aria-hidden="true"></i></a>). In this last section, I would like to show how to <code>rbind</code> data frames flexibly with <code>dfTemplateMatch()</code> that is written in base R.</p>
<p>Let me first introduces <code>dfTemplateMatch()</code>. This function takes a data frame as the first argument (<code>x</code>) and the second argument (<code>y</code>) could be another data frame or a vector of character strings. Based on <code>x</code> and <code>y</code>, <code>dfTemplateMatch()</code> creates a data frame that has the same number of rows as <code>x</code> and add columns for all names found in <code>y</code> that are not found in <code>x</code>. Before calling <code>dfTemplateMatch()</code> I create two data frames :</p>
<pre class="r"><code>df7 &lt;- df6[1:5, 1:4]
df7
#R&gt;    A B C D
#R&gt;  1 a b c d
#R&gt;  2 a b c d
#R&gt;  3 a b c d
#R&gt;  4 a b c d
#R&gt;  5 a b c d
df8 &lt;- df6[4:6]
df8
#R&gt;     D E F
#R&gt;  1  d e f
#R&gt;  2  d e f
#R&gt;  3  d e f
#R&gt;  4  d e f
#R&gt;  5  d e f
#R&gt;  6  d e f
#R&gt;  7  d e f
#R&gt;  8  d e f
#R&gt;  9  d e f
#R&gt;  10 d e f</code></pre>
<p>Now I use <code>dfTemplateMatch()</code> to create a third data frame based on two other:</p>
<pre class="r"><code>dfTemplateMatch(df7, df8)
#R&gt;    A B C D  E  F
#R&gt;  1 a b c d NA NA
#R&gt;  2 a b c d NA NA
#R&gt;  3 a b c d NA NA
#R&gt;  4 a b c d NA NA
#R&gt;  5 a b c d NA NA</code></pre>
<p>As expected, the output has 5 rows as <code>df6</code> and columns that are not in <code>df6</code> but in <code>df7</code> has been appended to <code>df6</code>. It is possible to use arguments <code>fill</code> and <code>col_classes</code> to custom the columns added.</p>
<pre class="r"><code>dfTemplateMatch(df7, df8, fill = 1, col_classes = &quot;numeric&quot;)
#R&gt;    A B C D E F
#R&gt;  1 a b c d 1 1
#R&gt;  2 a b c d 1 1
#R&gt;  3 a b c d 1 1
#R&gt;  4 a b c d 1 1
#R&gt;  5 a b c d 1 1</code></pre>
<p>And there is an argument <code>yonly</code> that allows the user to keep only names of <code>y</code> (when <code>yonly = TRUE</code>).</p>
<pre class="r"><code>dfTemplateMatch(df7, df8, yonly = TRUE, fill = 1, col_classes = &quot;numeric&quot;)
#R&gt;    D E F
#R&gt;  1 d 1 1
#R&gt;  2 d 1 1
#R&gt;  3 d 1 1
#R&gt;  4 d 1 1
#R&gt;  5 d 1 1</code></pre>
<p>Now let me show you how to <code>rbind()</code> a specific subset of columns of a list of data frame that may or may not have these columns. Let me start by creating a list of data frames.</p>
<pre class="r"><code>lsdf &lt;- apply(
  replicate(5, sample(nms, 5)),
  2,
  function(x) dfTemplate(x, nrows = 5, fill = tolower(x))
)
lsdf
#R&gt;  [[1]]
#R&gt;    D A G E C
#R&gt;  1 d a g e c
#R&gt;  2 d a g e c
#R&gt;  3 d a g e c
#R&gt;  4 d a g e c
#R&gt;  5 d a g e c
#R&gt;  
#R&gt;  [[2]]
#R&gt;    B E H F C
#R&gt;  1 b e h f c
#R&gt;  2 b e h f c
#R&gt;  3 b e h f c
#R&gt;  4 b e h f c
#R&gt;  5 b e h f c
#R&gt;  
#R&gt;  [[3]]
#R&gt;    H B J I F
#R&gt;  1 h b j i f
#R&gt;  2 h b j i f
#R&gt;  3 h b j i f
#R&gt;  4 h b j i f
#R&gt;  5 h b j i f
#R&gt;  
#R&gt;  [[4]]
#R&gt;    J D B I G
#R&gt;  1 j d b i g
#R&gt;  2 j d b i g
#R&gt;  3 j d b i g
#R&gt;  4 j d b i g
#R&gt;  5 j d b i g
#R&gt;  
#R&gt;  [[5]]
#R&gt;    E B G F C
#R&gt;  1 e b g f c
#R&gt;  2 e b g f c
#R&gt;  3 e b g f c
#R&gt;  4 e b g f c
#R&gt;  5 e b g f c</code></pre>
<p>So the goal here is to create a data frame that contains only the five first
columns, i.e. A, B, C, D, E, the remaining columns must be discarded and
when one selected column is missing, it must be added (filled out with <code>NA</code>).
To do so, I simply need to call <code>dfTemplateMatch()</code>:</p>
<pre class="r"><code>lsdf2 &lt;- lapply(lsdf, dfTemplateMatch, LETTERS[1:5], yonly = TRUE)
lsdf2
#R&gt;  [[1]]
#R&gt;    D A E C  B
#R&gt;  1 d a e c NA
#R&gt;  2 d a e c NA
#R&gt;  3 d a e c NA
#R&gt;  4 d a e c NA
#R&gt;  5 d a e c NA
#R&gt;  
#R&gt;  [[2]]
#R&gt;    B E C  A  D
#R&gt;  1 b e c NA NA
#R&gt;  2 b e c NA NA
#R&gt;  3 b e c NA NA
#R&gt;  4 b e c NA NA
#R&gt;  5 b e c NA NA
#R&gt;  
#R&gt;  [[3]]
#R&gt;    B  A  C  D  E
#R&gt;  1 b NA NA NA NA
#R&gt;  2 b NA NA NA NA
#R&gt;  3 b NA NA NA NA
#R&gt;  4 b NA NA NA NA
#R&gt;  5 b NA NA NA NA
#R&gt;  
#R&gt;  [[4]]
#R&gt;    D B  A  C  E
#R&gt;  1 d b NA NA NA
#R&gt;  2 d b NA NA NA
#R&gt;  3 d b NA NA NA
#R&gt;  4 d b NA NA NA
#R&gt;  5 d b NA NA NA
#R&gt;  
#R&gt;  [[5]]
#R&gt;    E B C  A  D
#R&gt;  1 e b c NA NA
#R&gt;  2 e b c NA NA
#R&gt;  3 e b c NA NA
#R&gt;  4 e b c NA NA
#R&gt;  5 e b c NA NA</code></pre>
<p>And now I can seamlessly <code>rbind()</code> the list <code>lsdf2</code>!</p>
<pre class="r"><code>do.call(rbind, lsdf2)
#R&gt;        D    A    E    C    B
#R&gt;  1     d    a    e    c &lt;NA&gt;
#R&gt;  2     d    a    e    c &lt;NA&gt;
#R&gt;  3     d    a    e    c &lt;NA&gt;
#R&gt;  4     d    a    e    c &lt;NA&gt;
#R&gt;  5     d    a    e    c &lt;NA&gt;
#R&gt;  6  &lt;NA&gt; &lt;NA&gt;    e    c    b
#R&gt;  7  &lt;NA&gt; &lt;NA&gt;    e    c    b
#R&gt;  8  &lt;NA&gt; &lt;NA&gt;    e    c    b
#R&gt;  9  &lt;NA&gt; &lt;NA&gt;    e    c    b
#R&gt;  10 &lt;NA&gt; &lt;NA&gt;    e    c    b
#R&gt;  11 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;    b
#R&gt;  12 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;    b
#R&gt;  13 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;    b
#R&gt;  14 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;    b
#R&gt;  15 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;    b
#R&gt;  16    d &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;    b
#R&gt;  17    d &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;    b
#R&gt;  18    d &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;    b
#R&gt;  19    d &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;    b
#R&gt;  20    d &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;    b
#R&gt;  21 &lt;NA&gt; &lt;NA&gt;    e    c    b
#R&gt;  22 &lt;NA&gt; &lt;NA&gt;    e    c    b
#R&gt;  23 &lt;NA&gt; &lt;NA&gt;    e    c    b
#R&gt;  24 &lt;NA&gt; &lt;NA&gt;    e    c    b
#R&gt;  25 &lt;NA&gt; &lt;NA&gt;    e    c    b</code></pre>
<div id="voilà-this-is-what-i-call-a-flexible-rbind-i-hope-youll-find-this-helpful-boom" class="section level4">
<h4>Voilà! This is what I call a <em>flexible</em> <code>rbind</code>! I hope you’ll find this helpful! 💥</h4>
<div style="padding: 2rem 0rem 2rem 0rem;">
<details>
<summary>
<h4>
<i class="fa fa-chevron-right" aria-hidden="true"></i>Session info
<i class="fa fa-cogs" aria-hidden="true"></i>
</h4>
<p></summary></p>
<pre class="r"><code>sessionInfo()
#R&gt;  R version 4.2.0 (2022-04-22)
#R&gt;  Platform: x86_64-pc-linux-gnu (64-bit)
#R&gt;  Running under: Debian GNU/Linux bookworm/sid
#R&gt;  
#R&gt;  Matrix products: default
#R&gt;  BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.1
#R&gt;  LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.1
#R&gt;  
#R&gt;  locale:
#R&gt;   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
#R&gt;   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
#R&gt;   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
#R&gt;   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
#R&gt;   [9] LC_ADDRESS=C               LC_TELEPHONE=C            
#R&gt;  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
#R&gt;  
#R&gt;  attached base packages:
#R&gt;  [1] stats     graphics  grDevices utils     datasets  methods   base     
#R&gt;  
#R&gt;  other attached packages:
#R&gt;  [1] inSilecoMisc_0.7.0     inSilecoRef_0.0.1.9000
#R&gt;  
#R&gt;  loaded via a namespace (and not attached):
#R&gt;   [1] Rcpp_1.0.8.3      lubridate_1.8.0   ps_1.7.0          assertthat_0.2.1 
#R&gt;   [5] digest_0.6.29     utf8_1.2.2        mime_0.12         R6_2.5.1         
#R&gt;   [9] plyr_1.8.7        backports_1.4.1   evaluate_0.15     httr_1.4.3       
#R&gt;  [13] blogdown_1.10     pillar_1.7.0      rlang_1.0.2       curl_4.3.2       
#R&gt;  [17] data.table_1.14.2 miniUI_0.1.1.1    callr_3.7.0       jquerylib_0.1.4  
#R&gt;  [21] DT_0.23           rmarkdown_2.14    RefManageR_1.3.0  rcrossref_1.1.0  
#R&gt;  [25] stringr_1.4.0     htmlwidgets_1.5.4 igraph_1.2.11     shiny_1.7.1      
#R&gt;  [29] compiler_4.2.0    httpuv_1.6.5      xfun_0.31         pkgconfig_2.0.3  
#R&gt;  [33] htmltools_0.5.2   tidyselect_1.1.2  tibble_3.1.7      httpcode_0.3.0   
#R&gt;  [37] bookdown_0.26     codetools_0.2-18  fansi_1.0.3       crayon_1.5.1     
#R&gt;  [41] dplyr_1.0.9       withr_2.5.0       later_1.3.0       crul_1.2.0       
#R&gt;  [45] jsonlite_1.8.0    xtable_1.8-4      lifecycle_1.0.1   DBI_1.1.2        
#R&gt;  [49] magrittr_2.0.3    cli_3.3.0         stringi_1.7.6     promises_1.2.0.1 
#R&gt;  [53] xml2_1.3.3        bslib_0.3.1       ellipsis_0.3.2    targets_0.12.0   
#R&gt;  [57] generics_0.1.2    vctrs_0.4.1       tools_4.2.0       glue_1.6.2       
#R&gt;  [61] purrr_0.3.4       processx_3.5.3    fastmap_1.1.0     yaml_2.3.5       
#R&gt;  [65] base64url_1.4     knitr_1.39        sass_0.4.1</code></pre>
</details>
</div>
</div>
</div>
</description>
    </item>
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    <item>
      <title>A few thoughts on R packages</title>
      <link>https://insileco.github.io/2018/12/03/a-few-thoughts-on-r-packages/</link>
      <pubDate>Mon, 03 Dec 2018 00:00:00 +0000</pubDate>
      
      <guid>https://insileco.github.io/2018/12/03/a-few-thoughts-on-r-packages/</guid>
      <description><p><a href="https://www.linkedin.com/in/jonasgeschke/">Jonas Geschke</a>,
<a href="https://bartomeuslab.com/">Ignasi Bartomeus</a> and I have recently released <a href="https://cran.r-project.org/web/packages/rcites/index.html">rcites v-1.0.0</a> on CRAN, a R client for the <a href="https://api.speciesplus.net/">Species+ API</a> after it has been reviewed by <a href="https://rOpenSci.org/">rOpenSci</a>. In this post, I would like to share this recent experience as well as several valuable resources.</p>
<br>

<center>
  <figure>
    <img class="mg-bot" src="/2018/12/03/a-few-thoughts-on-r-packages/rcites_cran.png" alt="" width="100%" >
    <figcaption><span class="highlight"></span></figcaption>
  </figure>
</center>



<br>
<h2 id="what-is-an-r-package">What is an R package?</h2>
<p>In the introduction of his book <a href="http://r-pkgs.had.co.nz/intro.html">R packages</a>, Hadley Wickham wrote:</p>
<blockquote>
<p>A package bundles together code, data, documentation, and tests, and is easy to share with others.</p>
</blockquote>
<p>I like the way the famous R developer presents a package, it is straightforward and crystal clear. Interestingly enough, it describes what a package <em>does</em>, not what a package <em>is</em>. Defining an R package is actually harder than I thought! I remember the first time, I&rsquo;ve tried to characterize an R package, I tried to answer a couple of questions and found the answers quite surprising:</p>
<ul>
<li>Are R packages extensions available on <a href="https://cran.r-project.org/">CRAN</a> or <a href="https://www.bioconductor.org/">Bioconductor</a>? <strong>Not necessarily!</strong></li>
</ul>
<p>The answer sounds obvious nowadays with over than <a href="https://rdrr.io/">40K R packages on Github</a>, but 10 years ago it wasn&rsquo;t. That said, we shall recall that an R package that only exists on a single computer still is an R package.</p>
<ul>
<li>Should a package have a minimum number of functions? <strong>No</strong></li>
</ul>
<p>Even among popular packages, the number of functions is not a criterion. For instance, <a href="https://cran.r-project.org/web/packages/vegan/">vegan</a> exports 192 functions (as of version 2.5.2) while <a href="https://cran.r-project.org/web/packages/png/">png</a> only includes two functions.</p>
<ul>
<li>Should a package be designed to perform a specific analysis? <strong>No</strong></li>
</ul>
<p>Two comments here. First, R packages do many things: they <a href="/tuto/rinspace/rinspace_homepage/index.html">can turn R into a powerful Geographic Information System</a> or make your R session crash every time you load it (see <a href="https://github.com/romainfrancois/trump">trump</a>)! Packages such as <a href="https://cran.r-project.org/web/packages/ape/">ape</a> provide try to be as exhaustive as possible for a certain type of analysis while other such as <a href="https://cran.r-project.org/web/packages/Hmisc/">Hmisc</a> are sets of miscellaneous functions. Second, it sometimes make more sense for development purposes to split the full pipeline into several packages so that more than one package are required for certain analysis.</p>
<p>So <strong>what is an R package?</strong> Well, my own definition would be something along this line:</p>
<blockquote>
<p>A set of files that passes the command <code>R CMD INSTALL</code>.</p>
</blockquote>
<p>From this definition, one should understand that an R package does not perform
any analysis correctly. Rather, an R package is an organized set of files that
passes a set of tests, <em>a lot of tests</em>!</p>
<h2 id="why-write-an-r-package">Why write an R package?</h2>
<p>This is another crucial question. In <a href="http://r-pkgs.had.co.nz/intro.html">his introduction</a>,
Hadley Wickham emphasized that R packages are a standard way to organize your
project: it saves you time, gives you an opportunity to acquire good practices when writing functions and makes the sharing of your code easy.
Once you get used to create and handle R packages, it becomes natural to use
the standard file organisation to structure your project. With this habit, the question &ldquo;where is this file?&rdquo; vanishes and you stop using <code>setwd()</code>. Note that, some authors propose similar structure of R projects, e.g. <a href="https://nicercode.github.io/blog/2013-04-05-projects/">this post on nicercode</a>, but you&rsquo;ll need to tweak a little bit if you want to test your code with standard tools.</p>
<p>I would like to point out that one of the main reasons of creating a package is for efficiency purposes, not necessarily to submit it to the CRAN. To me, this is <em>extremely</em> important. This means that you do not need to have a good reason to write a package, if you work regularly with R you can write packages, whenever you decide to turn your set of functions for a particular project into an actual package, then the step to do so will be small. Of course the sharing of your package is an important question, but I think this is different question: <em>If you write a package it does not imply you&rsquo;ll share it</em>.</p>
<h2 id="why-share-your-r-package">Why share your R package?</h2>
<p>There are different answers to this question and depending on the answer, you
may consider different options to share your code. I do not intend to be exhaustive here rather I provide three examples I am familiar with.</p>
<h3 id="1--my-personal-helper-functions">1- My personal helper functions</h3>
<p>When I keep repeating the same lines of code in a project, I write a function.
Sometimes, the function can actually be used in different projects. I used to write this kind of function in a dedicated <code>.R</code> file that was loaded during my custom startup process (see <code>?Startup</code> in R). Three years ago, I decided to make a package out of these functions. There were three main reasons for doing so. First, I was still learning how to write packages, so this was another opportunity to practice. Second, I wanted to document these functions. Last but not least, I thought these functions might be useful to other people so writing an R package was an efficient way to share them. The package is now on GitHub: <a href="https://github.com/inSileco/inSilecoMisc">inSilecoMisc</a>, everyone can use it, borrow one or more functions for his own project, report issues, etc. Even though the package is exhaustively tested, <a href="https://github.com/inSileco/inSilecoMisc">inSilecoMisc</a> remains a collection of sub-optimal functions which according to me does not deserve to be published on the CRAN, GitHub and the additional web services I use cover all my needs!</p>
<h3 id="2--the-code-to-reproduce-a-paper">2- The code to reproduce a paper</h3>
<p>Reproducible science matters to me, when I publish a paper I cannot see any reason to not share the analysis pipeline with the rest of the scientific community: it demands a little more of my time to save a huge amount of time for them. To do so, I now create a small package that contains the analysis. The first time I did so was for a paper we did with a couple of colleagues where we compared <a href="https://www.frontiersin.org/articles/10.3389/fevo.2017.00175/ful">media coverage for climate change and biodiversity</a>. Unfortunately, we were not able to make the gathering of data reproducible (believe me, we&rsquo;ve tried, the only solution was to work on private API, so, making the code not reproducible for the majority of researchers), we however turned the data collected into <code>.Rdata</code> files and the set of functions were stored on a GitHub repository: <a href="https://github.com/KevCaz/burningHouse">burningHouse</a>. This ensures the interoperability of the package, shows to other researchers how we did it the analysis and let them report issues with the code. Moreover, <a href="https://zenodo.org/">Zenodo</a> makes it simple to assign a DOI to the repository so that people can reference this work if needed. Note that it becomes quite common for researchers to share their code that way, see for instance <a href="https://github.com/hyenaproject/vullioud2018">this repository</a> associated with this <a href="https://doi.org/10.1038/s41559-018-0718-9">nice paper about the girl power in the clans of Hyenas</a>.</p>
<h3 id="3--a-r-client-for-a-web-api">3- A R-Client for a web API</h3>
<p>A year ago now, I was in a hackathon in Ghent (my first hackathon) and I sat on the same table as <a href="https://www.linkedin.com/in/jonasgeschke/">Jonas Geschke</a>, <a href="https://bartomeuslab.com/">Ignasi Bartomeus</a> (among other colleagues). We worked intensively on a prototype of a package listed in <a href="https://github.com/rOpenSci/wishlist/issues/29">the wishlist of rOpenSci</a>:
an R-Client to the CITES-API. After we completed the first version, we <a href="https://github.com/rOpenSci/onboarding/issues/244">submitted it to the review process of rOpenSci</a>. And now <a href="https://github.com/rOpenSci/rcites">rcites is part of rOpenSci</a> (more about this story <a href="https://github.com/rOpenSci/roweb2/pull/344#issuecomment-442945039">here</a>). So here is a tangible example where the package is worth making the CRAN (I think so) and even a dedicated organization (<a href="https://github.com/ropensci">rOpenSci</a>) on GitHub. The package is general, has a specific goal, helps people retrieving data to do science and helps them to do it in a reproducible way. So it should be broadly shared. Plus, making the package part of an organization such as rOpenSci means that the package will likely keep being maintained properly.</p>
<h2 id="how-to-proceed">How to proceed?</h2>
<p>Below, I give a brief overview of how we proceeded for <a href="https://cran.r-project.org/web/packages/rcites/index.html">rcites</a>. Note that if you are interested in writing an R package, you must read more about what I am quickly mentioning below, so scroll down to the end of this post where I listed a couple of very helpful resources. After 3 years of experience with packages, I do not frequently have to look at documentation, but when I do, I always find the answers in <a href="http://r-pkgs.had.co.nz/">R packages</a> or
<a href="http://adv-r.had.co.nz/">Advanced R</a> both by Hadley Wickham or in the exhaustive and technical documentation <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html">Writing R extensions</a> available on the CRAN.</p>
<h3 id="local-development">Local development</h3>
<p>I personally use the set of packages developed by Hadley Wickham and colleagues. His book <a href="http://r-pkgs.had.co.nz/">R packages</a> explains how to write your package with them. Installing these packages and start working on package is a simple as the line of command below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;devtools&#34;</span>, <span style="color:#e6db74">&#34;roxygen2&#34;</span>, <span style="color:#e6db74">&#34;testthat&#34;</span>, <span style="color:#e6db74">&#34;knitr&#34;</span>))
</span></span></code></pre></div><p>Briefly:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/devtools/index.html">roxygen2</a>: document the functions;</li>
<li><a href="https://cran.r-project.org/web/packages/devtools/index.html">testthat</a>: test your code;</li>
<li><a href="https://cran.r-project.org/web/packages/devtools/index.html">knitr</a>: build the vignette;</li>
<li><a href="https://cran.r-project.org/web/packages/devtools/index.html">devtools</a>: rule them all! (<a href="https://www.tidyverse.org/articles/2018/10/devtools-2-0-0/">version 2.0</a> has recently been released).</li>
</ul>
<p>In a nutshell, the workflow with this setup looks like this:</p>
<pre tabindex="0"><code>1-&#34;fix/write code&#34; =&gt; 2-load_all() =&gt; 3-document() =&gt; 4-test() =&gt; 5-check()
</code></pre><p>Basically, you follow these steps for every feature you are adding to your package and go back to step 1- if one of the subsequent steps fails. The package <a href="https://github.com/r-lib/usethis">usethis</a> is also worth mentioning as it automates many steps of the process. Moreover, <code>package.skeleton()</code>
creates a package skeleton for you and <a href="http://dirk.eddelbuettel.com/">Dirk Eddelbuettel</a> has extended the function for packages that are linked to <a href="http://www.rcpp.org/">Rcpp</a>, see
<a href="https://github.com/RcppCore/Rcpp/blob/master/R/Rcpp.package.skeleton.R"><code>Rcpp.package.skeleton()</code></a>.</p>
<p>I would like to conclude this part by pointing out that using the set of packages Hadley Wickham and colleagues isn&rsquo;t mandatory, but remember, their developers have cleverly automated many steps for writing R packages, so why not use the fruit of their labor?</p>
<h3 id="version-control-and-continuous-integration">Version control and Continuous Integration</h3>
<p>Web-based <a href="https://git-scm.com/"><i class="fa fa-git" aria-hidden="true"></i></a>-repository managers such (GitHub <i class="fa fa-github" aria-hidden="true"></i>, GitLab <i class="fa fa-gitlab" aria-hidden="true"></i>, Bitbucket <i class="fa fa-bitbucket" aria-hidden="true"></i>, etc.) are very powerful tools to develop your packages
especially to work with collaborators, get feed back and add web-services to improve your workflow. First, <a href="https://git-scm.com/"><i class="fa fa-git" aria-hidden="true"></i></a>
it-self is a fantastic tool (beyond the scope of this post, I recommend you the reading of <a href="https://git-scm.com/book/en/v2">Pro Git</a>). Second, by hosting your package on GitHub, your are basically sending an invitation at large to contribute to your project: &ldquo;hey devs, this is the project I am working on, if you are interested, please star, clone, fork, report issues, submit pull requests, etc.&rdquo;! Furthermore, once on GitHub, people can easily install your package directly from R:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>devtools<span style="color:#f92672">::</span><span style="color:#a6e22e">install_github</span>(<span style="color:#e6db74">&#34;rOpenSci/rcites&#34;</span>)
</span></span></code></pre></div><p>Last, the number of <a href="https://github.com/marketplace">web-services</a> you can add to your repository is tremendous (sign in with GitHub and let the <a href="https://oauth.net/2/">protocol OAuth 2.0</a> do the rest). There are two kind services I always use for all my R packages: <a href="https://en.wikipedia.org/wiki/Continuous_integration">continuous integration (CI)</a> and <a href="https://en.wikipedia.org/wiki/Code_coverage">code coverage</a>. I would like to expand a little bit on this two.</p>
<h4 id="continuous-integration">Continuous integration</h4>
<p>I personally use <a href="http://docs.travis-ci.com/user/languages/r/">Travis</a> that covers MacOS +  Ubuntu and <a href="https://github.com/krlmlr/r-appveyor">AppVeyor</a> for Windows. As <a href="https://www.slant.co/topics/186/~best-hosted-continuous-integration-services#8">continuous integration services</a> they allow me to check that my package can be seamlessly built on different systems freshly installed, for a specific version of R. I am very grateful to developers that makes the use of this service really easy!</p>
<h4 id="code-coverage">Code coverage</h4>
<p>The code coverage is the percentage of coding lines checked by your
<a href="https://en.wikipedia.org/wiki/Unit_testing">unit testing</a>. Unit testing plays two critical roles. First, it checks that your code do what you want it to do. Second, once your tests are already written, they are extremely useful when you are fixing a bug, restructuring the code or adding new features as you can immediately be aware whether or not the changes you are doing affect the behavior of the other part of your package and therefore unit testing avoids multiplying bugs via side effects brought by the new lines of code. I personally use <a href="https://cran.r-project.org/web/packages/testthat/index.html">testhat</a> to write my tests and <a href="https://codecov.io/">codecov</a> to show the code coverage and benefit from the neat visualizations it automatically produces (see for instance the <a href="https://codecov.io/gh/rOpenSci/rcites">results for rcites</a>). I must also mention that I&rsquo;ve recently tried <a href="https://coveralls.io/">coveralls</a> and I like its design very much, so I may use it more in a near future!
Many thanks to <a href="https://github.com/jimhester">Jim Hester</a> for <a href="https://cran.r-project.org/web/packages/covr/vignettes/how_it_works.html">his work on the integration of these services for R packages</a>.</p>
<h3 id="license">License</h3>
<p>Even though I am no expert on this topic, I can tell that choosing your license matters it specifies what people can do with your code. I recommend you to go and visit this website: <a href="http://choosealicense.com">&ldquo;ChooseALicense&rdquo;</a> and if this question is critical to your project, you should better ask somebody that is knowledgeable about <a href="https://en.wikipedia.org/wiki/Intellectual_property">Intellectual Property (IP)</a>.</p>
<h3 id="release-on-github-and-on-the-cran">Release on GitHub and on the CRAN</h3>
<p>This topic is also well covered in Hadley&rsquo;s book, so I suggest you read <a href="r-pkgs.had.co.nz/release.html">this chapter</a>.
A release is an achievement, you have reached a milestone and the package works great, so you are basically spreading the news &ldquo;I/we&rsquo;ve reached a milestone guys, here it is!&rdquo;. Doing a release is as simple as changing the number of the version in the <code>DESCRIPTION</code> file. That said, there are ways of making it more official and more useful.</p>
<p>First on GitHub, you can <a href="https://help.github.com/articles/creating-releases/">create releases</a>. After editing the version number in <code>DESCRIPTION</code>, you can push and create a release and even add a DOI with the version via <a href="https://zenodo.org/">Zenodo</a>. You can also submit your package to the <a href="https://cran.r-project.org/">CRAN</a> or <a href="https://www.bioconductor.org/">Bioconductor</a> which demands a little more work.
Either way, at this stage you must choose a version number. Easy peasy? Yes, but this choice does matter. It is all about making the numbers used as meaningful as possible to provide useful landmarks as you keep on developing your package. <a href="http://semver.org">Semantic Versioning</a> does a great work at explaining this, check this website out! I also suggest that you spend some time thinking about how useful it is to make the <a href="https://en.wikipedia.org/wiki/TeX">version number converging to pi</a>.</p>
<p>I have no experience submitting my package to <a href="https://www.bioconductor.org/">Bioconductor</a>. I can only tell about the <a href="https://cran.r-project.org/submit.html">CRAN</a>. I&rsquo;ll be brief as you can read how to do so in <a href="r-pkgs.had.co.nz/release.html">Hadley&rsquo;s book</a>:</p>
<ol>
<li>
<p>You must test your package on the main platforms (MacOS, Windows, Linux) and report warnings/notes if any. Travis and AppVeyor I introduced above are very useful for this, if they are part of your workflow, basically this step is done, I however recommend to use <a href="https://win-builder.r-project.org/">win-builder</a> (one command line <code>devtools::build_win()</code>) and also to have a look at <a href="https://builder.r-hub.io/">the r-hub builder</a>.</p>
</li>
<li>
<p>You must write the results in <code>cran-comments.md</code> where you must mention if it is your first submission and if your package has downstream dependencies.</p>
</li>
</ol>
<p>Below is the <a href="https://github.com/rOpenSci/rcites/blob/master/cran-comments.md">most recent one for rcites</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-md" data-lang="md"><span style="display:flex;"><span><span style="color:#75715e">## This is our second submission
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Test environments
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">*</span> local Debian testing (4.18.0-2-amd64), R 3.5.1
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">*</span> MacOSX 10.13.3 (on Travis-ci), R:release
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">*</span> Ubuntu 14.04 (on Travis-ci), R 3.4.4, R:release, R:devel
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">*</span> win-builder (R:release and R:devel)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## R CMD check results (win-builder)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>There were no ERRORs, WARNINGs or NOTEs.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Installation time in seconds: 7
</span></span><span style="display:flex;"><span>Check time in seconds: 99
</span></span><span style="display:flex;"><span>Status: OK
</span></span><span style="display:flex;"><span>R Under development (unstable) (2018-11-12 r75592)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## Downstream dependencies
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>There are currently no downstream dependencies for this package.
</span></span></code></pre></div><p>Once done, you are ready to submit, so thanks to <a href="https://cran.r-project.org/web/packages/devtools/">devtools</a>, just one command line:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-R" data-lang="R"><span style="display:flex;"><span>devtools<span style="color:#f92672">::</span><span style="color:#a6e22e">submit_cran</span>()
</span></span></code></pre></div><p>After this, you&rsquo;ll receive an email (the one you wrote in the maintainer field of <code>DESCRIPTION</code>) to confirm the submission. You may receive emails from people that manage the CRAN because of issues or potential improvements. So far, they have given me one good advice: using <code>\donttest{}</code> instead of commenting out examples that cannot be tested on the CRAN.</p>
<h2 id="why-submit-your-package-to-a-peer-review-process">Why submit your package to a peer review process?</h2>
<p>Let&rsquo;s assume your package is already on GitHub and the built passes on both Travis and Appveyor and that the code coverage is above 90%, is it enough? Does that mean you wrote a good package? What is a good package? To me, a good package does not need to be among most downloaded ones but rather one that is well coded. There are a set of criteria that can actually be objectively evaluated:</p>
<ul>
<li>
<p><strong>good practice</strong>: is your package compliant to good practices? Given the number of ways R offers to do the same things, e.g. <code>&lt;-</code> or <code>=</code> to assign a value to a variable (that puzzles some people), it is recommended to follow good practice. <a href="https://github.com/MangoTheCat/goodpractice">goodpractice</a> checks if your package follows them. For instance, <code>goodpractice::gp()</code> checks that you are using <code>&lt;-</code> rather than <code>=</code>, that your lines of code do not exceed 80 character, that you are using <code>TRUE</code> and <code>FALSE</code> instead of <code>T</code> and <code>F</code>, etc..</p>
</li>
<li>
<p><strong>readability</strong> is your code well-commented and easy to understand? This determines how easy it would be for new contributors to understand your code and thus how easy it would be for them to contribute. Note that for efficiency purposes, some steps may sometimes be hard to understand, in such case, you must comment how you did it and why, this is also relevant for the future you.</p>
</li>
<li>
<p><strong>Dependencies</strong>: there is nothing wrong with <a href="http://www.stat.tugraz.at/AJS/ausg121/121Hornik.pdf">depending on other packages</a>. However,
<a href="https://recology.info/2018/10/limiting-dependencies/">being parsimonious and using adequate package matter</a> (the <a href="https://en.wikipedia.org/wiki/Occam%27s_razor">Occam&rsquo;s razor</a> version for packages). The first release of <a href="https://cran.r-project.org/web/packages/rcites/">rcites</a> imported <a href="https://cran.r-project.org/web/packages/data.table/">data.table</a>. During the review of the package <a href="https://github.com/noamross">Noam Ross</a> suggested that data.table is actually used for efficiency purposes and that in the context of <a href="https://cran.r-project.org/web/packages/rcites/">rcites</a>, it was an extra dependency for no real benefice, which is true, so we changed this.</p>
</li>
<li>
<p><strong>Code redundancy</strong>: is your code a bunch of copy paste or is it well-designed so that it avoids redundancy and makes the debug efficient? This may sound technical but a code well-structured is also a code that is easy to debug and to further develop.</p>
</li>
<li>
<p><strong>Efficiency</strong> is your code efficient? There are many tips given by Colin Gillespie and Robin Lovelace in <a href="https://csgillespie.github.io/efficientR/">Efficient R programming</a>, have a look!</p>
</li>
<li>
<p><strong>User experience</strong> Never wondered why Hadley&rsquo;s packages are among the most popular ones? Well, he cares a lot about the users. I am sure he thinks a lot about how people will use a package and how to make it as intuitive as possible. Moreover, he exhaustively documents his works. This is a critical part. Making your package user friendly is about its design and documenting your package. Without a good documentation, you&rsquo;ll miss your shot. Build vignettes! Explain carefully how your package works, build a website! You can no longer say that this is hard because <a href="https://pkgdown.r-lib.org/">pkgdown</a> makes this real easy!</p>
</li>
</ul>
<p>To evaluate all these aspects, you (still) need human reviewers! That&rsquo;s why I value so much initiatives such as <a href="https://ropensci.org/">rOpenSci</a>, their members <a href="https://ropensci.org/blog/2017/09/01/nf-softwarereview/">review packages</a>, advertise the packages they&rsquo;ve reviewed, write tutorials and <a href="https://ropensci.org/blog/"> blog on what they are doing</a>. Our experience was awesome, we had very positive feed back, very clever suggestions that made <a href="https://github.com/ropensci/rcites">rcites</a> a better package. I would love to say more about it but guess what, the review process  in 100% transparent, so check out what really happened <code>=&gt;</code> <a href="https://github.com/ropensci/onboarding/issues/244"><img src="https://badges.ropensci.org/244_status.svg" alt="ROpenSci status"></a>. You may wonder whether your package is in the scope of rOpenSci? How to submit your package? Well, they are completing a book to answer all this question, <a href="https://ropensci.github.io/dev_guide/">check it out</a>! If your package is not in rOpenSci book, you have other options such as <a href="https://joss.theoj.org">The Journal of Open Source Software (JOSS)</a> or <a href="https://www.jstatsoft.org/index">Journal of statistical software</a>. Note that <a href="https://ropensci.org/blog/2017/11/29/review-collaboration-mee/">rOpenSci has Software Review Collaboration with Methods in Ecology and Evolution</a> and with JOSS. So in our case, it meant that <a href="https://joss.theoj.org/papers/ad23e358f208568c4913cf5fb99a030d">our JOSS paper</a> was accepted after the review completed by rOpenSci.</p>
<p>There are <a href="https://cran.r-project.org/web/packages/">thousands of packages on the CRAN</a>, I personally
think that it is worth sending packages of good quality (again quality means that the package does what it was meant to do and does it well). After this experience, I&rsquo;ll always do my best to get reviews of the code before sending the package to the CRAN. People are sometimes wondering how to <a href="https://simplystatistics.org/2015/11/06/how-i-decide-when-to-trust-an-r-package/">trust an R package</a>, getting packages peer-reviewed is definitively a good solution.
For now on, my personal approach with R packages will be:</p>
<ol>
<li>Development of GitHub (or similar);</li>
<li>Review;</li>
<li>Development until package accepted;</li>
<li>Submit first version to CRAN;</li>
<li>Advertise <i class="fa fa-twitter" aria-hidden="true"></i>, blog, etc.</li>
<li>Regular life cycle: new features/ fixing bugs / new release on CRAN when ready / keep advertising.</li>
</ol>
<h2 id="curated-list-of-resources-mentioned-in-the-post">Curated list of resources mentioned in the post</h2>
<h3 id="packages">Packages</h3>
<ul>
<li><a href="https://github.com/r-lib/devtools/issues">devtools</a></li>
<li><a href="https://github.com/r-lib/usethis">usethis</a></li>
<li><a href="https://github.com/r-lib/pkgdown">pkgdown</a></li>
<li><a href="https://github.com/MangoTheCat/goodpractice">goodpractice</a></li>
</ul>
<h3 id="builders">Builders</h3>
<ul>
<li><a href="https://r-hub.github.io/rhub/">r-hub</a> see <a href="https://builder.r-hub.io/">https://builder.r-hub.io/</a></li>
<li><a href="https://win-builder.r-project.org/">win-builder</a></li>
</ul>
<h3 id="documentation">Documentation</h3>
<ul>
<li><a href="http://hilaryparker.com/2014/04/29/writing-an-r-package-from-scratch/">&ldquo;Writing an R package from scratch&rdquo; by Hilary Parker</a> (that actually is the first thing I read on this topic)</li>
<li><a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html">Writing R extension, on the CRAN</a></li>
<li><a href="http://r-pkgs.had.co.nz/">R packages by Hadley Wickham</a></li>
<li><a href="https://rOpenSci.github.io/dev_guide/">rOpenSci Packages: Development, Maintenance, and Peer Review</a></li>
<li><a href="http://adv-r.had.co.nz/">Advanced R by Hadley Wickham</a></li>
<li><a href="https://csgillespie.github.io/efficientR/index.html">Efficient R programming by Colin Gillespie Robin Lovelace</a></li>
<li><a href="https://git-scm.com/book/en/v2">Pro Git</a></li>
</ul>
<h3 id="journals">Journals</h3>
<ul>
<li><a href="https://journal.r-project.org/">R Journal</a></li>
<li><a href="https://joss.theoj.org/">The Journal of Open Source Software (JOSS)</a></li>
<li><a href="https://besjournals.onlinelibrary.wiley.com/journal/2041210x">Methods in Ecology and Evolution (MEE)</a>, <a href="https://rOpenSci.org/blog/2017/11/29/review-collaboration-mee/">it partnered up with rOpenSci</a></li>
</ul>
<h3 id="misc">Misc</h3>
<ul>
<li><a href="https://resources.rstudio.com/rstudio-conf-2018/you-can-make-a-package-in-20-minutes-jim-hester">You can make a package in 20 minutes</a></li>
</ul>
<br>
<h4 id="thats-all-folks">That&rsquo;s all folks!</h4>
</description>
    </item>
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
		
    
  </channel>
</rss>