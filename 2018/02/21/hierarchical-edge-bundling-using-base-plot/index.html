<!DOCTYPE html>
<html lang="en-us">
    <head>
        
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Hierarchical edge bundling using base plot</title>
        
        <style>

    html body {
        font-family: '', sans-serif;
        background-color: white;
    }

    :root {
        --accent: #3fb3b2;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="https://insileco.github.io/css/main.css">


 <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css">  <link rel="stylesheet" href="https://insileco.github.io/css/academicons.min.css">  <link rel="stylesheet" href="https://insileco.github.io/css/main.css">  <link rel="stylesheet" href="https://insileco.github.io/css/syntax.css">  <link rel="stylesheet" href="https://insileco.github.io/css/insileco.css"> 


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=">





<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" crossorigin="anonymous">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />
 






<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.110.0">
        

        
            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-109508556-1"></script>
            <script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments)};
              gtag('js', new Date());
              gtag('config', 'UA-109508556-1');
            </script>
        

        
            <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css">

  <link rel="stylesheet" href="/css/academicons.min.css">

  <link rel="stylesheet" href="/css/main.css">

  <link rel="stylesheet" href="/css/syntax.css">

  <link rel="stylesheet" href="/css/insileco.css">


    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">Hierarchical edge bundling using base plot</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/about/">About</a></li>
                            
                                <li><a href="https://insilecoinc.github.io/">Consulting</a></li>
                            
                                <li><a href="/post/">Posts</a></li>
                            
                                <li><a href="/resource/">Resources</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="/"><i class="fas fa-home"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/inSileco/"><i class="fab fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://twitter.com/inSileco/"><i class="fab fa-twitter"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://insileco.github.io/index.xml"><i class="fas fa-rss"></i></a></li>
                            
                        </ul>
                    
                </div>
            </div>
        </nav>


<img class="full-width" width="100%" src="/img/banner4.png"></img>


<div class="row">

    <div class="col-md-3">
        <div class = "toc">

    <h2 style="margin-top: 0.5rem; padding-top: 0.5rem; padding-bottom: 0.25rem;">
        <a href="#">
            <i class='fas fa-chevron-up'></i>
        </a>
    </h2>

    
    <nav id="TableOfContents">
  <ul>
    <li><a href="#libraries">Libraries</a></li>
    <li><a href="#data">Data</a></li>
    <li><a href="#circle-functions">Circle functions</a></li>
    <li><a href="#visualization-functions">Visualization functions</a></li>
    <li><a href="#plot-metanetwork">Plot metanetwork</a></li>
    <li><a href="#metanetwork-function">Metanetwork function</a></li>
  </ul>
</nav>
    

    <h2 style="margin-top: 0.25rem; padding-top: 0.5rem;">
        <a href="#bottom">
            <i class='fas fa-chevron-down'></i>
        </a>
    </h2>

</div>
    </div>


    <div class="col-md-8">

        <div class="post-content">

            <h1>
                <a href="/2018/02/21/hierarchical-edge-bundling-using-base-plot/">Hierarchical edge bundling using base plot</a>
            </h1>

            <h4>
                February 21, 2018
            </h4>

            <p>
                <i class="fas fa-tags" aria-hidden="true"></i> &nbsp;  <a
                    href="/tags/r"><kbd class="item-tag">R</kbd></a>  <a
                    href="/tags/viz"><kbd class="item-tag">Viz</kbd></a>  <a
                    href="/tags/network"><kbd class="item-tag">network</kbd></a> 
                <br>
                
                    <img src="/img/Rlogo.svg" title="List of R packages required for this post." width="80px"></img>
                    &nbsp; 
                     
                        <a href="/rpkgs/graphicsutils">
                            <kbd class="item-tag2">graphicsutils</kbd>
                        </a> 
                     
                        <a href="/rpkgs/dplyr">
                            <kbd class="item-tag2">dplyr</kbd>
                        </a> 
                     
                        <a href="/rpkgs/plotrix">
                            <kbd class="item-tag2">plotrix</kbd>
                        </a> 
                    
                
            </p>

            
            <p style="font-size: 1.6em;"> 
                <i class="fas fa-pencil-alt"></i>
                
                 
                    
                    <a href="/about/">David Beauchesne</a>
                
                <a href="#"></a>
            </p>
            

            
            <p> 
                <i class="fas fa-check-square" title="Reviewer(s)"></i>
                
                 
                    
                    <a href="/about/">Kevin Cazelles</a>
                
                <a href="#"></a>
            </p>
            

            <p>
                
                
                
                    <img src='https://img.shields.io/static/v1?style=flat&amp;label=reading%20time&amp;message=15min&amp;color=3fb3b2&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAA/1BMVEU/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7L////QnMRFAAAAVHRSTlMAAyRgm8Pa5C&#43;GyOPo5xV40unq3y2szJpqSjw3wcVtIwTikCLebwkBeQUQHTB30ZgHAojvroftrQjNS4nsBmfcKbbLbBMXdOvmsUgynn8LWMBxIGRFHj3/AAAAAWJLR0RU5AOIpQAAAAlwSFlzAAAN5QAADeUB5upprwAAAAd0SU1FB&#43;QEBQceG9g0RXAAAAFvSURBVDjLhVPXdoJAEF0BQdwZZMHeKIolMUbTJb2aXv//X4IFZD16uC8wu3fKztwhJERKEKW0rChyWhKFFFlHKqNmKQAGAKBZNbNG0XI6AzCAmiYNPsD0nBa/zxcCPyyWypVqtVIuFWdWIb&#43;6r9UZQqNp2QvTtpoNQFavRf7BveO24iFbrhMwljG0AsO21&#43;GL6nhtZIV5Hd0eouP1F&#43;c7u1p38df3HMTezBjoAG7ovzfcH4UxXAB9QMhYZdCwwsgHh0dRLqsBTB0TIQvYjFIfn5yeRUYTISsQkcJE2EwQJkBFIoFRsjcT7JIBEkkDlMlmAikDpImM1N9G8CnKREGzyhFiHauaqKwRzi8m/iVP4FNcmca1e9ONp&#43;CLHPm3aNzdP8SK5J9JyOPTcPr88jqKnsk3KsD47d2Ztj8uw0bxrZ7j8&#43;sbf6JW88Na4vdPi4bFjzsumeW4ecGssBJMouSSRZss&#43;&#43;TFSV695OUlW9f/HyniMFbfN&#43;2lAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTA0LTA1VDExOjMwOjUyLTA0OjAwwJKD8wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wNC0wNVQxMTozMDoyNy0wNDowMOkyHfEAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC'>
                
                
                
                
                
                    <a href="https://creativecommons.org/licenses/by/4.0/">
                        <img src="https://img.shields.io/static/v1?style=flat&label=license&message=CC-BY-4.0&color=f76f2b&logo=creative-commons">
                    </a>
                
                
                
                
                &nbsp;&nbsp;
                <a href="http://twitter.com/share?url=https%3a%2f%2finsileco.github.io%2f2018%2f02%2f21%2fhierarchical-edge-bundling-using-base-plot%2f&text=Hierarchical%20edge%20bundling%20using%20base%20plot" target="_blank">
                    <img src='https://img.shields.io/twitter/url?style=social&url=https%3a%2f%2finsileco.github.io%2f2018%2f02%2f21%2fhierarchical-edge-bundling-using-base-plot%2f?link=http://left&link=http://right}'>
                </a>
            </p>


            <div id="post-content-body" class="text-justify">

                <p>I recently came across a very interesting paper from Laura Dee and collaborators
focused on the concept of metanetworks and entitled &ldquo;<em>Operationalizing Network
Theory for Ecosystem Service Assessments</em>&rdquo;
(<a href="http://www.cell.com/trends/ecology-evolution/fulltext/S0169-5347(16)30192-6">Dee <em>et al</em> 2017, TREE 32(2):118-130</a>).
After reading that article I have begun to revamp the context of my thesis around
the concept of metanetworks to include environmental impact assessment and
cumulative impacts assessment within such a framework.</p>
<p>Work extensively with networks, you quickly realize that coming up with
meaningful and useful visualization can be a bit of a challenge. Thinking about
which type of visualization to use for this, the notion of using
hierarchical edge bundling became very appealing to capture the complexity of
network structure at a glance. While this type of visualization can be close to
useless at a fine scale to study individual connections, it can be pretty useful
to glean insights as to the overall arrangements of links within networks.</p>
<p>With that in mind, I began going through the material available to make hierarchical
edge bundling in R. There is quite a bit of material already available on R, but
what I found was always through <code>ggraph</code> and <code>ggplot</code>, which I personally don&rsquo;t
enjoy using all that much (<em>e.g.</em>
<a href="https://www.r-graph-gallery.com/hierarchical-edge-bundling/">this</a>).
I rather prefer having full control and understanding of what I am doing with my
visualizations. So, is here the product of this work to generate the figure I wished to
create for my thesis!</p>
<h2 id="libraries">Libraries</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">graphicsutils</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pal_insileco</span> <span class="o">&lt;-</span> <span class="nf">gpuPalette</span><span class="p">(</span><span class="s">&#34;insileco&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="data">Data</h2>
<p>Let&rsquo;s start by simulating data for a metanetwork (<em>i.e.</em> a network composed of
multiple networks). To make this as simple as possible, I will simply simulate
a dataset composed of hierarchical nodes and another one identifying the links
between those nodes.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Individual network nodes</span>
</span></span><span class="line"><span class="cl">  <span class="n">opt</span> <span class="o">&lt;-</span> <span class="nf">options</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="nf">options</span><span class="p">(</span><span class="n">stringsAsFactors</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">drivers</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">network</span> <span class="o">=</span> <span class="s">&#39;Drivers&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;driver_&#39;</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">15</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="n">species</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">network</span> <span class="o">=</span> <span class="s">&#39;Species&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;species_&#39;</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="n">actions</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">network</span> <span class="o">=</span> <span class="s">&#39;Actions&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;action_&#39;</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="n">managers</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">network</span> <span class="o">=</span> <span class="s">&#39;Managers&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;manager_&#39;</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="n">beneficiaries</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">network</span> <span class="o">=</span> <span class="s">&#39;Beneficiaries&#39;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;beneficiary_&#39;</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Nodes dataframe</span>
</span></span><span class="line"><span class="cl">  <span class="n">nodes</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">drivers</span><span class="p">,</span> <span class="n">species</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">managers</span><span class="p">,</span> <span class="n">beneficiaries</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Simulate links</span>
</span></span><span class="line"><span class="cl">  <span class="n">links</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">from</span> <span class="o">=</span> <span class="nf">sample</span><span class="p">(</span><span class="n">nodes</span><span class="o">$</span><span class="n">name</span><span class="p">,</span> <span class="m">300</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                      <span class="n">to</span> <span class="o">=</span> <span class="nf">sample</span><span class="p">(</span><span class="n">nodes</span><span class="o">$</span><span class="n">name</span><span class="p">,</span> <span class="m">300</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="n">links</span> <span class="o">&lt;-</span> <span class="n">links[</span><span class="o">!</span><span class="nf">duplicated</span><span class="p">(</span><span class="n">links</span><span class="p">),</span> <span class="n">]</span>   <span class="c1"># Remove duplicates</span>
</span></span><span class="line"><span class="cl">  <span class="n">links</span> <span class="o">&lt;-</span> <span class="n">links[</span><span class="o">!</span><span class="n">links</span><span class="o">$</span><span class="n">from</span> <span class="o">==</span> <span class="n">links</span><span class="o">$</span><span class="n">to</span><span class="p">,</span> <span class="n">]</span> <span class="c1"># Remove &#34;cannibalism&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Combine in a single object</span>
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span> <span class="o">&lt;-</span> <span class="nf">vector</span><span class="p">(</span><span class="s">&#39;list&#39;</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span> <span class="o">&lt;-</span> <span class="n">nodes</span>
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span> <span class="o">&lt;-</span> <span class="n">links</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;    network     name</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1 Drivers driver_1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2 Drivers driver_2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3 Drivers driver_3</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4 Drivers driver_4</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5 Drivers driver_5</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  6 Drivers driver_6</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">links</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;             from            to</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1 beneficiary_3     manager_2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2     manager_4      driver_4</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3      driver_9    species_21</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4     manager_9 beneficiary_8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5     driver_13     driver_12</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  6    species_25     manager_1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="circle-functions">Circle functions</h2>
<p>Now that we have the nodes and links, we need to create the necessary functions
that will allow us to position our data on a circular graph.</p>
<br/>
<h3 id="circle-coordinates">Circle coordinates</h3>
<p>The first function we need will be used to generate the x and y coordinates of a
circle for a given angle and circle radius, which we can obtain with some circle trigonometry.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Let&#39;s begin by creating a function that will give us the x and y coordinates</span>
</span></span><span class="line"><span class="cl"><span class="c1"># of the outside of a circle given a certain radius</span>
</span></span><span class="line"><span class="cl"><span class="n">coordCircle</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">theta</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="nf">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">             <span class="n">y</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="nf">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">coordCircle</span><span class="p">(</span><span class="n">theta</span> <span class="o">=</span> <span class="kc">pi</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;     x            y</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1 -1 1.224647e-16</span>
</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<h3 id="group-boundaries">Group boundaries</h3>
<p>The second function that we need is one that will allow us to distribute groups
on the circular plot according to the number of elements composing that group.
In essence, we wish to provide the upper and lower boundaries of each individual
network composing the metanetwork. We may also want to add a gap between the
individual networks on the graph. This will make the visual aspect of the graph
more appealing.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">bound</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">gap</span> <span class="o">=</span> <span class="m">.025</span><span class="p">,</span> <span class="n">addGap</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Metanetwork list composed of &#34;nodes&#34; and &#34;links&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Size of gap between groups on the graph</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># addGap logical whether to add gap or not</span>
</span></span><span class="line"><span class="cl">  <span class="n">nGroup</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="n">nGroup</span><span class="o">$</span><span class="n">Prop</span> <span class="o">&lt;-</span> <span class="n">nGroup</span><span class="o">$</span><span class="n">Freq</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">nGroup</span><span class="o">$</span><span class="n">Freq</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="n">nGroup</span><span class="o">$</span><span class="n">spanDeg</span> <span class="o">&lt;-</span> <span class="m">2</span> <span class="o">*</span> <span class="kc">pi</span> <span class="o">*</span> <span class="n">nGroup</span><span class="o">$</span><span class="n">Prop</span>
</span></span><span class="line"><span class="cl">  <span class="n">nGroup</span><span class="o">$</span><span class="n">upper</span> <span class="o">&lt;-</span> <span class="n">nGroup</span><span class="o">$</span><span class="n">lower</span> <span class="o">&lt;-</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">  <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">2</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">nGroup</span><span class="p">))</span> <span class="n">nGroup</span><span class="o">$</span><span class="n">lower[i]</span> <span class="o">&lt;-</span> <span class="n">nGroup</span><span class="o">$</span><span class="n">lower[i</span><span class="m">-1</span><span class="n">]</span> <span class="o">+</span> <span class="n">nGroup</span><span class="o">$</span><span class="n">spanDeg[i</span><span class="m">-1</span><span class="n">]</span>
</span></span><span class="line"><span class="cl">  <span class="n">nGroup</span><span class="o">$</span><span class="n">upper</span> <span class="o">&lt;-</span> <span class="n">nGroup</span><span class="o">$</span><span class="n">lower</span> <span class="o">+</span> <span class="n">nGroup</span><span class="o">$</span><span class="n">spanDeg</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">if </span><span class="p">(</span><span class="n">addGap</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">nGroup</span><span class="o">$</span><span class="n">lower</span> <span class="o">&lt;-</span> <span class="n">nGroup</span><span class="o">$</span><span class="n">lower</span> <span class="o">+</span> <span class="n">gap</span> <span class="o">/</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl">    <span class="n">nGroup</span><span class="o">$</span><span class="n">upper</span> <span class="o">&lt;-</span> <span class="n">nGroup</span><span class="o">$</span><span class="n">upper</span> <span class="o">-</span> <span class="n">gap</span> <span class="o">/</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">nGroup</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Add to metanetworks list</span>
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span> <span class="o">&lt;-</span> <span class="nf">bound</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;             Var1 Freq      Prop   spanDeg     lower     upper</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1       Actions    9 0.1250000 0.7853982 0.0125000 0.7728982</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2 Beneficiaries    9 0.1250000 0.7853982 0.7978982 1.5582963</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3       Drivers   15 0.2083333 1.3089969 1.5832963 2.8672933</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4      Managers    9 0.1250000 0.7853982 2.8922933 3.6526914</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5       Species   30 0.4166667 2.6179939 3.6776914 6.2706853</span>
</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<h3 id="nodes-coordinates">Nodes coordinates</h3>
<p>Now we need to get the coordinates of the edges so that we can position them
on the graph. We also need to get coordinates for each network so that we can
build an internal, hierarchical structure to the distribution of edges on the
graph that can be used to plot links between edges. These should be distributed
as the user wish within the circle using different radius values. As with the
groups, we can add a gap between the edges at the beginning and end of the group
for visual differentiation between the group.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">nodePos</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">edgeRad</span> <span class="o">=</span> <span class="m">0.975</span><span class="p">,</span> <span class="n">groupRad</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span> <span class="n">gapEdge</span> <span class="o">=</span> <span class="m">0.1</span><span class="p">,</span> <span class="n">addGap</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Add x and y columns to nodes and networkGroup data</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">y</span> <span class="o">&lt;-</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">x</span> <span class="o">&lt;-</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">y</span> <span class="o">&lt;-</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">x</span> <span class="o">&lt;-</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Get coordinates for all networks</span>
</span></span><span class="line"><span class="cl">    <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># Distribute points within each network space</span>
</span></span><span class="line"><span class="cl">      <span class="n">edgeDeg</span> <span class="o">&lt;-</span> <span class="nf">seq</span><span class="p">((</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">lower[i]</span> <span class="o">+</span> <span class="p">(</span><span class="n">gapEdge</span><span class="o">/</span><span class="m">2</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">                       <span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">upper[i]</span> <span class="o">-</span> <span class="p">(</span><span class="n">gapEdge</span><span class="o">/</span><span class="m">2</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">                       <span class="n">length</span> <span class="o">=</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">Freq[i]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1"># Get position for each edge</span>
</span></span><span class="line"><span class="cl">      <span class="n">nodePos</span> <span class="o">&lt;-</span> <span class="nf">coordCircle</span><span class="p">(</span><span class="n">theta</span> <span class="o">=</span> <span class="n">edgeDeg</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">edgeRad</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1"># Add to nodes data</span>
</span></span><span class="line"><span class="cl">      <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">x[metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network</span> <span class="o">==</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">Var1[i]]</span> <span class="o">&lt;-</span> <span class="n">nodePos</span><span class="o">$</span><span class="n">x</span>
</span></span><span class="line"><span class="cl">      <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">y[metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network</span> <span class="o">==</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">Var1[i]]</span> <span class="o">&lt;-</span> <span class="n">nodePos</span><span class="o">$</span><span class="n">y</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1"># Distribute network groups in space</span>
</span></span><span class="line"><span class="cl">      <span class="n">groupDeg</span> <span class="o">&lt;-</span> <span class="nf">mean</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">lower[i]</span><span class="p">,</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">upper[i]</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1"># Get position for each group</span>
</span></span><span class="line"><span class="cl">      <span class="n">groupPos</span> <span class="o">&lt;-</span> <span class="nf">coordCircle</span><span class="p">(</span><span class="n">theta</span> <span class="o">=</span> <span class="n">groupDeg</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">groupRad</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="c1"># Add to group data</span>
</span></span><span class="line"><span class="cl">      <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">x[i]</span> <span class="o">&lt;-</span> <span class="n">groupPos</span><span class="o">$</span><span class="n">x</span>
</span></span><span class="line"><span class="cl">      <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">y[i]</span> <span class="o">&lt;-</span> <span class="n">groupPos</span><span class="o">$</span><span class="n">y</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">metanetwork</span> <span class="o">&lt;-</span> <span class="nf">nodePos</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">edgeRad</span> <span class="o">=</span> <span class="m">.875</span><span class="p">,</span> <span class="n">groupRad</span> <span class="o">=</span> <span class="m">.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;    network     name          x         y</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1 Drivers driver_1 -0.0546519 0.8732916</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2 Drivers driver_2 -0.1282239 0.8655539</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3 Drivers driver_3 -0.2008793 0.8516293</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4 Drivers driver_4 -0.2720989 0.8316172</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5 Drivers driver_5 -0.3413735 0.8056607</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  6 Drivers driver_6 -0.4082079 0.7739453</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;             Var1 Freq      Prop   spanDeg     lower     upper          x</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1       Actions    9 0.1250000 0.7853982 0.0125000 0.7728982  0.4619398</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2 Beneficiaries    9 0.1250000 0.7853982 0.7978982 1.5582963  0.1913417</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3       Drivers   15 0.2083333 1.3089969 1.5832963 2.8672933 -0.3043807</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4      Managers    9 0.1250000 0.7853982 2.8922933 3.6526914 -0.4957224</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5       Species   30 0.4166667 2.6179939 3.6776914 6.2706853  0.1294095</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;             y</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1  0.1913417</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2  0.4619398</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3  0.3966767</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4 -0.0652631</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5 -0.4829629</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Visualize the positions of the nodes</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">par</span><span class="p">(</span><span class="n">mar</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot0</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">points</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">x</span><span class="p">,</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">y</span><span class="p">,</span> <span class="n">pch</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">points</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">x</span><span class="p">,</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">y</span><span class="p">,</span> <span class="n">pch</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="/post/2018/metanetwork_files/figure-html/nodePos-1.png" width="480" style="display: block; margin: auto;" />
<h2 id="visualization-functions">Visualization functions</h2>
<p>Now we need a few functions to automate the visualization of a few components of
the circular plot.</p>
<h3 id="plot-groups">Plot groups</h3>
<p>I actually wish to have a box around the edge of my graph identifying each
individual network and their name. To do this, we can use the <code>polygon</code>
and <code>plotrix::arctext</code> function.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># We can now use both functions to generate a box for each group on the plot</span>
</span></span><span class="line"><span class="cl"><span class="n">boxGroup</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">rad1</span> <span class="o">=</span> <span class="m">.95</span><span class="p">,</span> <span class="n">rad2</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">colBox</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="n">colNames</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="n">addNames</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># metanetwork = data list composed of &#39;nodes&#39;, &#39;links&#39; &amp; &#39;networkGroup&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># rad1 = lower boundary for polygons</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># rad2 = upper boundary for polygons</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># colBox = color of boxes</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># names = names of individual networks</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># colNames = color of names</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># addNames = logical, add names of networks to graph</span>
</span></span><span class="line"><span class="cl">  <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">colNames</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nf">length</span><span class="p">(</span><span class="n">colNames</span><span class="p">)</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">colNames</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="n">colNames</span><span class="p">,</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">colBox</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nf">length</span><span class="p">(</span><span class="n">colBox</span><span class="p">)</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">colBox</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="n">colBox</span><span class="p">,</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">&lt;-</span> <span class="nf">coordCircle</span><span class="p">(</span><span class="n">theta</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">lower[i]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">upper[i]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">length</span> <span class="o">=</span> <span class="m">200</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                     <span class="n">radius</span> <span class="o">=</span> <span class="n">rad1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">&lt;-</span> <span class="nf">coordCircle</span><span class="p">(</span><span class="n">theta</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">upper[i]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">lower[i]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">length</span> <span class="o">=</span> <span class="m">200</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                     <span class="n">radius</span> <span class="o">=</span> <span class="n">rad2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">polygon</span><span class="p">(</span><span class="nf">rbind</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a[1L</span><span class="p">,</span><span class="n">]</span><span class="p">),</span> <span class="n">col</span> <span class="o">=</span> <span class="n">colBox[i]</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">if </span><span class="p">(</span><span class="n">addNames</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">middle</span> <span class="o">&lt;-</span> <span class="nf">mean</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">lower[i]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">upper[i]</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">      <span class="n">clockwise</span> <span class="o">&lt;-</span> <span class="n">middle</span> <span class="o">&gt;</span> <span class="kc">pi</span>
</span></span><span class="line"><span class="cl">      <span class="n">plotrix</span><span class="o">::</span><span class="nf">arctext</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">as.character</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">Var1[i]</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                       <span class="n">radius</span> <span class="o">=</span> <span class="nf">mean</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">rad1</span><span class="p">,</span><span class="n">rad2</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">                       <span class="n">middle</span> <span class="o">=</span> <span class="n">middle</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">col</span> <span class="o">=</span> <span class="n">colNames[i]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">clockwise</span> <span class="o">=</span> <span class="n">clockwise</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">font</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Now we can plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">),</span> <span class="n">mar</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot0</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">boxGroup</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">addNames</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot0</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">boxGroup</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">rad1</span> <span class="o">=</span> <span class="m">.5</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="/post/2018/metanetwork_files/figure-html/plotGroups-1.png" width="960" style="display: block; margin: auto;" />
<h3 id="plot-connections">Plot connections</h3>
<p>Now we can plot the links between the nodes in our graph using the underlying
hierarchical structure identified using the <code>nodePos</code> function created earlier.
We can do this using the <code>xspline</code> function.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">plotLinks</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">is.null</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nf">length</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cols</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">link</span> <span class="o">&lt;-</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">links[i</span><span class="p">,</span><span class="n">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">edgeFromID</span> <span class="o">&lt;-</span> <span class="nf">which</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">name</span> <span class="o">==</span> <span class="n">link</span><span class="o">$</span><span class="n">from</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">edgeToID</span> <span class="o">&lt;-</span> <span class="nf">which</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">name</span> <span class="o">==</span> <span class="n">link</span><span class="o">$</span><span class="n">to</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">groupFromID</span> <span class="o">&lt;-</span> <span class="nf">which</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">Var1</span> <span class="o">==</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network[edgeFromID]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">groupToID</span> <span class="o">&lt;-</span> <span class="nf">which</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">Var1</span> <span class="o">==</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network[edgeToID]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">if </span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network[edgeFromID]</span> <span class="o">!=</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network[edgeToID]</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">linkPath</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes[edgeFromID</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;y&#39;</span><span class="p">)</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup[groupFromID</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;y&#39;</span><span class="p">)</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup[groupToID</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;y&#39;</span><span class="p">)</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes[edgeToID</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;y&#39;</span><span class="p">)</span><span class="n">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">linkPath</span> <span class="o">&lt;-</span> <span class="nf">rbind</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes[edgeFromID</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;y&#39;</span><span class="p">)</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup[groupFromID</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;y&#39;</span><span class="p">)</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes[edgeToID</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">,</span><span class="s">&#39;y&#39;</span><span class="p">)</span><span class="n">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">lines</span><span class="p">(</span><span class="nf">xspline</span><span class="p">(</span><span class="n">linkPath</span><span class="o">$</span><span class="n">x</span><span class="p">,</span> <span class="n">linkPath</span><span class="o">$</span><span class="n">y</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">draw</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">),</span> <span class="n">col</span> <span class="o">=</span> <span class="n">cols[i]</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">par</span><span class="p">(</span><span class="n">mar</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot0</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">plotLinks</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s">&#39;black&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">points</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">x</span><span class="p">,</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">y</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="/post/2018/metanetwork_files/figure-html/plotLinks-1.png" width="672" style="display: block; margin: auto;" />
</br>
<h2 id="plot-metanetwork">Plot metanetwork</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># The plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">par</span><span class="p">(</span><span class="n">mar</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot0</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">boxGroup</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">plotLinks</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s">&#39;black&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">points</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">x</span><span class="p">,</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">y</span><span class="p">,</span> <span class="n">pch</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="/post/2018/metanetwork_files/figure-html/metanetwork-1.png" width="576" style="display: block; margin: auto;" />
<br/>
<h3 id="customize-graph-functions">Customize graph functions</h3>
<p>Now we can build functions to customize the graph a little bit, <em>e.g.</em> add colors
to links and nodes and change the size of the nodes.</p>
<p>First, let&rsquo;s give a color to individual networks.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">colGroups</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">colPal</span> <span class="o">=</span> <span class="n">pal_insileco</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Group colors</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">cols</span> <span class="o">&lt;-</span> <span class="n">colPal[1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="p">)</span><span class="n">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Node colors</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">cols</span> <span class="o">&lt;-</span> <span class="kc">NA</span>
</span></span><span class="line"><span class="cl">    <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">cols[metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network</span> <span class="o">==</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">Var1[i]]</span> <span class="o">&lt;-</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">cols[i]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">metanetwork</span> <span class="o">&lt;-</span> <span class="nf">colGroups</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">colPal</span> <span class="o">=</span> <span class="n">pal_insileco</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;    network     name          x         y    cols</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1 Drivers driver_1 -0.0546519 0.8732916 #ffdd55</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2 Drivers driver_2 -0.1282239 0.8655539 #ffdd55</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3 Drivers driver_3 -0.2008793 0.8516293 #ffdd55</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4 Drivers driver_4 -0.2720989 0.8316172 #ffdd55</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5 Drivers driver_5 -0.3413735 0.8056607 #ffdd55</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  6 Drivers driver_6 -0.4082079 0.7739453 #ffdd55</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;             Var1 Freq      Prop   spanDeg     lower     upper          x</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1       Actions    9 0.1250000 0.7853982 0.0125000 0.7728982  0.4619398</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2 Beneficiaries    9 0.1250000 0.7853982 0.7978982 1.5582963  0.1913417</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3       Drivers   15 0.2083333 1.3089969 1.5832963 2.8672933 -0.3043807</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4      Managers    9 0.1250000 0.7853982 2.8922933 3.6526914 -0.4957224</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5       Species   30 0.4166667 2.6179939 3.6776914 6.2706853  0.1294095</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;             y    cols</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1  0.1913417 #212121</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2  0.4619398 #3fb3b2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3  0.3966767 #ffdd55</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4 -0.0652631 #c7254e</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5 -0.4829629 #1b95e0</span>
</span></span></code></pre></td></tr></table>
</div>
</div></br>
<p>Second, a function to give a size to nodes based on link frequency.</p>
<br/>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Add size to nodes based on frequency of links to each node</span>
</span></span><span class="line"><span class="cl"><span class="n">nodeSize</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">if </span><span class="p">(</span><span class="nf">isTRUE</span><span class="p">(</span><span class="n">freq</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">nLink</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">from</span><span class="p">,</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">to</span><span class="p">)),</span> <span class="n">stringsAsFactors</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">colnames</span><span class="p">(</span><span class="n">nLink</span><span class="p">)</span><span class="n">[1L]</span> <span class="o">&lt;-</span> <span class="s">&#39;name&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span> <span class="o">&lt;-</span> <span class="n">dplyr</span><span class="o">::</span><span class="nf">left_join</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="p">,</span> <span class="n">nLink</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="s">&#39;name&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">cex</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">Freq</span> <span class="o">/</span> <span class="nf">max</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">Freq</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="n">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">cex</span> <span class="o">&lt;-</span> <span class="m">.33</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">return</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">metanetwork</span> <span class="o">&lt;-</span> <span class="nf">nodeSize</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;    network     name          x         y    cols Freq       cex</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1 Drivers driver_1 -0.0546519 0.8732916 #ffdd55    4 0.2666667</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2 Drivers driver_2 -0.1282239 0.8655539 #ffdd55   12 0.8000000</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3 Drivers driver_3 -0.2008793 0.8516293 #ffdd55    4 0.2666667</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4 Drivers driver_4 -0.2720989 0.8316172 #ffdd55    6 0.4000000</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5 Drivers driver_5 -0.3413735 0.8056607 #ffdd55    4 0.2666667</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  6 Drivers driver_6 -0.4082079 0.7739453 #ffdd55    6 0.4000000</span>
</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<p>Finally, we can give a color to links or focus on certain individual networks in
the metanetwork, or focus on all the links for a single network.</p>
<br/>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">linkCol</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;all&#39;</span><span class="p">,</span> <span class="n">focus</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span> <span class="n">colLinks</span> <span class="o">=</span> <span class="s">&#39;#876b40&#39;</span><span class="p">,</span> <span class="n">colShadow</span> <span class="o">=</span> <span class="s">&#39;#f4f4f4&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># metanetwork = list composed of &#39;nodes&#39;, &#39;links&#39; and &#39;networkGroup&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># type        = type of colors:</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#                 &#39;all&#39; = all links with single color = `colLinks`</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#                 &#39;focus&#39; = focus on the links of identified network</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># focus       = character, name of network(s) to focus on;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#                 if length(focus) == 1, all links towards a single network</span>
</span></span><span class="line"><span class="cl">  <span class="c1">#                 if length(focus) &gt; 1, links focused on identified networks</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># colLinks    = color of links of `type` == &#39;all&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># colShadow   = color of links that we are not focused on</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Function</span>
</span></span><span class="line"><span class="cl">  <span class="nf">if </span><span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">cols</span> <span class="o">&lt;-</span> <span class="n">colLinks</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">if </span><span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="s">&#39;focus&#39;</span> <span class="o">&amp;</span> <span class="nf">length</span><span class="p">(</span><span class="n">focus</span><span class="p">)</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Box colors</span>
</span></span><span class="line"><span class="cl">    <span class="n">focusID</span> <span class="o">&lt;-</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">Var1</span> <span class="o">%in%</span> <span class="n">focus</span>
</span></span><span class="line"><span class="cl">    <span class="n">colBox</span> <span class="o">&lt;-</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">cols</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">cols[</span><span class="o">!</span><span class="n">focusID]</span> <span class="o">&lt;-</span> <span class="n">colShadow</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">colNames</span> <span class="o">&lt;-</span> <span class="n">colBox</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">colNames[focusID]</span> <span class="o">&lt;-</span> <span class="n">colShadow</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Link colors</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># metanetwork$links$cols &lt;- paste0(colShadow, 88)</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">cols</span> <span class="o">&lt;-</span> <span class="n">colShadow</span>
</span></span><span class="line"><span class="cl">    <span class="n">linkCol</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">from</span> <span class="o">=</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network</span><span class="nf">[match</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">from</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                                 <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">name</span><span class="p">)</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                          <span class="n">to</span> <span class="o">=</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network</span><span class="nf">[match</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">to</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                                <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">name</span><span class="p">)</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                          <span class="n">stringsAsFactors</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">linkID</span> <span class="o">&lt;-</span> <span class="n">linkCol</span><span class="o">$</span><span class="n">from</span> <span class="o">%in%</span> <span class="n">focus</span> <span class="o">&amp;</span> <span class="n">linkCol</span><span class="o">$</span><span class="n">to</span> <span class="o">%in%</span> <span class="n">focus</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">cols[linkID]</span> <span class="o">&lt;-</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">cols[focusID]</span> <span class="c1"># &#34;cannibalism&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">linkID</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">linkCol</span><span class="o">$</span><span class="n">from</span> <span class="o">%in%</span> <span class="n">focus</span> <span class="o">|</span> <span class="n">linkCol</span><span class="o">$</span><span class="n">to</span> <span class="o">%in%</span> <span class="n">focus</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">!</span><span class="n">linkID</span>
</span></span><span class="line"><span class="cl">    <span class="n">cols</span> <span class="o">&lt;-</span> <span class="nf">paste0</span><span class="p">(</span><span class="n">linkCol</span><span class="o">$</span><span class="n">from[linkID]</span><span class="p">,</span> <span class="n">linkCol</span><span class="o">$</span><span class="n">to[linkID]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cols</span> <span class="o">&lt;-</span> <span class="nf">gsub</span><span class="p">(</span><span class="n">focus</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cols</span> <span class="o">&lt;-</span> <span class="nf">match</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">Var1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cols</span> <span class="o">&lt;-</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">colNames[cols]</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">cols[linkID]</span> <span class="o">&lt;-</span> <span class="n">cols</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">if </span><span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="s">&#39;focus&#39;</span> <span class="o">&amp;</span> <span class="nf">length</span><span class="p">(</span><span class="n">focus</span><span class="p">)</span> <span class="o">&gt;</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Box colors</span>
</span></span><span class="line"><span class="cl">    <span class="n">focusID</span> <span class="o">&lt;-</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">Var1</span> <span class="o">%in%</span> <span class="n">focus</span>
</span></span><span class="line"><span class="cl">    <span class="n">colBox</span> <span class="o">&lt;-</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">cols</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">cols[</span><span class="o">!</span><span class="n">focusID]</span> <span class="o">&lt;-</span> <span class="n">colShadow</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">colNames</span> <span class="o">&lt;-</span> <span class="n">colBox</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">colNames[focusID]</span> <span class="o">&lt;-</span> <span class="n">colShadow</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Link colors</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">cols</span> <span class="o">&lt;-</span> <span class="n">colShadow</span>
</span></span><span class="line"><span class="cl">    <span class="n">linkCol</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">from</span> <span class="o">=</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network</span><span class="nf">[match</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">from</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                                 <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">name</span><span class="p">)</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                          <span class="n">to</span> <span class="o">=</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">network</span><span class="nf">[match</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">to</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                                                <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">name</span><span class="p">)</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                          <span class="n">stringsAsFactors</span> <span class="o">=</span> <span class="bp">F</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">linkID</span> <span class="o">&lt;-</span> <span class="n">linkCol</span><span class="o">$</span><span class="n">from</span> <span class="o">%in%</span> <span class="n">focus</span> <span class="o">&amp;</span> <span class="n">linkCol</span><span class="o">$</span><span class="n">to</span> <span class="o">%in%</span> <span class="n">focus</span>
</span></span><span class="line"><span class="cl">    <span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">cols[linkID]</span> <span class="o">&lt;-</span> <span class="n">colLinks</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Add transparency</span>
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">cols</span> <span class="o">&lt;-</span> <span class="nf">paste0</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">cols</span><span class="p">,</span> <span class="s">&#39;66&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">metanetwork</span> <span class="o">&lt;-</span> <span class="nf">linkCol</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;focus&#39;</span><span class="p">,</span> <span class="n">focus</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;Species&#39;</span><span class="p">,</span><span class="s">&#39;Drivers&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;             from            to      cols</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1 beneficiary_3     manager_2 #f4f4f466</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2     manager_4      driver_4 #f4f4f466</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3      driver_9    species_21 #876b4066</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4     manager_9 beneficiary_8 #f4f4f466</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5     driver_13     driver_12 #876b4066</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  6    species_25     manager_1 #f4f4f466</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;             Var1 Freq      Prop   spanDeg     lower     upper          x</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1       Actions    9 0.1250000 0.7853982 0.0125000 0.7728982  0.4619398</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2 Beneficiaries    9 0.1250000 0.7853982 0.7978982 1.5582963  0.1913417</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3       Drivers   15 0.2083333 1.3089969 1.5832963 2.8672933 -0.3043807</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4      Managers    9 0.1250000 0.7853982 2.8922933 3.6526914 -0.4957224</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5       Species   30 0.4166667 2.6179939 3.6776914 6.2706853  0.1294095</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;             y    cols colNames</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  1  0.1913417 #f4f4f4  #212121</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  2  0.4619398 #f4f4f4  #3fb3b2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  3  0.3966767 #ffdd55  #f4f4f4</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  4 -0.0652631 #f4f4f4  #c7254e</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  5 -0.4829629 #1b95e0  #f4f4f4</span>
</span></span></code></pre></td></tr></table>
</div>
</div><br/>
<h2 id="metanetwork-function">Metanetwork function</h2>
<p>Now we could wrap all of this in a single function.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">plotMetanetwork</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="n">rad1</span> <span class="o">=</span> <span class="m">.925</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="n">rad2</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="n">sizeEdge</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="n">colPal</span> <span class="o">=</span> <span class="n">pal_insileco</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;all&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="n">focus</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="n">colLinks</span> <span class="o">=</span> <span class="s">&#39;#876b40&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="n">colShadow</span> <span class="o">=</span> <span class="s">&#39;#f4f4f4&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                            <span class="n">shadowEdge</span> <span class="o">=</span> <span class="kc">TRUE</span>
</span></span><span class="line"><span class="cl">                          <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Metanetwork = list composed of &#39;nodes&#39; and &#39;links&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># rad1 = lower boundary for individual networks</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># rad2 = upper boundary for individual networks</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># colPal = color palette</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># colLinks = color for links</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Function</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># Boundaries of individual networks</span>
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span> <span class="o">&lt;-</span> <span class="nf">bound</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Node coordinates</span>
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span> <span class="o">&lt;-</span> <span class="nf">nodePos</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">edgeRad</span> <span class="o">=</span> <span class="m">.875</span><span class="p">,</span> <span class="n">groupRad</span> <span class="o">=</span> <span class="m">.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Colors</span>
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span> <span class="o">&lt;-</span> <span class="nf">colGroups</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">colPal</span> <span class="o">=</span> <span class="n">colPal</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Node size</span>
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span> <span class="o">&lt;-</span> <span class="nf">nodeSize</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="n">sizeEdge</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Link col</span>
</span></span><span class="line"><span class="cl">  <span class="n">metanetwork</span> <span class="o">&lt;-</span> <span class="nf">linkCol</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="n">type</span><span class="p">,</span> <span class="n">focus</span> <span class="o">=</span> <span class="n">focus</span><span class="p">,</span> <span class="n">colLinks</span> <span class="o">=</span> <span class="n">colLinks</span><span class="p">,</span> <span class="n">colShadow</span> <span class="o">=</span> <span class="n">colShadow</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1"># Plot</span>
</span></span><span class="line"><span class="cl">  <span class="nf">par</span><span class="p">(</span><span class="n">mar</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">  <span class="nf">plot0</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="nf">boxGroup</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">rad1</span> <span class="o">=</span> <span class="n">rad1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">colBox</span> <span class="o">=</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">cols</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">colNames</span> <span class="o">=</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">networkGroup</span><span class="o">$</span><span class="n">colNames</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">border</span> <span class="o">=</span> <span class="s">&#39;transparent&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nf">plotLinks</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">col</span> <span class="o">=</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span><span class="o">$</span><span class="n">cols</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nf">if </span><span class="p">(</span><span class="n">shadowEdge</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">points</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">x</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">y</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">pch</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="n">cex</span> <span class="o">=</span> <span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">cex</span> <span class="o">*</span> <span class="m">5</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">           <span class="n">col</span> <span class="o">=</span> <span class="s">&#39;#d7d7d7&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nf">points</span><span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">x</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">y</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">pch</span> <span class="o">=</span> <span class="m">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">cex</span> <span class="o">=</span> <span class="p">(</span><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">cex</span> <span class="o">*</span> <span class="m">3</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">         <span class="n">col</span> <span class="o">=</span> <span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span><span class="o">$</span><span class="n">cols</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The data</span>
</span></span><span class="line"><span class="cl"><span class="n">metanetwork</span> <span class="o">&lt;-</span> <span class="nf">vector</span><span class="p">(</span><span class="s">&#39;list&#39;</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">metanetwork</span><span class="o">$</span><span class="n">nodes</span> <span class="o">&lt;-</span> <span class="n">nodes</span>
</span></span><span class="line"><span class="cl"><span class="n">metanetwork</span><span class="o">$</span><span class="n">links</span> <span class="o">&lt;-</span> <span class="n">links</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># The plot</span>
</span></span><span class="line"><span class="cl"><span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span> <span class="n">bg</span> <span class="o">=</span> <span class="s">&#34;transparent&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">plotMetanetwork</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">plotMetanetwork</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;focus&#39;</span><span class="p">,</span> <span class="n">focus</span> <span class="o">=</span> <span class="s">&#39;Species&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">plotMetanetwork</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;focus&#39;</span><span class="p">,</span> <span class="n">focus</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;Species&#39;</span><span class="p">,</span> <span class="s">&#39;Drivers&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">plotMetanetwork</span><span class="p">(</span><span class="n">metanetwork</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;focus&#39;</span><span class="p">,</span> <span class="n">focus</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;Species&#39;</span><span class="p">,</span> <span class="s">&#39;Drivers&#39;</span><span class="p">,</span> <span class="s">&#39;Managers&#39;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="/post/2018/metanetwork_files/figure-html/function-1.png" width="960" style="display: block; margin: auto;" />
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">opt</span> <span class="o">&lt;-</span> <span class="nf">options</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div style="padding: 2rem 0rem 2rem 0rem;">
<details>
<summary>Session info <i class="fas fa-cogs" aria-hidden="true"></i></summary>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sessionInfo</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  R version 4.2.2 Patched (2022-11-10 r83330)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  Platform: x86_64-pc-linux-gnu (64-bit)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  Running under: Ubuntu 22.04.1 LTS</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  Matrix products: default</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  locale:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [1] LC_CTYPE=en_CA.UTF-8       LC_NUMERIC=C              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [3] LC_TIME=en_CA.UTF-8        LC_COLLATE=en_CA.UTF-8    </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [5] LC_MONETARY=en_CA.UTF-8    LC_MESSAGES=en_CA.UTF-8   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [7] LC_PAPER=en_CA.UTF-8       LC_NAME=C                 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [11] LC_MEASUREMENT=en_CA.UTF-8 LC_IDENTIFICATION=C       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  attached base packages:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  other attached packages:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [1] graphicsutils_1.6.0.9000 inSilecoRef_0.0.1.9000  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  loaded via a namespace (and not attached):</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [1] bslib_0.4.2       tidyselect_1.2.0  xfun_0.36         vctrs_0.5.2      </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [5] generics_0.1.3    miniUI_0.1.1.1    htmltools_0.5.4   yaml_2.3.6       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [9] utf8_1.2.3        rlang_1.0.6       jquerylib_0.1.4   pillar_1.8.1     </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [13] later_1.3.0       glue_1.6.2        httpcode_0.3.0    withr_2.5.0      </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [17] lifecycle_1.0.3   plyr_1.8.8        stringr_1.5.0     targets_0.14.2   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [21] blogdown_1.16     htmlwidgets_1.6.1 evaluate_0.19     codetools_0.2-19 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [25] knitr_1.41        callr_3.7.3       fastmap_1.1.0     httpuv_1.6.8     </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [29] ps_1.7.2          curl_5.0.0        fansi_1.0.4       highr_0.10       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [33] Rcpp_1.0.10       xtable_1.8-4      backports_1.4.1   promises_1.2.0.1 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [37] DT_0.26           plotrix_3.8-2     cachem_1.0.6      jsonlite_1.8.4   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [41] rcrossref_1.2.0   mime_0.12         digest_0.6.31     stringi_1.7.8    </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [45] bookdown_0.32     processx_3.8.0    dplyr_1.1.0       shiny_1.7.4      </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [49] cli_3.5.0         tools_4.2.2       sass_0.4.5        magrittr_2.0.3   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [53] base64url_1.4     tibble_3.1.8      RefManageR_1.3.0  crul_1.3         </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [57] pkgconfig_2.0.3   ellipsis_0.3.2    data.table_1.14.6 xml2_1.3.3       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [61] lubridate_1.8.0   rmarkdown_2.19    httr_1.4.4        R6_2.5.1         </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [65] igraph_1.3.5      compiler_4.2.2</span>
</span></span></code></pre></td></tr></table>
</div>
</div></details>
</div>


                


            </div>


        </div>

          <br>


  
  <script src="//yihui.name/js/math-code.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
  
  


  <script src="/js/sidebar-post.js"></script>

  <h3 class="page-header">Comments on this post</h3>

  <script src="https://utteranc.es/client.js"
        repo="inSileco/inSileco.github.io"
        issue-term="pathname"
        label="Comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
  </script>


  <details>
  <summary>Comment with Disqus</summary>
  <div id="disqus_thread"></div>
  </details>

  
  

  
    <h3 class="page-header">Related posts</h3>
     <div class="item-bottom">

  

  <h1>
    <a href="/2023/02/12/trick-or-tips-005-r/">Trick or Tips 005 {R}</a> <small>February 12, 2023</small>
  </h1>

  <p> <i class="fas fa-tags" aria-hidden="true"></i>  <a href="/tags/r"><kbd class="item-tag">R</kbd></a>  <a href="/tags/tips"><kbd class="item-tag">tips</kbd></a>  <a href="/tags/trickortips"><kbd class="item-tag">trickortips</kbd></a> </p>

  



  

</div>
  <div class="item-bottom">

  

  <h1>
    <a href="/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/">Custom tick marks with R&#39;s base graphics system</a> <small>August 29, 2020</small>
  </h1>

  <p> <i class="fas fa-tags" aria-hidden="true"></i>  <a href="/tags/r"><kbd class="item-tag">R</kbd></a>  <a href="/tags/ticks"><kbd class="item-tag">ticks</kbd></a>  <a href="/tags/axes"><kbd class="item-tag">axes</kbd></a> </p>

  



  

</div>
  <div class="item-bottom">

  

  <h1>
    <a href="/2020/04/21/insilecomisc-0.4.0-part-2/2/">inSilecoMisc 0.4.0 (part 2/2)</a> <small>April 21, 2020</small>
  </h1>

  <p> <i class="fas fa-tags" aria-hidden="true"></i>  <a href="/tags/r"><kbd class="item-tag">R</kbd></a>  <a href="/tags/package"><kbd class="item-tag">package</kbd></a>  <a href="/tags/development"><kbd class="item-tag">development</kbd></a>  <a href="/tags/insilecomisc"><kbd class="item-tag">inSilecoMisc</kbd></a> </p>

  



  

</div>
 
  





  <script>
    


    var disqus_config = function() {
      this.page.url = "https://insileco.github.io" + "https://insileco.github.io/2018/02/21/hierarchical-edge-bundling-using-base-plot/"; 
      this.page.identifier = "Hierarchical edge bundling using base plot"; 
    };

    (function() { 
      var d = document,
        s = d.createElement('script');
      s.src = 'https://insileco.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

  <noscript>
    Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>



</div>


    </div>

</div>

<footer>

  <hr>

  <div class="col-md-3">

    <a href="#" id="bottom"></a>

  </div>

  <div class="col-md-8">

    <script src="//yihui.name/js/math-code.js"></script>
    <script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

    <p class="copyright text-muted" style="font-size: 1.6rem;">
      &copy; 2017-2023 inSileco |
      Powered by <a href="https://bookdown.org/yihui/blogdown/">Blogdown</a>,
      <a href="https://gohugo.io">Hugo</a>
      and <a href="https://github.com/calintat/minimal">Minimal</a> |
      Latest build: 24 February 2023 23:00 UTC.
    </p>

  </div>


</footer>

</body>

</html>