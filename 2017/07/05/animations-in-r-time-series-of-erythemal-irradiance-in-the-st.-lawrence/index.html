<!DOCTYPE html>
<html lang="en-us">
    <head>
        
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Animations in R: Time series of erythemal irradiance in the St. Lawrence</title>
        
        <style>

    html body {
        font-family: 'Lato', sans-serif;
        background-color: white;
    }

    :root {
        --accent: #3fb3b2;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="https://insileco.github.io/css/main.css">


 <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css">  <link rel="stylesheet" href="https://insileco.github.io/css/academicons.min.css">  <link rel="stylesheet" href="https://insileco.github.io/css/main.css">  <link rel="stylesheet" href="https://insileco.github.io/css/syntax.css"> 


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">





<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" crossorigin="anonymous">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />
 



 <script src="https://insileco.github.io/js/codecopypaste.js"></script> 


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.119.0">
        

        
            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-109508556-1"></script>
            <script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments)};
              gtag('js', new Date());
              gtag('config', 'UA-109508556-1');
            </script>
        

        
            <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/tonsky/FiraCode@1.206/distr/fira_code.css">

  <link rel="stylesheet" href="/css/academicons.min.css">

  <link rel="stylesheet" href="/css/main.css">

  <link rel="stylesheet" href="/css/syntax.css">



    </head>

    <body>
        

        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand visible-xs" href="#">Animations in R: Time series of erythemal irradiance in the St. Lawrence</a>
                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="collapse navbar-collapse">
                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/about/">About</a></li>
                            
                                <li><a href="https://insilecoinc.github.io/">Consulting</a></li>
                            
                                <li><a href="/post/">Posts</a></li>
                            
                                <li><a href="/resource/">Resources</a></li>
                            
                        </ul>
                    
                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="/"><i class="fas fa-home"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/inSileco/"><i class="fab fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://twitter.com/inSileco/"><i class="fab fa-twitter"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://insileco.github.io/index.xml"><i class="fas fa-rss"></i></a></li>
                            
                        </ul>
                    
                </div>
            </div>
        </nav>


<img class="full-width banner" width="100%" src="/img/banner2.png"></img>

<div class="container-fluid">
<div class="row">

    <div class="col-md-3 col-sm-3 hidden-xs">
        <div class="toc">

    <h2 style="padding-top: 0.5rem; padding-bottom: 0.25rem;">
        <a href="#">
            <i class='fas fa-chevron-up'></i>
        </a>
    </h2>

    <nav id="TableOfContents">
  <ul>
    <li><a href="#the-need-for-animations">The “<em>need</em>” for animations</a></li>
    <li><a href="#setting-up-r">Setting up R</a></li>
    <li><a href="#data">Data</a></li>
    <li><a href="#set-parameters-and-functions">Set parameters and functions</a></li>
    <li><a href="#create-first-animation">Create first animation</a></li>
    <li><a href="#create-complex-animation">Create complex animation</a></li>
    <li><a href="#concluding-remarks">Concluding remarks</a></li>
  </ul>
</nav>

    <h2 style="margin-top: 0.25rem; padding-top: 0.5rem;">
        <a href="#bottom">
            <i class='fas fa-chevron-down'></i>
        </a>
    </h2>

</div>
    </div>

    <div class="col-md-6 col-sm-9">

        <div class="post-content">

            <div id="post-content-header">
            <h1>
                <a href="/2017/07/05/animations-in-r-time-series-of-erythemal-irradiance-in-the-st.-lawrence/">Animations in R: Time series of erythemal irradiance in the St. Lawrence</a>
            </h1>

            <h4>
                July 5, 2017
            </h4>

            <p>
                <i class="fas fa-tags" aria-hidden="true"></i> &nbsp;  <a
                    href="/tags/r"><kbd class="item-tag">R</kbd></a>  <a
                    href="/tags/plot"><kbd class="item-tag">plot</kbd></a>  <a
                    href="/tags/animation"><kbd class="item-tag">animation</kbd></a>  <a
                    href="/tags/nasa"><kbd class="item-tag">NASA</kbd></a>  <a
                    href="/tags/radiation"><kbd class="item-tag">radiation</kbd></a>  <a
                    href="/tags/st.-lawrence"><kbd class="item-tag">St. Lawrence</kbd></a> 
                <br>
                
                    <img src="/img/Rlogo.svg" title="R logo" width="60px" style="margin: 1rem;"></img>
                    &nbsp; 
                     
                        <a href="/rpkgs/animation">
                            <kbd class="item-tag2">animation</kbd>
                        </a> 
                     
                        <a href="/rpkgs/magrittr">
                            <kbd class="item-tag2">magrittr</kbd>
                        </a> 
                     
                        <a href="/rpkgs/graphics">
                            <kbd class="item-tag2">graphics</kbd>
                        </a> 
                     
                        <a href="/rpkgs/plyr">
                            <kbd class="item-tag2">plyr</kbd>
                        </a> 
                     
                        <a href="/rpkgs/raster">
                            <kbd class="item-tag2">raster</kbd>
                        </a> 
                    
                
            </p>

            
            <p style="font-size: 1.6em;"> 
                <i class="fas fa-pencil-alt"></i>
                
                 
                    
                    <a href="/about/">David Beauchesne</a>,
                 
                    
                    <a href="/about/">Kevin Cazelles</a>
                
                <a href="#"></a>
            </p>
            

            

            <p id="badges">
                
                
                
                    <img src='https://img.shields.io/static/v1?style=flat&amp;label=reading%20time&amp;message=5min&amp;color=3fb3b2&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAA/1BMVEU/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7I/s7L////QnMRFAAAAVHRSTlMAAyRgm8Pa5C&#43;GyOPo5xV40unq3y2szJpqSjw3wcVtIwTikCLebwkBeQUQHTB30ZgHAojvroftrQjNS4nsBmfcKbbLbBMXdOvmsUgynn8LWMBxIGRFHj3/AAAAAWJLR0RU5AOIpQAAAAlwSFlzAAAN5QAADeUB5upprwAAAAd0SU1FB&#43;QEBQceG9g0RXAAAAFvSURBVDjLhVPXdoJAEF0BQdwZZMHeKIolMUbTJb2aXv//X4IFZD16uC8wu3fKztwhJERKEKW0rChyWhKFFFlHKqNmKQAGAKBZNbNG0XI6AzCAmiYNPsD0nBa/zxcCPyyWypVqtVIuFWdWIb&#43;6r9UZQqNp2QvTtpoNQFavRf7BveO24iFbrhMwljG0AsO21&#43;GL6nhtZIV5Hd0eouP1F&#43;c7u1p38df3HMTezBjoAG7ovzfcH4UxXAB9QMhYZdCwwsgHh0dRLqsBTB0TIQvYjFIfn5yeRUYTISsQkcJE2EwQJkBFIoFRsjcT7JIBEkkDlMlmAikDpImM1N9G8CnKREGzyhFiHauaqKwRzi8m/iVP4FNcmca1e9ONp&#43;CLHPm3aNzdP8SK5J9JyOPTcPr88jqKnsk3KsD47d2Ztj8uw0bxrZ7j8&#43;sbf6JW88Na4vdPi4bFjzsumeW4ecGssBJMouSSRZss&#43;&#43;TFSV695OUlW9f/HyniMFbfN&#43;2lAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTA0LTA1VDExOjMwOjUyLTA0OjAwwJKD8wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wNC0wNVQxMTozMDoyNy0wNDowMOkyHfEAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC'>
                    &nbsp;
                
                
                
                
                
                    <a href="https://creativecommons.org/licenses/by/4.0/">
                        <img src="https://img.shields.io/static/v1?style=flat&label=license&message=CC-BY-4.0&color=f76f2b&logo=creative-commons">
                    </a>&nbsp;
                
                
                
                    <a href="https://github.com/inSileco/inSileco.github.io/wiki/Posts#archiving-a-posts">
                        <img src="https://img.shields.io/static/v1?style=flat&label=archived&message=2022-05-27&logo=internet-archive&color=6d4f5b">
                    </a>&nbsp;
                
                
                
                <a href="http://twitter.com/share?url=https%3a%2f%2finsileco.github.io%2f2017%2f07%2f05%2fanimations-in-r-time-series-of-erythemal-irradiance-in-the-st.-lawrence%2f&text=Animations%20in%20R%3a%20Time%20series%20of%20erythemal%20irradiance%20in%20the%20St.%20Lawrence" target="_blank">
                    <img src='https://img.shields.io/twitter/url?style=social&url=https%3a%2f%2finsileco.github.io%2f2017%2f07%2f05%2fanimations-in-r-time-series-of-erythemal-irradiance-in-the-st.-lawrence%2f?link=http://left&link=http://right}'>
                </a>
                

                

                <div class="visible-xs">
                    <div class="toc">
    
        <h2>Table of Contents</h2>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#the-need-for-animations">The “<em>need</em>” for animations</a></li>
    <li><a href="#setting-up-r">Setting up R</a></li>
    <li><a href="#data">Data</a></li>
    <li><a href="#set-parameters-and-functions">Set parameters and functions</a></li>
    <li><a href="#create-first-animation">Create first animation</a></li>
    <li><a href="#create-complex-animation">Create complex animation</a></li>
    <li><a href="#concluding-remarks">Concluding remarks</a></li>
  </ul>
</nav>
    
</div>
                </div>

            </p>
            </div>


            <div id="post-content-body" class="text-justify">

                <h2 id="the-need-for-animations">The “<em>need</em>” for animations</h2>
<p>As part of my PhD thesis, I am currently characterizing the intensity of multiple stressors in the estuary and gulf of St. Lawrence (see ResearchGate <a href="https://www.researchgate.net/project/Evaluating-the-cumulative-impacts-of-human-activities-on-the-structure-and-function-the-trophic-network-of-the-estuary-and-gulf-of-StLawrence">project</a> for more details). I have recently <em>needed</em> (read: <em>thought it would be cool</em>) to create an animation of the temporal variations in ultra-violet intensity in the St. Lawrence. Here is how I did it.</p>
<h2 id="setting-up-r">Setting up R</h2>
<h3 id="r-version-used-to-build-the-last-update-of-this-post">R version used to build the last update of this post</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sessionInfo</span><span class="p">()</span><span class="n">[[1]]</span><span class="o">$</span><span class="n">version.string</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [1] &#34;R version 4.2.0 (2022-04-22)&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="installing-imagemagick">Installing imagemagick</h3>
<p>The package <code>animation</code>, which I used to create the animations in R, works with the application <a href="https://www.imagemagick.org/script/index.php"><code>imagemagick</code></a>, which can be installed using <a href="https://brew.sh/"><code>Homebrew</code></a> on MacOS.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">brew install imagemagick
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="installing-the-package-animation">Installing the package animation</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">`install.packages</span><span class="p">(</span><span class="s">&#39;animation&#39;</span><span class="p">,</span> <span class="n">repos</span> <span class="o">=</span> <span class="s">&#39;http://yihui.name/xran&#39;</span><span class="p">)</span><span class="n">`</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="data">Data</h2>
<p>There is a incredible amount of data available on the <a href="https://disc.gsfc.nasa.gov/uui/datasets?keywords=%22Aura%20OMI%22">NASA website</a>. For this post, we downloaded all available data from NASA’s Ozone Monitoring Instrument (OMI) aboard the Earth Observing System’s (EOS) Aura satellite. More specifically, we used <a href="https://disc.gsfc.nasa.gov/uui/datasets/OMUVBG_V003/summary?keywords=%22Aura%20OMI%22">OMI/Aura Surface UVB Irradiance and Erythemal Dose Daily at a scale of 0.25 x 0.25 degree</a> and selected the daily erythemal irradiance (mW/m<sup>2</sup>), <em>i.e.</em> the potentially harmful range of UV radiations, from October 1<sup>st</sup> 2004 to April 5<sup>th</sup> 2017. We then selected only the years with 12 months worth of data to create the following figures, <em>i.e.</em> from January 1<sup>st</sup> 2005 to December 31<sup>st</sup> 2016.</p>
<!-- The resulting dataset is available here in the [letiR github page](https://github.com/letiR/letir.github.io/blob/master/assets/AnimationInR/MonthOMI.rds). -->
<p>The maps generated in this post require the user to load <a href="http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/physical/ne_10m_ocean.zip"><code>ocean</code></a> shapefile from <a href="http://www.naturalearthdata.com/">Natural Earth</a>.</p>
<br/>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># UV data</span>
</span></span><span class="line"><span class="cl"><span class="n">UV</span> <span class="o">&lt;-</span> <span class="nf">readRDS</span><span class="p">(</span><span class="s">&#39;MonthOMI.rds&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Projection</span>
</span></span><span class="line"><span class="cl"><span class="n">spatProj</span> <span class="o">&lt;-</span> <span class="s">&#39;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Ocean shapefile</span>
</span></span><span class="line"><span class="cl"><span class="n">ocean</span> <span class="o">&lt;-</span> <span class="nf">readOGR</span><span class="p">(</span><span class="n">dsn</span> <span class="o">=</span> <span class="s">&#34;shpfile&#34;</span><span class="p">,</span> <span class="n">layer</span> <span class="o">=</span> <span class="s">&#34;ne_10m_ocean&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">             <span class="nf">spTransform</span><span class="p">(</span><span class="n">CRSobj</span> <span class="o">=</span> <span class="nf">CRS</span><span class="p">(</span><span class="n">spatProj</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  OGR data source with driver: ESRI Shapefile</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  Source: &#34;/home/kc/git/inSilecoBlog/inSileco.github.io/content/post/2017/animationinR/shpfile&#34;, layer: &#34;ne_10m_ocean&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  with 1 features</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  It has 2 fields</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">ocean</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [1] &#34;SpatialPolygonsDataFrame&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  attr(,&#34;package&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [1] &#34;sp&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="set-parameters-and-functions">Set parameters and functions</h2>
<p>We start be setting the different parameters and functions required to build the animation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Graphical parameters</span>
</span></span><span class="line"><span class="cl"><span class="n">min_</span> <span class="o">&lt;-</span> <span class="nf">min</span><span class="p">(</span><span class="n">UV[[1]]</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">plyr</span><span class="o">::</span><span class="nf">round_any</span><span class="p">(</span><span class="n">.,</span> <span class="m">100</span><span class="p">,</span> <span class="n">floor</span><span class="p">)</span> <span class="c1"># Minimum values in UV dataset</span>
</span></span><span class="line"><span class="cl"><span class="n">max_</span> <span class="o">&lt;-</span> <span class="nf">max</span><span class="p">(</span><span class="n">UV[[1]]</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">plyr</span><span class="o">::</span><span class="nf">round_any</span><span class="p">(</span><span class="n">.,</span> <span class="m">100</span><span class="p">,</span> <span class="n">ceiling</span><span class="p">)</span> <span class="c1"># Minimum values in UV dataset</span>
</span></span><span class="line"><span class="cl"><span class="n">ext</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="m">-72</span><span class="p">,</span> <span class="m">-54</span><span class="p">,</span> <span class="m">44</span><span class="p">,</span> <span class="m">53</span><span class="p">)</span> <span class="c1"># c(xmin, xmax, ymin, ymax)</span>
</span></span><span class="line"><span class="cl"><span class="n">rbPal</span> <span class="o">&lt;-</span> <span class="nf">colorRampPalette</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;#2f6eb9&#39;</span><span class="p">,</span><span class="s">&#39;#2aadba&#39;</span><span class="p">,</span><span class="s">&#39;#c4c726&#39;</span><span class="p">,</span><span class="s">&#39;#b45f5f&#39;</span><span class="p">))</span> <span class="c1"># color palette</span>
</span></span><span class="line"><span class="cl"><span class="n">labels</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">seq</span><span class="p">(</span><span class="m">4</span><span class="p">,(</span><span class="m">151-4</span><span class="p">)),</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">dimnames</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="m">2005</span><span class="o">:</span><span class="m">2016</span><span class="p">,</span> <span class="n">month.abb</span><span class="p">),</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>  <span class="c1"># Select only full years (start: 2004/10; end: 2017/04)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Monthly trends</span>
</span></span><span class="line"><span class="cl"><span class="n">monthMean</span> <span class="o">&lt;-</span> <span class="nf">apply</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">UV[[1]]</span><span class="p">,</span> <span class="n">MARGIN</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">FUN</span> <span class="o">=</span> <span class="n">mean</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># monthly mean</span>
</span></span><span class="line"><span class="cl"><span class="n">monthSd</span> <span class="o">&lt;-</span> <span class="nf">apply</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">UV[[1]]</span><span class="p">,</span> <span class="n">MARGIN</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">FUN</span> <span class="o">=</span> <span class="n">sd</span><span class="p">,</span> <span class="n">na.rm</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># monthly sd</span>
</span></span><span class="line"><span class="cl"><span class="n">years</span> <span class="o">&lt;-</span> <span class="m">2005</span><span class="o">:</span><span class="m">2016</span>
</span></span><span class="line"><span class="cl"><span class="n">lowCI</span> <span class="o">&lt;-</span> <span class="n">monthMean</span> <span class="o">-</span> <span class="p">(</span><span class="m">1.96</span><span class="o">*</span><span class="n">monthSd</span><span class="p">)</span> <span class="c1"># Lower confidence interval</span>
</span></span><span class="line"><span class="cl"><span class="n">upCI</span> <span class="o">&lt;-</span> <span class="n">monthMean</span> <span class="o">+</span> <span class="p">(</span><span class="m">1.96</span><span class="o">*</span><span class="n">monthSd</span><span class="p">)</span> <span class="c1"># Upper confidence interval</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Empty plot function</span>
</span></span><span class="line"><span class="cl"><span class="n">eplot</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">bty</span> <span class="o">=</span> <span class="s">&#34;n&#34;</span><span class="p">,</span> <span class="n">ann</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">xaxt</span> <span class="o">=</span> <span class="s">&#34;n&#34;</span><span class="p">,</span> <span class="n">yaxt</span> <span class="o">=</span> <span class="s">&#34;n&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;n&#34;</span><span class="p">,</span> <span class="n">bg</span> <span class="o">=</span> <span class="s">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">),</span> <span class="n">xlim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Legend function</span>
</span></span><span class="line"><span class="cl"><span class="n">colorBar</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">colRamp</span><span class="p">,</span> <span class="n">min</span><span class="p">,</span> <span class="n">max</span><span class="p">,</span> <span class="n">nticks</span> <span class="o">=</span> <span class="m">11</span><span class="p">,</span> <span class="n">ticks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="n">min</span><span class="p">,</span> <span class="n">max</span><span class="p">,</span> <span class="n">len</span> <span class="o">=</span> <span class="n">nticks</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">scale</span> <span class="o">=</span> <span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">colRamp</span><span class="p">)</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">par</span><span class="p">(</span><span class="n">mar</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">0.5</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nf">plot</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">10</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="p">),</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="n">bty</span> <span class="o">=</span> <span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="n">xaxt</span> <span class="o">=</span> <span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="n">xlab</span> <span class="o">=</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="n">yaxt</span> <span class="o">=</span> <span class="s">&#39;n&#39;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">axis</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="n">ticks</span><span class="p">,</span> <span class="n">las</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">colRamp</span><span class="p">)</span> <span class="o">-</span> <span class="m">1</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="m">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">scale</span> <span class="o">+</span> <span class="n">min</span>
</span></span><span class="line"><span class="cl">        <span class="nf">rect</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="m">1</span> <span class="o">/</span> <span class="n">scale</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">colRamp[i]</span><span class="p">,</span> <span class="n">border</span> <span class="o">=</span> <span class="kc">NA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="create-first-animation">Create first animation</h2>
<p>Let’s start with a simple animation of erythemal irradiance for 2005.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">saveGIF</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">ncol</span><span class="p">(</span><span class="n">labels</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">      <span class="nf">par</span><span class="p">(</span><span class="n">mar</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span> <span class="n">pch</span> <span class="o">=</span> <span class="m">21</span><span class="p">,</span>  <span class="n">xaxs</span> <span class="o">=</span> <span class="s">&#34;i&#34;</span><span class="p">,</span> <span class="n">yaxs</span> <span class="o">=</span> <span class="s">&#34;i&#34;</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="s">&#34;serif&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="n">r</span> <span class="o">&lt;-</span> <span class="n">raster</span><span class="o">::</span><span class="nf">raster</span><span class="p">(</span><span class="n">UV[[1]][</span><span class="p">,,</span><span class="n">labels[1</span><span class="p">,</span><span class="n">i]]</span><span class="p">,</span> <span class="n">xmn</span> <span class="o">=</span> <span class="n">ext[1]</span><span class="p">,</span> <span class="n">xmx</span> <span class="o">=</span> <span class="n">ext[2]</span><span class="p">,</span> <span class="n">ymn</span> <span class="o">=</span> <span class="n">ext[3]</span><span class="p">,</span> <span class="n">ymx</span> <span class="o">=</span> <span class="n">ext[4]</span><span class="p">,</span> <span class="n">crs</span> <span class="o">=</span> <span class="n">spatProj</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">          <span class="nf">mask</span><span class="p">(</span><span class="n">ocean</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">eplot</span><span class="p">(</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">ext[1]</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">ext[2]</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="n">ext[3]</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ext[4]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span> <span class="nf">rbPal</span><span class="p">(</span><span class="m">100</span><span class="p">),</span> <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="n">min_</span><span class="p">,</span><span class="n">max_</span><span class="p">,</span><span class="n">length.out</span><span class="o">=</span><span class="m">100</span><span class="p">),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">plot</span><span class="p">(</span><span class="n">ocean</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="nf">text</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="m">-54.5</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="m">45</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nf">paste</span><span class="p">(</span><span class="nf">colnames</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="n">[1]</span><span class="p">,</span> <span class="nf">rownames</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="n">[i]</span><span class="p">),</span> <span class="n">adj</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="n">movie.name</span> <span class="o">=</span> <span class="s">&#34;UV2005animate.gif&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><center>
  
    <img src="lUV2005animate.gif" width="50%">
  
</center>

<h2 id="create-complex-animation">Create complex animation</h2>
<p>Now let’s make a more informative and complex animation that allows to visualize monthly erythemal irradiance through the years as well as annual trends.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ani.options</span><span class="p">(</span><span class="n">ani.height</span> <span class="o">=</span> <span class="m">720</span><span class="p">,</span> <span class="n">ani.width</span> <span class="o">=</span> <span class="m">720</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">saveGIF</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#layout</span>
</span></span><span class="line"><span class="cl">            <span class="n">mat</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">13</span><span class="o">:</span><span class="m">15</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="m">16</span><span class="o">:</span><span class="m">18</span><span class="p">,</span> <span class="m">4</span><span class="o">:</span><span class="m">6</span><span class="p">,</span> <span class="m">19</span><span class="o">:</span><span class="m">21</span><span class="p">,</span> <span class="m">7</span><span class="o">:</span><span class="m">9</span><span class="p">,</span> <span class="m">22</span><span class="o">:</span><span class="m">24</span><span class="p">,</span> <span class="m">10</span><span class="o">:</span><span class="m">12</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">              <span class="n">ncol</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">8</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">                  <span class="nf">cbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">25</span><span class="p">,</span> <span class="m">25</span><span class="p">,</span> <span class="m">25</span><span class="p">,</span> <span class="m">25</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">                  <span class="nf">rbind</span><span class="p">(</span><span class="m">26</span><span class="p">,</span> <span class="n">.)</span>
</span></span><span class="line"><span class="cl">            <span class="nf">layout</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">widths</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">1.25</span><span class="p">),</span> <span class="n">heights</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="m">4</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Rasters</span>
</span></span><span class="line"><span class="cl">            <span class="nf">for</span><span class="p">(</span><span class="n">j</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">ncol</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">par</span><span class="p">(</span><span class="n">pch</span> <span class="o">=</span> <span class="m">21</span><span class="p">,</span>  <span class="n">xaxs</span> <span class="o">=</span> <span class="s">&#34;i&#34;</span><span class="p">,</span> <span class="n">yaxs</span> <span class="o">=</span> <span class="s">&#34;i&#34;</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="s">&#34;serif&#34;</span><span class="p">,</span> <span class="n">mar</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">r</span> <span class="o">&lt;-</span> <span class="n">raster</span><span class="o">::</span><span class="nf">raster</span><span class="p">(</span><span class="n">UV[[1]][</span><span class="p">,,</span><span class="n">labels[i</span><span class="p">,</span><span class="n">j]]</span><span class="p">,</span> <span class="n">xmn</span> <span class="o">=</span> <span class="n">ext[1]</span><span class="p">,</span> <span class="n">xmx</span> <span class="o">=</span> <span class="n">ext[2]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">ymn</span> <span class="o">=</span> <span class="n">ext[3]</span><span class="p">,</span> <span class="n">ymx</span> <span class="o">=</span> <span class="n">ext[4]</span><span class="p">,</span> <span class="n">crs</span> <span class="o">=</span> <span class="n">spatProj</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">                      <span class="nf">mask</span><span class="p">(</span><span class="n">ocean</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nf">eplot</span><span class="p">(</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">ext[1]</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">ext[2]</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="n">ext[3]</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ext[4]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nf">image</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span> <span class="nf">rbPal</span><span class="p">(</span><span class="m">100</span><span class="p">),</span> <span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">max_</span><span class="p">,</span><span class="n">length.out</span> <span class="o">=</span> <span class="m">101</span><span class="p">),</span> <span class="n">legend</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nf">plot</span><span class="p">(</span><span class="n">ocean</span><span class="p">,</span> <span class="n">add</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nf">text</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="m">-54.5</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="m">45</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nf">paste</span><span class="p">(</span><span class="nf">colnames</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="n">[j]</span><span class="p">,</span> <span class="nf">rownames</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="n">[i]</span><span class="p">),</span> <span class="n">adj</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">1.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Plot trends</span>
</span></span><span class="line"><span class="cl">            <span class="nf">for</span><span class="p">(</span><span class="n">j</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="nf">ncol</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">temporal</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">years</span> <span class="o">=</span> <span class="n">years[1</span><span class="o">:</span><span class="n">i]</span><span class="p">,</span> <span class="n">monthMean</span> <span class="o">=</span> <span class="n">monthMean[labels[1</span><span class="o">:</span><span class="n">i</span><span class="p">,</span> <span class="n">j]]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">lowCI</span> <span class="o">=</span> <span class="n">lowCI[labels[1</span><span class="o">:</span><span class="n">i</span><span class="p">,</span> <span class="n">j]]</span><span class="p">,</span> <span class="n">upCI</span> <span class="o">=</span> <span class="n">upCI[labels[1</span><span class="o">:</span><span class="n">i</span><span class="p">,</span> <span class="n">j]]</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">                            <span class="nf">na.omit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="n">polyY</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">temporal</span><span class="o">$</span><span class="n">upCI</span><span class="p">,</span> <span class="nf">rev</span><span class="p">(</span><span class="n">temporal</span><span class="o">$</span><span class="n">lowCI</span><span class="p">))</span> <span class="c1"># Y coordinates for confidence interval polygon</span>
</span></span><span class="line"><span class="cl">                <span class="n">polyX</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">temporal</span><span class="o">$</span><span class="n">years</span><span class="p">,</span> <span class="nf">rev</span><span class="p">(</span><span class="n">temporal</span><span class="o">$</span><span class="n">years</span><span class="p">))</span> <span class="c1"># X coordinates for confidence interval polygon</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nf">par</span><span class="p">(</span><span class="n">mar</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> <span class="n">family</span> <span class="o">=</span> <span class="s">&#34;serif&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nf">eplot</span><span class="p">(</span><span class="n">xmin</span> <span class="o">=</span> <span class="m">2005</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="m">2016</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">upCI</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="nf">polygon</span><span class="p">(</span><span class="n">polyX</span><span class="p">,</span> <span class="n">polyY</span><span class="p">,</span> <span class="n">border</span> <span class="o">=</span> <span class="s">&#39;transparent&#39;</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s">&#34;#d9e5f4&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nf">lines</span><span class="p">(</span><span class="n">temporal</span><span class="o">$</span><span class="n">monthMean</span> <span class="o">~</span> <span class="n">temporal</span><span class="o">$</span><span class="n">years</span><span class="p">,</span> <span class="n">lwd</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="s">&#39;#0057bb&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nf">axis</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">at</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">plyr</span><span class="o">::</span><span class="nf">round_any</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">upCI</span><span class="p">),</span> <span class="m">1000</span><span class="p">,</span> <span class="n">ceiling</span><span class="p">),</span> <span class="n">by</span> <span class="o">=</span> <span class="m">2500</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                  <span class="n">las</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="m">2004.75</span><span class="p">,</span> <span class="n">cex</span> <span class="o">=</span>  <span class="m">1.5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Plot legend</span>
</span></span><span class="line"><span class="cl">            <span class="nf">colorBar</span><span class="p">(</span><span class="nf">rbPal</span><span class="p">(</span><span class="m">101</span><span class="p">),</span> <span class="n">min</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="n">max_</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Graph title</span>
</span></span><span class="line"><span class="cl">            <span class="nf">par</span><span class="p">(</span><span class="n">mar</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="nf">eplot</span><span class="p">(</span><span class="n">xmin</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nf">text</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nf">bquote</span><span class="p">(</span><span class="s">&#34;Erythemal UV Irradiance (mW/m&#34;</span> <span class="n">^2</span> <span class="o">*</span><span class="s">&#34;)&#34;</span><span class="p">),</span> <span class="n">cex</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">},</span> <span class="n">movie.name</span> <span class="o">=</span> <span class="s">&#34;UVanimate.gif&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><center>
  
    <img src="UVanimate.gif" width="80%">
  
</center>

<h2 id="concluding-remarks">Concluding remarks</h2>
<p>As you can see, it is quite straightforward to create powerful and informative animations in R.</p>
<div style="padding: 2rem 0rem 2rem 0rem;">
<details>
<summary>
<h4>
<p><i class="fa fa-chevron-right" aria-hidden="true"></i>Session info
<i class="fas fa-cogs" aria-hidden="true"></i></p>
</h4>
</summary>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sessionInfo</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  R version 4.2.0 (2022-04-22)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  Platform: x86_64-pc-linux-gnu (64-bit)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  Running under: Debian GNU/Linux bookworm/sid</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  Matrix products: default</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  locale:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  attached base packages:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  other attached packages:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [1] rgdal_1.5-32           plyr_1.8.7             raster_3.5-15         </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [4] sp_1.4-7               magrittr_2.0.3         animation_2.7         </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [7] inSilecoRef_0.0.1.9000</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  loaded via a namespace (and not attached):</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [1] Rcpp_1.0.8.3      lattice_0.20-45   lubridate_1.8.0   ps_1.7.0         </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [5] assertthat_0.2.1  digest_0.6.29     utf8_1.2.2        mime_0.12        </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;   [9] R6_2.5.1          backports_1.4.1   evaluate_0.15     httr_1.4.3       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [13] blogdown_1.10     pillar_1.7.0      rlang_1.0.2       curl_4.3.2       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [17] data.table_1.14.2 miniUI_0.1.1.1    callr_3.7.0       jquerylib_0.1.4  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [21] DT_0.23           rmarkdown_2.14    RefManageR_1.3.0  rcrossref_1.1.0  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [25] stringr_1.4.0     htmlwidgets_1.5.4 igraph_1.2.11     shiny_1.7.1      </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [29] compiler_4.2.0    httpuv_1.6.5      xfun_0.31         pkgconfig_2.0.3  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [33] htmltools_0.5.2   tidyselect_1.1.2  tibble_3.1.7      httpcode_0.3.0   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [37] bookdown_0.26     codetools_0.2-18  fansi_1.0.3       crayon_1.5.1     </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [41] dplyr_1.0.9       withr_2.5.0       later_1.3.0       grid_4.2.0       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [45] crul_1.2.0        jsonlite_1.8.0    xtable_1.8-4      lifecycle_1.0.1  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [49] DBI_1.1.2         cli_3.3.0         stringi_1.7.6     promises_1.2.0.1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [53] xml2_1.3.3        bslib_0.3.1       ellipsis_0.3.2    targets_0.12.0   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [57] generics_0.1.2    vctrs_0.4.1       tools_4.2.0       glue_1.6.2       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [61] purrr_0.3.4       processx_3.5.3    fastmap_1.1.0     yaml_2.3.5       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#R&gt;  [65] terra_1.5-21      base64url_1.4     knitr_1.39        sass_0.4.1</span>
</span></span></code></pre></td></tr></table>
</div>
</div></details>
</div>


                
                    <div class="edits" style="margin-top: 2em; margin-bottom: 1em;">
                        <h4><b><i class="fas fa-edit" aria-hidden="true"></i> Edits</b></h4>
                        <p style="font-size: 1.5rem">
                            
                            <i class="fas fa-pencil-alt" aria-hidden="true"></i> Apr 27, 2022 -- Beautify the code and archive the post. <br>
                            
                        </p>
                    </div>
                

            </div>


        </div>

          <br>


  
  <script src="//yihui.name/js/math-code.js"></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
  
  


  <h3 class="page-header">Comments on this post</h3>

  <script src="https://utteranc.es/client.js"
        repo="inSileco/inSileco.github.io"
        issue-term="pathname"
        label="Comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
  </script>



  
  

  
    <h3 class="page-header">Related posts</h3>
     <div class="item-bottom">

  

  <h1>
    <a href="/2023/08/25/a-few-thoughts-about-pipes-in-r/">A few thoughts about pipes in R</a> <small>August 25, 2023</small>
  </h1>

  <p> <i class="fas fa-tags" aria-hidden="true"></i>  <a href="/tags/r"><kbd class="item-tag">R</kbd></a>  <a href="/tags/tips"><kbd class="item-tag">tips</kbd></a>  <a href="/tags/pipe"><kbd class="item-tag">pipe</kbd></a>  <a href="/tags/internals"><kbd class="item-tag">internals</kbd></a> </p>

  



  

</div>
  <div class="item-bottom">

  

  <h1>
    <a href="/2023/02/12/trick-or-tips-005-r/">Trick or Tips 005 {R}</a> <small>February 12, 2023</small>
  </h1>

  <p> <i class="fas fa-tags" aria-hidden="true"></i>  <a href="/tags/r"><kbd class="item-tag">R</kbd></a>  <a href="/tags/tips"><kbd class="item-tag">tips</kbd></a>  <a href="/tags/trickortips"><kbd class="item-tag">trickortips</kbd></a> </p>

  



  

</div>
  <div class="item-bottom">

  

  <h1>
    <a href="/2020/08/29/custom-tick-marks-with-rs-base-graphics-system/">Custom tick marks with R&#39;s base graphics system</a> <small>August 29, 2020</small>
  </h1>

  <p> <i class="fas fa-tags" aria-hidden="true"></i>  <a href="/tags/r"><kbd class="item-tag">R</kbd></a>  <a href="/tags/ticks"><kbd class="item-tag">ticks</kbd></a>  <a href="/tags/axes"><kbd class="item-tag">axes</kbd></a> </p>

  



  

</div>
 
  


  

<script type="text/javascript" src="https://insileco.github.io/js/codecopypaste.js"></script>







</div>


    </div>


</div>
</div>

<footer>

  <hr>

  <div class="col-md-3">

    <a href="#" id="bottom"></a>

  </div>

  <div class="col-md-6">

    <script src="//yihui.name/js/math-code.js"></script>
    <script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>

    <p class="copyright text-muted" style="font-size: 1.6rem;">
      &copy; 2017-2023 inSileco |
      Powered by <a href="https://bookdown.org/yihui/blogdown/">Blogdown</a>,
      <a href="https://gohugo.io">Hugo</a>
      and <a href="https://github.com/calintat/minimal">Minimal</a> |
      Latest build: 11 October 2023 00:41 UTC.
    </p>

  </div>


</footer>

</body>

</html>