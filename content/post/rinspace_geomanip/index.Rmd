---
title: R in Space - Geometry manipulation
author: [david, marieh, nicolas, kevin, elliot, steve]
date: 2018-04-02
tags: [R in Space, R, Spatial]
rpkgs: [sp, sf, raster]
draft: true
tweet: "R in Space - Spatial Objects in R"
estime: 10
navposts:
  prev: rinspace_spobjinr
  home: rinspace_homepage
  next: rinspace_rdataresources
output:
  rmarkdown::html_page:
    fig_width: 3
    dev: svg
---

![](https://img.shields.io/badge/inSileco-InDevelopment-3fb3b2.svg)


## `sp` objects

For spatial objects defined with `sp` there is a specific package to manipulate
vector objects: `rgeos`


```{r, message = F}
library(sp)
library(rgeos)
library(raster)
bel2 <- getData(name="GADM", country="BEL", path="data", level = 2)
plot(bel2)
```

### Subset

A quick subset

```{r, message = F}
## Create a subset (A sub-shapefile)
slc <- c(8,11,12)
bel_slc <- bel2[slc,]
class(bel_slc)
```

Let's plot our selection:

```{r, message = F}
plot(bel_slc)
```


### Union

```{r, message = F}
bel_south <- gUnionCascaded(bel_slc)
bel_north <- gUnionCascaded(bel2[-slc,])
mapBELSN <- gUnionCascaded(bel2[c(slc,2),])
par(mfrow=c(1,3), mar=c(1,1,1,1))
plot(bel_south)
plot(bel_north)
plot(mapBELSN)
```


```{r, message = F}
plot(bel2, lwd = .1)
plot(bel_south, add=T, col=2)
plot(bel_north, add=T, col=4)
plot(bel2, lwd = .5, add = T)
```

```
plot(mapBEL2)
plot(mapBELSN, add=T, col=3)
```

### Intersection

par(mfrow=c(1,2))
plot(mapBEL1)
plot(gIntersection(mapBELSN, mapBELS), col=5, add=T)
plot(mapBEL1)
plot(gIntersection(mapBELSN, mapBELN), col=6, add=T)


### Buffers


par(mfrow=c(1,1))
plot(mapBEL1)
plot(gBuffer(mapBELS, width=0.5), add=T, lwd=2, lty=2)
plot(gBuffer(mapBELS, width=0.1), add=T, lwd=3)
plot(mapBELS, add=T, col=2)

### Difference


Diff <- gDifference(gBuffer(mapBELS, width=0.5), gBuffer(mapBELS, width=0.1))
plot(mapBEL1)
plot(mapBELS, add=T, col=4)
plot(Diff, add=T, lwd=2, lty=3, col=2)
plot(mapBELS, add=T, col=2)



## Overlays

One very useful tool is the **over()** function which provides a consistent spatial overlay. For instance, here, I have defined points and one grid, in order to get the identities of cells  my points belong to, I can use the **over** function.  

```{r, eval =F}
over(ptspd,grdsp) # or ptspd%over%grdsp
```


## `sf` objects

https://cran.r-project.org/web/packages/sf/vignettes/sf3.html


## `raster` objects
