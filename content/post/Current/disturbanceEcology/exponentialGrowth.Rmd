---
title: Disturbance Ecology Series - Exponential Growth
author: [david]
reviewer:
date: 2018-07-02
tags: [Disturbance Ecology, ecology, disturbance, model, population, community, exponential growth]
rpkgs: [base, graphics, graphicsutils, latex2exp, utils]
draft: true
tweet: "Disturbance Ecology Series - Exponential Growth"
estime: 15
relativeurls: true
bibliography: [../../../../static/bib/inSilecoRef.bib]
csl: [../../../../static/bib/nature.csl]
link-citations: yes
navposts:
  prev: geometricGrowth
  home: disturbanceEcology
---



```{r bibSetUp, echo=FALSE}
source('../../../../static/Rscript/bibSetUp.R')
source('../../codeChunkSetUp.R')
```

 ![](https://img.shields.io/badge/inSileco-UnderReview-ffdd55.svg)

`r htmltools::HTML("{{< distecolintro >}}")`

```{r libraries, echo = F}
library(graphicsutils)
library(latex2exp)
cols <- gpuPalette("insileco")
contExp <- function(N0, r, t) N0 * exp(r * t) # Exponential growth function
```


## Continuous Exponential Growth

In the [first post](`r htmltools::HTML("{{< ref geometricGrowth >}}")`)
of this series, we looked at the most simple population dynamic model available,
*i.e.* discrete density independent growth of a single species population. That
simple model uses discrete growth increments at specified time steps. Certain
populations are however poorly described by discrete growth models.

In this second post, we therefore move to a slightly more complex model that
models populations growth using continuous growth, the continuous exponential
growth model.

## Theory in brief

Many animal populations reproduce asynchronously (*i.e.* at differing times),
so that the use of discrete models may provide a poor understanding of the
mechanisms underlying the observed populations dynamics. A classic example is
that of the bacterium *Escherichia coli*. Imagine *E. coli* cells multiplying
largely asynchronously in such a way new cells are observed in the population
*very* frequently, giving the appearance of a smooth growth curve at very short
time intervals.

<p class = "comment2"> KC: du coup je dirais qu'on a envie que le pas de temps
tente vers 0 et je mettrai la demonstation que j'ai écrite plus bas! Mais
ce que tu avais écrit est valable aussi, je trouve ça plus simple de montrer
le résult en faisant tendre le pas de tem,ps faire 0.<p>


```{r exempleSteps, fig.height = 5, fig.width = 10, fig.align = 'center', echo = F}
N0 <- 1
r <- .05
t <- 0:100
N <- contExp(N0, r, t)

plot1 <- function(n, ylab = "") {
  plot0(x = c(0, 100), y = c(0,150))
  axis(1, at = seq(0, 101, by = 10), label = seq(0, 100, by = 10))
  axis(2, las = 1)
  mtext(ylab, 2, 2.6)
  mtext('Time', 1, 2.5)
  lines(x = t, y = N, lwd = 1, col = cols[2])
  for(i in seq(1,100,by=n)) lines(x = c(t[i], t[i+n]), y = c(N[i], N[i]), col = cols[3])
  for(i in seq(1,100,by=n)) lines(x = c(t[i+n], t[i+n]), y = c(N[i], N[i+n]), col = cols[3])
  points(x = t[c(seq(1,100,by=n), 101)], y = N[c(seq(1,100,by=n), 101)], cex = 1.25, pch = 20, col = cols[2])
}

par(mfrow = c(2,3), mar = c(4,4,1,1))
plot0()
# graph 4
  plot0(x = c(0, 100), y = c(0,150))
  axis(1, at = seq(0, 101, by = 10), label = seq(0, 100, by = 10))
  axis(2, las = 1)
  mtext('Population size', 2, 2.6)
  mtext('Time', 1, 2.5)
  lines(x = t, y = N, lwd = 1.5, col = cols[2])
plot0()
plot1(25, "Population size") # graph 1
plot1(10) # graph 2
plot1(5) # graph 3
```

One could take a discrete model with a very large number of time steps, *i.e.*
ideally an infinite number of steps. To explore this, let's start from the
discrete model we presented in the
[first post](`r htmltools::HTML("{{< ref geometricGrowth >}}")`)
on discrete density independent growth.
We defined $\lambda$ as the *per capita* growth rate of a population.
From $\lambda$ we can define another term, $r_d$, the discrete growth factor,
so that:

$$\lambda = 1 + r_d$$

Once again drawing from an example from Stevens (2009) [@stevens_2009] on page 14,
an annual growth rate $\lambda = 1.5$ would mean that our population
increases by 50% annually, with a discreate growth factor $r_d = 0.50$. Using
the discrete model $N_t = N_0 \lambda^t$:

$$N_1 = N_0 (1 + 0.5)^1$$

If we were to consider that our population does not reproduce annualy, but
rather bi-annually, we would need two smaller time steps to represent the
growth of our population. We could then realistically infer that the discrete
growth factor would be halved, *i.e.* $r_d = 0.25$, and that the *per capita*
growth rate would be squared, *i.e.* $\lambda^2$ since we now have two time
steps:

$$N_1 = N_0 \Big(1 + \frac{0.5}{2}\Big)^2$$

Now, if we were to increase the number of time steps and decreasing the discrete
growth factor in accordance to our earlier statement that we wish to use an
infinite number of time steps to model the population dynamics of *E. coli*, we
would obtain the following formula:

$$N_1 = N_0 \Big(1 + \frac{r_d}{n}\Big)^n$$

At this point, we want to evaluate the value of $\big(1 + \frac{r_d}{n}\big)^n$
when $n$ goes to infinity. In calculus, we would pose the problem as:

$$\lim_{n\to\infty} \Big(1 + \frac{r_d}{n}\Big)^n$$

This particular equation solves to a famous irrational number:
[the exponential or Euler's number](https://en.wikipedia.org/wiki/E_(mathematical_constant)),
$e \approx 2.7182818$. Our function then becomes:

$$\lim_{n\to\infty} \Big(1 + \frac{r_d}{n}\Big)^n = e^r$$

Going full circle, we can link $\lambda$ and $r_d$  so that:

\begin{eqnarray}
  \nonumber \lambda &=& e^r \: \: \text{and} \\
  \nonumber ln(\lambda) &=& r
\end{eqnarray}

Equipped with this, we can say that when a population grows geometrically
and continuously, *i.e.* with continuous exponential growth:

$$N_t = N_0 e^{rt}$$

where $N$ is population size, $N_0$ is the initial population size, $r$
is the instantaneous *per capita* growth rate and $t$ is the time.

Let's write a function for later use, also available in the
[`inSilecoMod` package](https://github.com/inSileco/inSilecoMod):

```{r model}
contExp <- function(N0, r, t) N0 * exp(r * t)
```

Just like the discrete model, we can relate $r$ to population growth or declines.

\begin{eqnarray}
  \nonumber \lambda > 1; \ r > 0 & \rightarrow & N \text{ increases} \\
  \nonumber \lambda = 1; \ r = 0 & \rightarrow & N \text{ is constant} \\
  \nonumber \lambda < 1; \ r < 0 & \rightarrow & N \text{ decreases}
\end{eqnarray}



```{r example1, fig.height = 5, fig.width = 5, fig.align = 'center', echo = F}
r <- c(0.03, 0, -0.03)
N0 <- 2
t <- 1:100
pop <- sapply(r, contExp, N0 = N0, t = t)

par(mar = c(4,4,1,1))
plot0(x = c(1,100), y = c(0,40))
for(i in 1:3) lines(x = 1:100, y = pop[, i], lwd = 1.75, col = cols[i+1])
axis(1)
axis(2, at = seq(0,40,10))
mtext('Time', 1, 2)
mtext('Population size', 2, 2)
lines(x = c(1, 10), y = c(39, 39), col = cols[2], lwd = 2)
lines(x = c(1, 10), y = c(37, 37), col = cols[3], lwd = 2)
lines(x = c(1, 10), y = c(35, 35), col = cols[4], lwd = 2)
text(x = 12, y = 39, TeX("$r = 0.03$"), cex = 1, adj = 0)
text(x = 12, y = 37, TeX("$r = 0$"), cex = 1, adj = 0)
text(x = 12, y = 35, TeX("$r = -0.03$"), cex = 1, adj = 0)
```

<br/>

We could also use the exponential growth formula to evaluate the time required
for the population to double, triple, etc:

\begin{eqnarray}
  \nonumber N_t &=& N_0 e^{rt} \\
  \nonumber 2N_0 &=& N_0 e^{rt} \: &\rightarrow& \: \text{doubling time} \\
  \nonumber 2 &=& e^{rt} \: &\rightarrow& \: \text{divided by} \ N_0 \\
  \nonumber ln(2) &=& rt \ ln(e) \: &\rightarrow& \: e^x = x \ ln(e) \\
  \nonumber ln(2) &=& rt \: &\rightarrow& \: ln(e) = 1 \\
  \nonumber \frac{ln(2)}{r} &=& t
\end{eqnarray}

We can then use this to generalize the function on $m$ to evaluate $t$ as
the amount of time for the population to reach $m * N_0$:

\begin{eqnarray}
  \nonumber t &=& \frac{ln(m)}{r},
\end{eqnarray}

which we can turn into a function:

```{r mtime}
mtime <- function(r, m) log(m) / r
```

We could then take our previous populations and evaluate their multipliying
times:

```{r mtime2}
dbl <- mtime(0.03, 2)
dbl
tpl <- mtime(0.03, 3)
tpl
x10 <- mtime(0.03, 10)
x10
```
```{r mtimeFig, fig.height = 5, fig.width = 5, fig.align = 'center', echo = F}
par(mar = c(4,4,1,1))
plot0(x = c(1,100), y = c(0,40))
lines(x = c(dbl, dbl), y = c(0,4), lty = 'dashed', col = cols[1], lwd = 1.25)
lines(x = c(0, dbl), y = c(4,4), lty = 'dashed', col = cols[1], lwd = 1.25)
lines(x = c(tpl, tpl), y = c(0,6), lty = 'dashed', col = cols[1], lwd = 1.25)
lines(x = c(0, tpl), y = c(6,6), lty = 'dashed', col = cols[1], lwd = 1.25)
lines(x = c(x10, x10), y = c(0,20), lty = 'dashed', col = cols[1], lwd = 1.25)
lines(x = c(0, x10), y = c(20,20), lty = 'dashed', col = cols[1], lwd = 1.25)
for(i in 1) lines(x = 1:100, y = pop[, i], lwd = 2, col = cols[i+1])
axis(1)
axis(2, at = seq(0,40,10))
mtext('Time', 1, 2)
mtext('Population size', 2, 2)
```

Now enough with the theory, let's jump into simulations!


<div class = "comment2"> Pour les simulation qui suive j'ai une idée on
pourrait parler du cas ou $\lambda$ est une font du temps un cas simple
c'est la saisonalité.


```{r season}
seqt <- seq(0, 16, 0.05)
lambda <- cos(seqt) + 1
par(mfrow = c(1, 2))
plot(seqt, lambda, type = "l")
plot(seqt, exp(0.01*cumsum(lambda)), type = "l")
```

Note que c'est l'allure de la courbe que ça donne en intégrant, je n'ai pas
fait la démonstation et je ne sait pas à quelle point elle est facile. On pourrai
prendre un function plus simple du genre

```{r season2}
seqt <- seq(0, 16, 0.05)
lambda <- rep(c(0,1,0,1), each = 50, length.out = length(seqt))
par(mfrow = c(1, 2))
plot(seqt, lambda, type = "l")
plot(seqt, exp(0.01*cumsum(lambda)), type = "l")
```

La la démonstration me semble plus aisée. Aussi, j'ai l'impression qu'il est pas encore question de
taux de croissance négative mais si c'est le cas on pourrais prendre des
functions qui prenne des valuer négatives.</div>



## Simulated ecology



## Simulated disturbances


## KevCaz's comments

## From arithmetic to exponential growth

On repart de:

$$N_{t+1} = N_{t} + b N_{t} - d N_{t}$$


Maintenant 1 devient dt (notation souvent utilisée, parfois on prend $s$), une variable qu'on
fera tendre vers 0 et faut comprendre que les taux b et d sont des taux
par unité de temps donc avant on avait b le taux moyen de naissance par an
(par exemple), et on écrivait en fait b pour b*1, meme remarque pour d, ce qui
donne avce dt

$$N_{t+dt} = N_{t} + b dt N_{t} - d dt N_{t}$$

J'introduis un truc juste pour pour reflèter une hypothese: $o(dt)$. En gros
ça veut dire que il peu y avoir des truc qui se produise mais:

$$\lim_{dt\to0} \frac{o(dt)}{dt} = 0$$

Encore une fois ça permet d'etre propre et c'est pour dire "quand dt est assez petit
y'a rien d'autre qui arrive", mais on peut laisser tomber ça change pas la demonstration.

$$N_{t+dt} = N_{t} + (b - d)dtN_{t} + o(dt)$$

On peut passer $N_t$ de l'autre côté et on divise par dt:


$$\frac{N_{t+dt} - N_t}{dt}= (b - d)N_{t} + \frac{o(dt)}{dt}$$

et en faisant tendre dt vers 0 on a, par définition a gauche la dérivée de N
et a droite par definition (plus haut) le dernier term devient 0, donc:

$$\dot{N}_t = (b - d)N_{t}$$

Equation diff dotn soltion est l'exponentiel!


## References
