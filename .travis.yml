language: r
dist: trusty
sudo: false

branches:
  only:
    - dev
    - master

notifications:
  slack: insileco:bSFo4jHeKnaM4WobzJJ8DTPj

cache:
  packages: yes
  directories:
    - $HOME/bin
    - $TRAVIS_BUILD_DIR/*_files/
    - $TRAVIS_BUILD_DIR/*_cache/

apt_packages:
  - libgdal-dev
  - libgeos-dev
  - libproj-dev
  - libudunits2-dev
  - libfreetype6-dev
  - libpoppler-cpp-dev
  - libssl-dev
  - pandoc
before_install:
  - Rscript -e 'update.packages(ask = FALSE)'
before_script:
  - Rscript -e 'blogdown::install_hugo()'
script:
  - Rscript -e 'blogdown::build_site()'

deploy:
  provider: pages
  skip_cleanup: true
  github_token: $GITHUB_TOKEN
  target_branch: master
  local_dir: public
  on:
    branch: dev
